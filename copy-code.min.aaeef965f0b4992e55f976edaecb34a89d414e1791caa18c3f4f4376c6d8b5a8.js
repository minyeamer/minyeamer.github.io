function copyCode(e){const n=e.closest(".book-codeblock"),t=n?.querySelector("pre code");if(!t)return;const s=t.querySelectorAll(".hljs-ln-code");text=Array.from(s).map(e=>{const t=e.textContent||e.innerText||"";return t.trim()===""?"":t}).join(`
`),navigator.clipboard?navigator.clipboard.writeText(text).then(()=>copySuccess(e)).catch(()=>fallbackCopy(text,e)):fallbackCopy(text,e)}function copySuccess(e){const t=e.querySelector("i"),n=Array.from(e.childNodes).find(e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim());if(!t||!n)return;const s=t.className,o=n.textContent;t.className="fa-solid fa-check",n.textContent="COPIED",e.classList.add("copied"),setTimeout(()=>{t.className=s,n.textContent=o,e.classList.remove("copied")},2e3)}function fallbackCopy(e,t){const n=document.createElement("textarea");n.value=e,n.style.cssText="position:fixed;opacity:0;",document.body.appendChild(n),n.select();try{document.execCommand("copy")&&copySuccess(t)}catch(e){console.error("Copy failed:",e)}document.body.removeChild(n)}