"use strict";(function(){const e=document.querySelector("#book-search-input"),t=document.querySelector("#book-search-results");if(!e)return;e.addEventListener("focus",s),e.addEventListener("keyup",o),e.addEventListener("keydown",c),e.addEventListener("blur",n),document.addEventListener("keypress",a);function a(t){if(t.target.value!==0[0])return;if(e===document.activeElement)return;const n=String.fromCharCode(t.charCode);if(!r(n))return;e.focus(),t.preventDefault()}function r(t){const n=e.getAttribute("data-hotkeys")||"";return n.indexOf(t)>=0}function c(t){t.key==="Escape"&&(n(),e.blur())}function n(){for(;t.firstChild;)t.removeChild(t.firstChild)}function s(){e.removeEventListener("focus",s),e.required=!0,window.bookSearch.initIndex().then(()=>e.required=!1).then(o)}function o(){if(n(),!e.value)return;const s=window.bookSearchIndex.search(e.value),o=s.slice(0,3);if(o.forEach(function(e){const n=i("<li><a href></a></li>"),s=n.querySelector("a");s.href=e.item.href,s.textContent=e.item.title,t.appendChild(n)}),s.length>3){const n=i('<li class="book-search-more"><a href></a></li>'),o=n.querySelector("a");o.href="/search/?q="+encodeURIComponent(e.value),o.textContent="더보기 (총 "+s.length+"개)",t.appendChild(n)}}function i(e){const t=document.createElement("div");return t.innerHTML=e,t.firstChild}})()