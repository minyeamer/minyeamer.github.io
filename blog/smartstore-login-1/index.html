<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><meta name=keywords content="Crawling,Python,Naver,네이버,스마트스토어,스마트스토어센터,로그인,크롤링"><meta name=description content="네이버 스마트스토어센터에서는 매출 향상에 도움을 주는 유용한 통계 데이터를 제공해줍니다. 쇼핑몰 데이터를 분석하는 입장에서 무료로 제공되는 이런 데이터는 큰 도움이 되지만, 대부분 …"><meta name=author content="minyeamer"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><link rel=canonical href=https://minyeamer.github.io/blog/smartstore-login-1/><link rel=icon href=https://minyeamer.github.io/images/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://minyeamer.github.io/images/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://minyeamer.github.io/images/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><link rel=mask-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><meta name=google-site-verification content="u1tWcHmHUZWfFT1cHaku6sqU-bK40N3WLR-C-4VUWN0"><meta name=naver-site-verification content="6eaf8e9da1a6104780f056f1a7797fe5a3a5a0da"><meta property="og:title" content="[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)"><meta property="og:description" content="네이버 스마트스토어센터에서는 매출 향상에 도움을 주는 유용한 통계 데이터를 제공해줍니다. 쇼핑몰 데이터를 분석하는 입장에서 무료로 제공되는 이런 데이터는 큰 도움이 되지만, 대부분 …"><meta property="og:type" content="article"><meta property="og:url" content="https://minyeamer.github.io/blog/smartstore-login-1/"><meta property="og:image" content="https://minyeamer.github.io/images/profile/opengraph.jpg"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-12-03T13:56:14+09:00"><meta property="article:modified_time" content="2022-12-03T13:56:14+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minyeamer.github.io/images/profile/opengraph.jpg"><meta name=twitter:title content="[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)"><meta name=twitter:description content="네이버 스마트스토어센터에서는 매출 향상에 도움을 주는 유용한 통계 데이터를 제공해줍니다. 쇼핑몰 데이터를 분석하는 입장에서 무료로 제공되는 이런 데이터는 큰 도움이 되지만, 대부분 …"><meta name=twitter:site content="@https://x.com/minyeamer"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minyeamer.github.io/post/"},{"@type":"ListItem","position":2,"name":"[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)","item":"https://minyeamer.github.io/blog/smartstore-login-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)","name":"[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)","description":"네이버 스마트스토어센터에서는 매출 향상에 도움을 주는 유용한 통계 데이터를 제공해줍니다.\n쇼핑몰 데이터를 분석하는 입장에서 무료로 제공되는 이런 데이터는 큰 도움이 되지만,\n대부분이 엑셀 파일 다운로드를 지원하지 않고 빈번하게 수치가 바뀌는 데이터를 각각의 메뉴에서 매번 확인하기도 어렵습니다.\n이런 데이터를 자동화 프로그램으로 수집 및 적재할 수 있다면 업무 효율을 크게 향상시킬 수 있을 것입니다.\n이번 게시글에서는 실제 네이버 스마트스토어 로그인 구현에 앞서\n데이터 수집에 대한 간단한 설명을 진행하고 네이버 로그인 구현의 바탕이 되는 클래스와 메소드를 정의합니다.\n","keywords":["Crawling","Python","Naver","네이버","스마트스토어","스마트스토어센터","로그인","크롤링"],"articleBody":"네이버 스마트스토어센터에서는 매출 향상에 도움을 주는 유용한 통계 데이터를 제공해줍니다.\n쇼핑몰 데이터를 분석하는 입장에서 무료로 제공되는 이런 데이터는 큰 도움이 되지만,\n대부분이 엑셀 파일 다운로드를 지원하지 않고 빈번하게 수치가 바뀌는 데이터를 각각의 메뉴에서 매번 확인하기도 어렵습니다.\n이런 데이터를 자동화 프로그램으로 수집 및 적재할 수 있다면 업무 효율을 크게 향상시킬 수 있을 것입니다.\n이번 게시글에서는 실제 네이버 스마트스토어 로그인 구현에 앞서\n데이터 수집에 대한 간단한 설명을 진행하고 네이버 로그인 구현의 바탕이 되는 클래스와 메소드를 정의합니다.\n데이터 수집 개요 # 네이버 웹사이트에서 데이터를 수집할 때 활용할 수 있는 방안은 2가지가 있습니다.\n첫 번째는 CSS Selector 또는 XPath를 활용해 웹사이트 특정 위치의 값을 가져오는 것,\n두 번째는 API에 요청을 보내 JSON 형태의 데이터를 가져오는 것입니다.\n특정 위치의 값을 가져오는 첫 번째 방식은 UI에 의존적이어서 코드의 지속성을 보장하기 어렵고\n원하는 데이터와 관련없는 웹 소스 전체를 불러오기 때문에 속도 면에서도 단점이 있습니다.\n따라서, API를 제공하는 경우 두 번째 방식을 이용하는 것이 효율적입니다.\n데이터 수집 시나리오 # 네이버 쇼핑에서 표시되는 상품의 순위는 검색인기도를 기준으로 결정됩니다.\n키워드별 상위권 상품의 검색인기도를 가져오는 것을 예시로 데이터 수집을 진행해보겠습니다.\n위 이미지에서 왼쪽 부분은 실제 UI, 오른쪽 부분은 HTML 소스 입니다.\n해당 소스에서 데이터를 가져온다면 div.popularity-product \u003e div.box-border 위치에서\ndd 태그를 순서대로 지정해서 각각의 종합, 적합도, 인기도 값을 가져올 수 있습니다.\n해당 데이터를 분석에 활용하기 위해서는 인기도 수치를 구성하는 클릭수, 판매실적 등도 필요하기 때문에\n상세보기 페이지를 확인해야하고 결과적으로 하나의 상품에 대한 데이터를 보기 위해 두 개의 페이지를 방문해야 합니다.\n하지만 네이버의 대부분의 웹페이지는 API를 기반으로 가져온 데이터로 구성되기 때문에\n해당 API를 활용할 수 있다면 더욱 효율적인 데이터 수집이 가능합니다.\n서버에서 가져오는 데이터를 확인할 때는 주로 개발자 도구의 네트워크 탭을 활용합니다.\n웹페이지 로드 시 가져오는 문서를 확인하다보면 위 이미지와 같이 목표로 하는 데이터를 보내주는 API를 발견할 수 있습니다.\n새 탭에서 해당 API 주소를 요청하면 위 이미지 내 오른쪽 부분과 같은 JSON 형식의 데이터를 받을 수 있습니다.\n실제 UI에서 가져오고자 하는 종합, 적합도, 인기도 수치도 해당 데이터에서 확인할 수 있습니다.\n여기에는 추가로 클릭수, 판매실적 등에 대한 수치 데이터도 포함되어 있기 때문에\n해당 API를 활용하면 다수의 페이지에 요청을 보낼 수고도 줄어들게 됩니다.\n로그인이 필요한 페이지의 데이터 가져오기 # 여기까지는 간단해보이지만 네이버 스마트스토어센터 데이터를 requests 모듈로 가져오는데는\n하나의 추가적인 문제가 존재합니다.\n단순한 GET 요청일지라도 로그인 정보를 갖고 있지 않다면 데이터를 받을 수 없습니다.\n스마트스토어센터에 로그인하지 않은 상태에서 위 API 주소로 요청을 보내게 된다면\n아래와 같은 에러 메시지를 받아볼 수 있습니다.\nCopy json { \"error\": \"Full authentication is required to access this resource\" } 이 문제에 대한 해결방법은 헤더에 있습니다.\n개발자 도구 네트워크 탭에서 하나의 문서를 클릭하고 Headers 탭에서 스크롤을 내리면\n아래와 같은 Request Headers 정보를 확인할 수 있습니다.\n서버와 클라이언트 간 네트워크 요청 시 서버는 클라이언트의 정보를 확인할 목적으로\n클라이언트에 쿠키라는 암호화된 인증 정보를 남깁니다.\n클라이언트가 해당 정보를 헤더에 담아 요청을 보내는 경우에만 서버가 올바른 응답을 전달합니다.\nrequests 모듈에서는 이러한 과정을 다음과 같이 구현할 수 있습니다.\nCopy python headers = {\"cookie\": \"...\"} response = requests.get(url, headers=headers) 하지만 일반적인 쿠키 값은 30분의 유통기한이 있기 때문에, 매번 쿠키 값을 갱신해야 하는데\n자동화 프로그램을 돌리기 전에 직접 로그인해서 쿠키 값을 갱신하는 것은 바람직하지 못합니다.\n결과적으로 로그인이 필요한 스마트스토어 페이지의 데이터를 가져오기 위해서는\n자동화된 로그인 과정을 거쳐서 쿠키 값을 갱신할 필요가 있습니다.\n쿠키 확인하기 # 클라이언트에서 요청하는 헤더 내역에서 확인할 수 있는 정보는 표현하면 다음과 같습니다.\nCopy json { \"NNB\": \"...\", \"nid_inf\": \"...\", \"NID_AUT\": \"...\", \"NID_SES\": \"...\", \"NID_JKL\": \"...\", \"CBI_SES\": \"...\", \"CBI_CHK\": \"...\", \"NSI\": \"...\" } 이는 앞으로 스마트스토어센터 로그인을 구현하는데서 반드시 확인해야할 목록입니다.\n지금은 이 값들이 어떤 의미를 가지고 어디서 발생하는 값인지 알 수는 없지만,\n서버로부터 해당 값들을 받아오는 것에 집중하여 로그인 프로세스를 파악하고\n로그인 진행 과정을 쿠키 값을 통해 시각적으로 점검할 것입니다.\n스마트스토어센터 로그인 개요 # 스마트스토어센터 로그인을 구현하기 위해 로그인 페이지를 탐색할 필요가 있습니다.\n메인 페이지에서 로그인하기 버튼을 클릭했을 때 이동하는 로그인 페이지에서 실제 로그인이 이루어집니다.\n스마트스토어센터 로그인에는 판매자 아이디로 로그인하는 방식과\n네이버 아이디로 로그인하는 방식이 있습니다.\n우선적으로 네이버 아이디로 로그인하는 방식을 알아보겠습니다.\n네이버 로그인을 구현하는 것에 관해선 좋은 선례가 있어 많은 부분을 참고했습니다.\n해당 내용은 아래 링크를 참고할 수 있습니다.\n파이썬#76 - 파이썬 크롤링 requests 로 네이버 로그인 하기\n클래스 정의 # 네이버 로그인 기능은 자동화 프로그램에서 지속적으로 활용될 것이기 때문에\n별도의 클래스에서 메소드로 구현할 필요가 있습니다.\n먼저 requests 모듈의 Session 클래스를 상속받는 NaverLogin 클래스를 정의합니다.\nNaverLogin은 네이버 ID와 비밀번호를 초기화하는 단순한 기능만을 구현했지만\nrequests.Session 클래스를 상속받았기 때문에\n웹페이지 요청과 관련된 다양한 기능을 가지고 있습니다.\nCopy python class NaverLogin(requests.Session): def __init__(self, userid: str, passwd: str, **kwargs): super().__init__(**kwargs) self.userid = userid self.passwd = passwd 그리고 NaverLogin을 상속받는 SmartstoreLogin 클래스를 정의합니다.\n일반적인 네이버 로그인과 스마트스토어센터에서 진행되는 네이버 로그인이 다르기 때문에\nNaverLogin 메소드의 일부를 변경할 필요가 있을 것입니다.\nCopy python class SmartstoreLogin(NaverLogin): def __init__(self, userid=str(), passwd=str(), **kwargs): super().__init__(userid, passwd, **kwargs) 추가적으로 로그인 페이지 요청 과정에서 빈번하게 정의해야 하는 매개변수 생성을\n간단하게 할 수 있는 메소드를 정의하겠습니다.\n헤더 생성 메소드 정의 # requests 모듈은 기본적으로 헤더를 갖고 있지 않는데\n이 상태로 다수의 웹페이지에 요청을 보낸다면 로봇으로 간주당해 차단당할 것입니다.\n임의의 웹페이지에 요청을 보낼 때 확인할 수 있는 요청 헤더 HEADERS를 기본 바탕으로,\n웹페이지 별로 최적화된 헤더를 생성하는 get_headers() 메소드를 정의합니다.\nCopy python HEADERS = { \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Accept-Encoding\": \"gzip, deflate, br\", \"Accept-Language\": \"ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7\", \"Connection\": \"keep-alive\", \"sec-ch-ua\": '\"Chromium\";v=\"106\", \"Google Chrome\";v=\"106\", \"Not;A=Brand\";v=\"99\"', \"sec-ch-ua-mobile\": \"?0\", \"sec-ch-ua-platform\": '\"Windows\"', \"Sec-Fetch-Dest\": \"empty\", \"Sec-Fetch-Mode\": \"cors\", \"Sec-Fetch-Site\": \"same-origin\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36\", } Copy python from urllib.parse import urlparse class NaverLogin(requests.Session): def get_headers(self, authority=str(), referer=str(), cookies=str(), host=str(), **kwargs) -\u003e Dict[str,Any]: headers = HEADERS.copy() if authority: headers[\"Authority\"] = urlparse(authority).hostname if host: headers[\"Host\"] = urlparse(host).hostname if referer: headers[\"Referer\"] = referer if cookies: headers[\"Cookie\"] = cookies return dict(headers, **kwargs) 호스트명을 의미하는 Authority 또는 Host, 리다이렉트 전 경로를 의미하는 Referer,\n그리고 쿠키를 의미하는 Cookie 등의 값은 수시로 변하기 때문에 별도의 입력으로 지정합니다.\n쿠키 생성 메소드 정의 # 헤더와 함께 활용되는 쿠키는 헤더와 마찬가지로 웹페이지 요청 시 빈번히 활용되는데\nrequests 모듈의 쿠키 자료형인 RequestsCookieJar를 헤더에 직접 포함시킬 수 없기 때문에,\n쿠키를 적절한 형태의 문자열로 변환하는 get_cookies() 메소드를 정의합니다.\nCopy python from requests.cookies import RequestsCookieJar class NaverLogin(requests.Session): def get_cookies(self, **kwargs) -\u003e str: return self.parse_cookies(dict(self.cookies, **kwargs)) def parse_cookies(self, cookies: RequestsCookieJar) -\u003e str: return \"; \".join([str(key)+\"=\"+str(value) for key,value in cookies.items()]) 마치며 # 이번 게시글에서는 두 가지 데이터 수집 방식을 예시를 통해 알아보았고\n스마트스토어센터 로그인의 바탕이 되는 클래스와 메소드를 정의했습니다.\n다음 게시글에서는 네이버 로그인을 본격적으로 구현해보겠습니다.\n","wordCount":"999","inLanguage":"en","datePublished":"2022-12-03T13:56:14+09:00","dateModified":"2022-12-03T13:56:14+09:00","author":{"@type":"Person","name":"minyeamer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minyeamer.github.io/blog/smartstore-login-1/"},"publisher":{"@type":"Person","name":"Minystory","logo":{"@type":"ImageObject","url":"https://minyeamer.github.io/images/favicons/favicon.ico"}}}</script><title>[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1) | Minystory</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://minyeamer.github.io/blog/smartstore-login-1/><link rel=stylesheet href=/book.min.62dc4b2346a11e9a13be7a0d196670bb5af67df65ab7af97fca989a18278bf57.css integrity="sha256-YtxLI0ahHpoTvnoNGWZwu1r2ffZat6+X/KmJoYJ4v1c=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/search-input.min.d96703ecea94876541f8c7c2a377937aabc453dbf25b191ec06ed05c8eb76dbe.js integrity="sha256-2WcD7OqUh2VB+MfCo3eTeqvEU9vyWxkewG7QXI63bb4=" crossorigin=anonymous></script><link rel=preload href=/search-data.min.d8230bedff175a96b9214f4b0be4b94c0a75563fb182ddc9fe65cdc891987514.json as=fetch crossorigin><script>window.SEARCH_DATA_URL="/search-data.min.d8230bedff175a96b9214f4b0be4b94c0a75563fb182ddc9fe65cdc891987514.json"</script><script defer src=/search.min.f30f9834d4764fd9751da64098c954d01085f648ba9ca421a3c97582f8c47253.js integrity="sha256-8w+YNNR2T9l1HaZAmMlU0BCF9ki6nKQho8l1gvjEclM=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ8Z9RMBPJ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BJ8Z9RMBPJ")</script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css crossorigin=anonymous><script defer src=/scroll-progress.min.841ade7e507a5f6d59c4e7bf2fe2b2ca034070677ff7957eec55610a024dd776.js integrity="sha256-hBreflB6X21ZxOe/L+KyygNAcGd/95V+7FVhCgJN13Y=" crossorigin=anonymous></script><script defer src=/dark-mode.min.e41c6440ffd9967d6f6a419ff3ce09b862009fe1646ab265f5cb2817d2a508e3.js integrity="sha256-5BxkQP/Zln1vakGf884JuGIAn+FkarJl9csoF9KlCOM=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js></script><script defer src=/copy-code.min.aaeef965f0b4992e55f976edaecb34a89d414e1791caa18c3f4f4376c6d8b5a8.js integrity="sha256-qu75ZfC0mS5V+Xbtrss0qJ1BTheRyqGMP09DdsbYtag=" crossorigin=anonymous></script><script defer src=/toc-highlightjs.093016f0ef312174ad862fdcf5792e88ab5442bd39beecc38d15643f71ab5c31.min integrity="sha256-CTAW8O8xIXSthi/c9XkuiKtUQr05vuzDjRVkP3GrXDE=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-post book-layout-post"><div class=scroll-progress><div class=scroll-progress-bar></div></div><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><div class=sidebar-profile><div class=profile-img-wrap><a href=https://minyeamer.github.io/><img src=/images/profile/menu.jpg alt=Profile class=profile-img></a></div><div class=sidebar-social><a href=https://github.com/minyeamer target=_blank title=GitHub><i class="fa-brands fa-github"></i>
</a><a href=/categories/ title=Categories><i class="fa-solid fa-folder"></i>
</a><a href=/tags/ title=Tags><i class="fa-solid fa-tags"></i>
</a><button id=dark-mode-toggle class=dark-mode-toggle aria-label="Toggle dark mode">
<i class="fa-solid fa-circle-half-stroke"></i></button></div></div><h2 class=book-brand><a class="flex align-center" href=/><span>Minystory</span></a></h2><div class="book-search hidden"><div class=search-input-container><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/ onkeydown='event.key==="Enter"&&goToSearchPage()'>
<button type=button id=book-search-button class=book-search-btn onclick=goToSearchPage()>
<i class="fa-solid fa-magnifying-glass"></i></button></div><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden");function goToSearchPage(){const t=document.getElementById("book-search-input"),e=t.value.trim();e&&(window.location.href="/search/?q="+encodeURIComponent(e))}</script><div class=book-categories><input type=checkbox class="hidden toggle" id=categories-control checked>
<label for=categories-control class="categories-toggle categories-link"><a href=/categories/><i class="fa-solid fa-folder"></i>
<span>전체</span>
<span class=category-count>(9)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul class=categories-menu id=categories-menu><li><input type=checkbox class="hidden toggle" id=cat-data-engineering>
<label for=cat-data-engineering class="categories-toggle categories-link"><a href=/categories/data-engineering/><i class="fa-solid fa-folder"></i>
Data Engineering
<span class=category-count>(4)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-link><a href=/categories/data-engineering/crawling/><i class="fa-solid fa-file"></i>
Crawling
<span class=category-count>(4)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-frontend>
<label for=cat-frontend class="categories-toggle categories-link"><a href=/categories/frontend/><i class="fa-solid fa-folder"></i>
Frontend
<span class=category-count>(4)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-link><a href=/categories/frontend/blog/><i class="fa-solid fa-file"></i>
Blog
<span class=category-count>(4)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-project>
<label for=cat-project class="categories-toggle categories-link"><a href=/categories/project/><i class="fa-solid fa-folder"></i>
Project
<span class=category-count>(1)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-link><a href=/categories/project/open-source/><i class="fa-solid fa-file"></i>
Open Source
<span class=category-count>(1)</span></a></li></ul></li></ul></div><div class=recent-posts><div class=recent-posts-header><i class="fa-solid fa-clock"></i>
<span>최신글</span></div><ul class=recent-posts-list><li class=recent-post-item><a href=/blog/openup-handson/ title="[OSSCA] 2025 오픈소스 컨트리뷰션 아카데미 - PyTorch 문서 한글화 참여 후기"><div class=recent-post-title>[OSSCA] 2025 오픈소스 컨트리뷰션 아카데미 - PyTorch 문서 한글화 참여 후기</div><div class=recent-post-date><time datetime=2025-10-28>2025.10.28</time></div></a></li><li class=recent-post-item><a href=/blog/10000-recipe/ title="[Python] 만개의 레시피 데이터 수집"><div class=recent-post-title>[Python] 만개의 레시피 데이터 수집</div><div class=recent-post-date><time datetime=2023-03-26>2023.03.26</time></div></a></li><li class=recent-post-item><a href=/blog/smartstore-login-3/ title="[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (3)"><div class=recent-post-title>[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (3)</div><div class=recent-post-date><time datetime=2022-12-04>2022.12.04</time></div></a></li><li class=recent-post-item><a href=/blog/smartstore-login-2/ title="[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (2)"><div class=recent-post-title>[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (2)</div><div class=recent-post-date><time datetime=2022-12-03>2022.12.03</time></div></a></li><li class=recent-post-item><a href=/blog/smartstore-login-1/ title="[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)"><div class=recent-post-title>[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)</div><div class=recent-post-date><time datetime=2022-12-03>2022.12.03</time></div></a></li></ul></div></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><i class="fa-solid fa-bars book-icon" id=menu-icon></i></label><h3><a href=https://minyeamer.github.io/ class=site-title>Minystory</a></h3><label for=toc-control><i class="fa-solid fa-list book-icon" id=toc-icon></i></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#데이터-수집-개요>데이터 수집 개요</a><ul><li><a href=#데이터-수집-시나리오>데이터 수집 시나리오</a></li><li><a href=#로그인이-필요한-페이지의-데이터-가져오기>로그인이 필요한 페이지의 데이터 가져오기</a></li><li><a href=#쿠키-확인하기>쿠키 확인하기</a></li></ul></li><li><a href=#스마트스토어센터-로그인-개요>스마트스토어센터 로그인 개요</a><ul><li><a href=#클래스-정의>클래스 정의</a></li><li><a href=#헤더-생성-메소드-정의>헤더 생성 메소드 정의</a></li><li><a href=#쿠키-생성-메소드-정의>쿠키 생성 메소드 정의</a></li></ul></li><li><a href=#마치며>마치며</a></li></ul></nav><div class=book-nav><button class=book-nav-btn3 onclick='window.scrollTo({top:0,behavior:"smooth"})' title="Go to top">
<i class="fa fa-chevron-up"></i>
</button>
<button class=book-nav-btn3 onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' title="Go to bottom">
<i class="fa fa-chevron-down"></i>
<button class=book-nav-btn3 onclick=history.back() title="Go back">
<i class="fa-solid fa-arrow-left"></i></button></div></aside></header><article class="markdown book-article"><header class=post-header><div class=post-header-category><a href=/categories/data-engineering/crawling/ class=post-header-category-link>Data Engineering/Crawling</a></div><h1 class=post-header-title>[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (1)</h1><div class=post-header-date><time datetime=2022-12-03T13:56:14+09:00>2022. 12. 3. 13:56</time></div></header><p>네이버 스마트스토어센터에서는 매출 향상에 도움을 주는 유용한 통계 데이터를 제공해줍니다.<br>쇼핑몰 데이터를 분석하는 입장에서 무료로 제공되는 이런 데이터는 큰 도움이 되지만,<br>대부분이 엑셀 파일 다운로드를 지원하지 않고 빈번하게 수치가 바뀌는 데이터를 각각의 메뉴에서 매번 확인하기도 어렵습니다.<br>이런 데이터를 자동화 프로그램으로 수집 및 적재할 수 있다면 업무 효율을 크게 향상시킬 수 있을 것입니다.</p><p>이번 게시글에서는 실제 네이버 스마트스토어 로그인 구현에 앞서<br>데이터 수집에 대한 간단한 설명을 진행하고 네이버 로그인 구현의 바탕이 되는 클래스와 메소드를 정의합니다.</p><hr><h2 id=데이터-수집-개요>데이터 수집 개요
<a class=anchor href=#%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%88%98%ec%a7%91-%ea%b0%9c%ec%9a%94>#</a></h2><p>네이버 웹사이트에서 데이터를 수집할 때 활용할 수 있는 방안은 2가지가 있습니다.<br>첫 번째는 CSS Selector 또는 XPath를 활용해 웹사이트 특정 위치의 값을 가져오는 것,<br>두 번째는 API에 요청을 보내 JSON 형태의 데이터를 가져오는 것입니다.</p><p>특정 위치의 값을 가져오는 첫 번째 방식은 UI에 의존적이어서 코드의 지속성을 보장하기 어렵고<br>원하는 데이터와 관련없는 웹 소스 전체를 불러오기 때문에 속도 면에서도 단점이 있습니다.<br>따라서, API를 제공하는 경우 두 번째 방식을 이용하는 것이 효율적입니다.</p><h3 id=데이터-수집-시나리오>데이터 수집 시나리오
<a class=anchor href=#%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%88%98%ec%a7%91-%ec%8b%9c%eb%82%98%eb%a6%ac%ec%98%a4>#</a></h3><p>네이버 쇼핑에서 표시되는 상품의 순위는 검색인기도를 기준으로 결정됩니다.<br>키워드별 상위권 상품의 검색인기도를 가져오는 것을 예시로 데이터 수집을 진행해보겠습니다.</p><p><img src="https://github.com/minyeamer/til/blob/main/.media/data/crawling/smartstore-login/popularity-ui.png?raw=true" alt=popularity-ui></p><p>위 이미지에서 왼쪽 부분은 실제 UI, 오른쪽 부분은 HTML 소스 입니다.<br>해당 소스에서 데이터를 가져온다면 <code>div.popularity-product > div.box-border</code> 위치에서<br><code>dd</code> 태그를 순서대로 지정해서 각각의 종합, 적합도, 인기도 값을 가져올 수 있습니다.</p><p>해당 데이터를 분석에 활용하기 위해서는 인기도 수치를 구성하는 클릭수, 판매실적 등도 필요하기 때문에<br>상세보기 페이지를 확인해야하고 결과적으로 하나의 상품에 대한 데이터를 보기 위해 두 개의 페이지를 방문해야 합니다.</p><p>하지만 네이버의 대부분의 웹페이지는 API를 기반으로 가져온 데이터로 구성되기 때문에<br>해당 API를 활용할 수 있다면 더욱 효율적인 데이터 수집이 가능합니다.</p><p><img src="https://github.com/minyeamer/til/blob/main/.media/data/crawling/smartstore-login/popularity-json.png?raw=true" alt=popularity-json></p><p>서버에서 가져오는 데이터를 확인할 때는 주로 개발자 도구의 네트워크 탭을 활용합니다.<br>웹페이지 로드 시 가져오는 문서를 확인하다보면 위 이미지와 같이 목표로 하는 데이터를 보내주는 API를 발견할 수 있습니다.</p><p>새 탭에서 해당 API 주소를 요청하면 위 이미지 내 오른쪽 부분과 같은 JSON 형식의 데이터를 받을 수 있습니다.<br>실제 UI에서 가져오고자 하는 종합, 적합도, 인기도 수치도 해당 데이터에서 확인할 수 있습니다.<br>여기에는 추가로 클릭수, 판매실적 등에 대한 수치 데이터도 포함되어 있기 때문에<br>해당 API를 활용하면 다수의 페이지에 요청을 보낼 수고도 줄어들게 됩니다.</p><h3 id=로그인이-필요한-페이지의-데이터-가져오기>로그인이 필요한 페이지의 데이터 가져오기
<a class=anchor href=#%eb%a1%9c%ea%b7%b8%ec%9d%b8%ec%9d%b4-%ed%95%84%ec%9a%94%ed%95%9c-%ed%8e%98%ec%9d%b4%ec%a7%80%ec%9d%98-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ea%b0%80%ec%a0%b8%ec%98%a4%ea%b8%b0>#</a></h3><p>여기까지는 간단해보이지만 네이버 스마트스토어센터 데이터를 <code>requests</code> 모듈로 가져오는데는<br>하나의 추가적인 문제가 존재합니다.<br>단순한 GET 요청일지라도 로그인 정보를 갖고 있지 않다면 데이터를 받을 수 없습니다.<br>스마트스토어센터에 로그인하지 않은 상태에서 위 API 주소로 요청을 보내게 된다면<br>아래와 같은 에러 메시지를 받아볼 수 있습니다.</p><div class=book-codeblock data-lang=json><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">json</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Full authentication is required to access this resource&#34;</span> <span class=p>}</span></span></span></code></pre></div></div><p>이 문제에 대한 해결방법은 헤더에 있습니다.<br>개발자 도구 네트워크 탭에서 하나의 문서를 클릭하고 Headers 탭에서 스크롤을 내리면<br>아래와 같은 Request Headers 정보를 확인할 수 있습니다.</p><p><img src="https://github.com/minyeamer/til/blob/main/.media/data/crawling/smartstore-login/headers.png?raw=true" alt=headers></p><p>서버와 클라이언트 간 네트워크 요청 시 서버는 클라이언트의 정보를 확인할 목적으로<br>클라이언트에 쿠키라는 암호화된 인증 정보를 남깁니다.<br>클라이언트가 해당 정보를 헤더에 담아 요청을 보내는 경우에만 서버가 올바른 응답을 전달합니다.</p><p><code>requests</code> 모듈에서는 이러한 과정을 다음과 같이 구현할 수 있습니다.</p><div class=book-codeblock data-lang=python><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;cookie&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span></span></span></code></pre></div></div><p>하지만 일반적인 쿠키 값은 30분의 유통기한이 있기 때문에, 매번 쿠키 값을 갱신해야 하는데<br>자동화 프로그램을 돌리기 전에 직접 로그인해서 쿠키 값을 갱신하는 것은 바람직하지 못합니다.</p><p>결과적으로 로그인이 필요한 스마트스토어 페이지의 데이터를 가져오기 위해서는<br>자동화된 로그인 과정을 거쳐서 쿠키 값을 갱신할 필요가 있습니다.</p><h3 id=쿠키-확인하기>쿠키 확인하기
<a class=anchor href=#%ec%bf%a0%ed%82%a4-%ed%99%95%ec%9d%b8%ed%95%98%ea%b8%b0>#</a></h3><p>클라이언트에서 요청하는 헤더 내역에서 확인할 수 있는 정보는 표현하면 다음과 같습니다.</p><div class=book-codeblock data-lang=json><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">json</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;NNB&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;nid_inf&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;NID_AUT&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;NID_SES&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;NID_JKL&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CBI_SES&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CBI_CHK&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;NSI&#34;</span><span class=p>:</span> <span class=s2>&#34;...&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>이는 앞으로 스마트스토어센터 로그인을 구현하는데서 반드시 확인해야할 목록입니다.<br>지금은 이 값들이 어떤 의미를 가지고 어디서 발생하는 값인지 알 수는 없지만,<br>서버로부터 해당 값들을 받아오는 것에 집중하여 로그인 프로세스를 파악하고<br>로그인 진행 과정을 쿠키 값을 통해 시각적으로 점검할 것입니다.</p><hr><h2 id=스마트스토어센터-로그인-개요>스마트스토어센터 로그인 개요
<a class=anchor href=#%ec%8a%a4%eb%a7%88%ed%8a%b8%ec%8a%a4%ed%86%a0%ec%96%b4%ec%84%bc%ed%84%b0-%eb%a1%9c%ea%b7%b8%ec%9d%b8-%ea%b0%9c%ec%9a%94>#</a></h2><p>스마트스토어센터 로그인을 구현하기 위해 로그인 페이지를 탐색할 필요가 있습니다.</p><table><thead><tr><th style=text-align:center></th><th></th></tr></thead><tbody><tr><td style=text-align:center><img src="https://github.com/minyeamer/til/blob/main/.media/data/crawling/smartstore-login/smartstore-ui.png?raw=true" alt=smartstore-ui></td><td style=text-align:center><img src="https://github.com/minyeamer/til/blob/main/.media/data/crawling/smartstore-login/login-ui.png?raw=true" alt=login-ui></td></tr></tbody></table><p>메인 페이지에서 로그인하기 버튼을 클릭했을 때 이동하는 로그인 페이지에서 실제 로그인이 이루어집니다.<br>스마트스토어센터 로그인에는 판매자 아이디로 로그인하는 방식과<br>네이버 아이디로 로그인하는 방식이 있습니다.</p><p>우선적으로 네이버 아이디로 로그인하는 방식을 알아보겠습니다.</p><p>네이버 로그인을 구현하는 것에 관해선 좋은 선례가 있어 많은 부분을 참고했습니다.<br>해당 내용은 아래 링크를 참고할 수 있습니다.</p><blockquote class=book-hint><p><a href="https://blog.naver.com/PostView.naver?blogId=nkj2001&amp;logNo=222722322802" target=_blank rel="noopener noreferrer">파이썬#76 - 파이썬 크롤링 requests 로 네이버 로그인 하기</a></p></blockquote><h3 id=클래스-정의>클래스 정의
<a class=anchor href=#%ed%81%b4%eb%9e%98%ec%8a%a4-%ec%a0%95%ec%9d%98>#</a></h3><p>네이버 로그인 기능은 자동화 프로그램에서 지속적으로 활용될 것이기 때문에<br>별도의 클래스에서 메소드로 구현할 필요가 있습니다.</p><p>먼저 <code>requests</code> 모듈의 <code>Session</code> 클래스를 상속받는 <code>NaverLogin</code> 클래스를 정의합니다.</p><p><code>NaverLogin</code>은 네이버 ID와 비밀번호를 초기화하는 단순한 기능만을 구현했지만<br><code>requests.Session</code> 클래스를 상속받았기 때문에<br>웹페이지 요청과 관련된 다양한 기능을 가지고 있습니다.</p><div class=book-codeblock data-lang=python><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>NaverLogin</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>userid</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>passwd</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>userid</span> <span class=o>=</span> <span class=n>userid</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>passwd</span> <span class=o>=</span> <span class=n>passwd</span></span></span></code></pre></div></div><p>그리고 <code>NaverLogin</code>을 상속받는 <code>SmartstoreLogin</code> 클래스를 정의합니다.<br>일반적인 네이버 로그인과 스마트스토어센터에서 진행되는 네이버 로그인이 다르기 때문에<br><code>NaverLogin</code> 메소드의 일부를 변경할 필요가 있을 것입니다.</p><div class=book-codeblock data-lang=python><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>SmartstoreLogin</span><span class=p>(</span><span class=n>NaverLogin</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>userid</span><span class=o>=</span><span class=nb>str</span><span class=p>(),</span> <span class=n>passwd</span><span class=o>=</span><span class=nb>str</span><span class=p>(),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>userid</span><span class=p>,</span> <span class=n>passwd</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></span></span></code></pre></div></div><p>추가적으로 로그인 페이지 요청 과정에서 빈번하게 정의해야 하는 매개변수 생성을<br>간단하게 할 수 있는 메소드를 정의하겠습니다.</p><h3 id=헤더-생성-메소드-정의>헤더 생성 메소드 정의
<a class=anchor href=#%ed%97%a4%eb%8d%94-%ec%83%9d%ec%84%b1-%eb%a9%94%ec%86%8c%eb%93%9c-%ec%a0%95%ec%9d%98>#</a></h3><p><code>requests</code> 모듈은 기본적으로 헤더를 갖고 있지 않는데<br>이 상태로 다수의 웹페이지에 요청을 보낸다면 로봇으로 간주당해 차단당할 것입니다.</p><p>임의의 웹페이지에 요청을 보낼 때 확인할 수 있는 요청 헤더 <code>HEADERS</code>를 기본 바탕으로,<br>웹페이지 별로 최적화된 헤더를 생성하는 <code>get_headers()</code> 메소드를 정의합니다.</p><div class=book-codeblock data-lang=python><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>HEADERS</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Accept&#34;</span><span class=p>:</span> <span class=s2>&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Accept-Encoding&#34;</span><span class=p>:</span> <span class=s2>&#34;gzip, deflate, br&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Accept-Language&#34;</span><span class=p>:</span> <span class=s2>&#34;ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Connection&#34;</span><span class=p>:</span> <span class=s2>&#34;keep-alive&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sec-ch-ua&#34;</span><span class=p>:</span> <span class=s1>&#39;&#34;Chromium&#34;;v=&#34;106&#34;, &#34;Google Chrome&#34;;v=&#34;106&#34;, &#34;Not;A=Brand&#34;;v=&#34;99&#34;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sec-ch-ua-mobile&#34;</span><span class=p>:</span> <span class=s2>&#34;?0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sec-ch-ua-platform&#34;</span><span class=p>:</span> <span class=s1>&#39;&#34;Windows&#34;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sec-Fetch-Dest&#34;</span><span class=p>:</span> <span class=s2>&#34;empty&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sec-Fetch-Mode&#34;</span><span class=p>:</span> <span class=s2>&#34;cors&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sec-Fetch-Site&#34;</span><span class=p>:</span> <span class=s2>&#34;same-origin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;User-Agent&#34;</span><span class=p>:</span> <span class=s2>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><div class=book-codeblock data-lang=python><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib.parse</span> <span class=kn>import</span> <span class=n>urlparse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NaverLogin</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_headers</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>authority</span><span class=o>=</span><span class=nb>str</span><span class=p>(),</span> <span class=n>referer</span><span class=o>=</span><span class=nb>str</span><span class=p>(),</span> <span class=n>cookies</span><span class=o>=</span><span class=nb>str</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=n>host</span><span class=o>=</span><span class=nb>str</span><span class=p>(),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span> <span class=o>=</span> <span class=n>HEADERS</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>authority</span><span class=p>:</span> <span class=n>headers</span><span class=p>[</span><span class=s2>&#34;Authority&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>urlparse</span><span class=p>(</span><span class=n>authority</span><span class=p>)</span><span class=o>.</span><span class=n>hostname</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>host</span><span class=p>:</span> <span class=n>headers</span><span class=p>[</span><span class=s2>&#34;Host&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>urlparse</span><span class=p>(</span><span class=n>host</span><span class=p>)</span><span class=o>.</span><span class=n>hostname</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>referer</span><span class=p>:</span> <span class=n>headers</span><span class=p>[</span><span class=s2>&#34;Referer&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>referer</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cookies</span><span class=p>:</span> <span class=n>headers</span><span class=p>[</span><span class=s2>&#34;Cookie&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cookies</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>dict</span><span class=p>(</span><span class=n>headers</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></span></span></code></pre></div></div><p>호스트명을 의미하는 <code>Authority</code> 또는 <code>Host</code>, 리다이렉트 전 경로를 의미하는 <code>Referer</code>,<br>그리고 쿠키를 의미하는 <code>Cookie</code> 등의 값은 수시로 변하기 때문에 별도의 입력으로 지정합니다.</p><h3 id=쿠키-생성-메소드-정의>쿠키 생성 메소드 정의
<a class=anchor href=#%ec%bf%a0%ed%82%a4-%ec%83%9d%ec%84%b1-%eb%a9%94%ec%86%8c%eb%93%9c-%ec%a0%95%ec%9d%98>#</a></h3><p>헤더와 함께 활용되는 쿠키는 헤더와 마찬가지로 웹페이지 요청 시 빈번히 활용되는데<br><code>requests</code> 모듈의 쿠키 자료형인 <code>RequestsCookieJar</code>를 헤더에 직접 포함시킬 수 없기 때문에,<br>쿠키를 적절한 형태의 문자열로 변환하는 <code>get_cookies()</code> 메소드를 정의합니다.</p><div class=book-codeblock data-lang=python><div class=code-actions><button class="code-copy-btn code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>requests.cookies</span> <span class=kn>import</span> <span class=n>RequestsCookieJar</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NaverLogin</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_cookies</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>parse_cookies</span><span class=p>(</span><span class=nb>dict</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cookies</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>parse_cookies</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cookies</span><span class=p>:</span> <span class=n>RequestsCookieJar</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;; &#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>str</span><span class=p>(</span><span class=n>key</span><span class=p>)</span><span class=o>+</span><span class=s2>&#34;=&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span><span class=n>value</span> <span class=ow>in</span> <span class=n>cookies</span><span class=o>.</span><span class=n>items</span><span class=p>()])</span></span></span></code></pre></div></div><hr><h2 id=마치며>마치며
<a class=anchor href=#%eb%a7%88%ec%b9%98%eb%a9%b0>#</a></h2><p>이번 게시글에서는 두 가지 데이터 수집 방식을 예시를 통해 알아보았고<br>스마트스토어센터 로그인의 바탕이 되는 클래스와 메소드를 정의했습니다.</p><p>다음 게시글에서는 네이버 로그인을 본격적으로 구현해보겠습니다.</p></article><div class=book-mobile-nav><button class=book-nav-btn3 onclick='window.scrollTo({top:0,behavior:"smooth"})' title="Go to top">
<i class="fa fa-chevron-up"></i>
</button>
<button class=book-nav-btn3 onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' title="Go to bottom">
<i class="fa fa-chevron-down"></i>
<button class=book-nav-btn3 onclick=history.back() title="Go back">
<i class="fa-solid fa-arrow-left"></i></button></div><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class=post-tags><a href=/tags/crawling/ class=tag>#Crawling</a>
<a href=/tags/python/ class=tag>#Python</a>
<a href=/tags/naver/ class=tag>#Naver</a>
<a href=/tags/%EB%84%A4%EC%9D%B4%EB%B2%84/ class=tag>#네이버</a>
<a href=/tags/%EC%8A%A4%EB%A7%88%ED%8A%B8%EC%8A%A4%ED%86%A0%EC%96%B4/ class=tag>#스마트스토어</a></div><div class=post-navigation><a href=/blog/smartstore-login-2/ class="post-nav-link post-nav-prev"><span class=post-nav-direction><i class="fa-solid fa-backward"></i> PREV</span>
<span class=post-nav-title>[Python] requests로 네이버 스마트스토어센터 로그인 구현하기 (2)</span>
</a><a href class="post-nav-link post-nav-next post-nav-disabled"><span class=post-nav-direction>NEXT <i class="fa-solid fa-forward"></i></span>
<span class=post-nav-title>다음 게시글이 없습니다</span></a></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script><div class=book-comments><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://minyeamer.github.io/blog/smartstore-login-1/",this.page.identifier="https://minyeamer.github.io/blog/smartstore-login-1/"};(function(){var e=document,t=e.createElement("script");t.src="https://minyeamer.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})();function reloadDisqus(){window.DISQUS&&DISQUS.reset({reload:!0,config:function(){this.page.url="https://minyeamer.github.io/blog/smartstore-login-1/",this.page.identifier="https://minyeamer.github.io/blog/smartstore-login-1/"}})}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#데이터-수집-개요>데이터 수집 개요</a><ul><li><a href=#데이터-수집-시나리오>데이터 수집 시나리오</a></li><li><a href=#로그인이-필요한-페이지의-데이터-가져오기>로그인이 필요한 페이지의 데이터 가져오기</a></li><li><a href=#쿠키-확인하기>쿠키 확인하기</a></li></ul></li><li><a href=#스마트스토어센터-로그인-개요>스마트스토어센터 로그인 개요</a><ul><li><a href=#클래스-정의>클래스 정의</a></li><li><a href=#헤더-생성-메소드-정의>헤더 생성 메소드 정의</a></li><li><a href=#쿠키-생성-메소드-정의>쿠키 생성 메소드 정의</a></li></ul></li><li><a href=#마치며>마치며</a></li></ul></nav><div class=book-nav><button class=book-nav-btn3 onclick='window.scrollTo({top:0,behavior:"smooth"})' title="Go to top">
<i class="fa fa-chevron-up"></i>
</button>
<button class=book-nav-btn3 onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' title="Go to bottom">
<i class="fa fa-chevron-down"></i>
<button class=book-nav-btn3 onclick=history.back() title="Go back">
<i class="fa-solid fa-arrow-left"></i></button></div></div></aside></main></body></html>