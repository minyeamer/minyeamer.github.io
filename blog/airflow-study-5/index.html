<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><meta name=author content><meta name=keywords content="Apache Airflow,TriggerDagRunOperator,TaskGroup,Trigger Rule,Edge Label,데이터 엔지니어링,에어플로우,Python,Study"><meta name=description content="Apache Airflow의 Trigger Rule과 TriggerDagRunOperator 개념을 소개하고, TaskGroup과 Edge Label 사용법을 단계별로 안내합니다. …"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><link rel=icon href=https://minyeamer.github.io/images/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://minyeamer.github.io/images/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://minyeamer.github.io/images/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><link rel=mask-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><meta name=google-site-verification content="u1tWcHmHUZWfFT1cHaku6sqU-bK40N3WLR-C-4VUWN0"><meta name=naver-site-verification content="6eaf8e9da1a6104780f056f1a7797fe5a3a5a0da"><meta property="og:title" content="Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)"><meta property="og:description" content="Apache Airflow의 Trigger Rule과 TriggerDagRunOperator 개념을 소개하고, TaskGroup과 Edge Label 사용법을 단계별로 안내합니다. …"><meta property="og:type" content="article"><meta property="og:url" content="https://minyeamer.github.io/blog/airflow-study-5/"><meta property="og:image" content="https://dl.dropboxusercontent.com/scl/fi/8oxi6rw0kesl9l3egs78s/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle&amp;raw=1"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-07T11:08:37+09:00"><meta property="article:modified_time" content="2025-06-07T11:08:37+09:00"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-7/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-6/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-4/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-3/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-2/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dl.dropboxusercontent.com/scl/fi/8oxi6rw0kesl9l3egs78s/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle&amp;raw=1"><meta name=twitter:title content="Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)"><meta name=twitter:description content="Apache Airflow의 Trigger Rule과 TriggerDagRunOperator 개념을 소개하고, TaskGroup과 Edge Label 사용법을 단계별로 안내합니다. …"><meta name=twitter:site content="@https://x.com/minyeamer"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minyeamer.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)","item":"https://minyeamer.github.io/blog/airflow-study-5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)","name":"Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)","description":"Apache Airflow의 Trigger Rule과 TriggerDagRunOperator 개념을 소개하고, TaskGroup과 Edge Label 사용법을 단계별로 안내합니다. DAG 실행 트리거, 그룹화, 라벨링, Trigger Rule 옵션까지 다룹니다.\n","keywords":["Apache Airflow, TriggerDagRunOperator, TaskGroup, Trigger Rule, Edge Label, 데이터 엔지니어링, 에어플로우, Python, Study"],"articleBody":" Apache Airflow 배우기 1. 설치하기 (Docker Compose) 2. 기본 Operator 이해하기 (Bash, Python) 3. 데이터 전달과 템플릿 활용 (Jinja, XCom, Variable) 4. 조건부 실행과 알림 (Branch, Email Operator) 5. DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup) 6. REST API 연동과 Custom Operator 구현 7. 외부 시스템 연동 (Connection, Hook, PostgreSQL) 숨기기 목록 보기 5/7 Trigger Rule # Dags — Airflow 3.1.3 Documentationairflow.apache.org 상위 Task들의 상태에 따라 수행여부를 결정하고 싶을 때 사용 기본적으로는 상위 Task가 모두 성공해야 실행 Trigger Rule 종류 # 옵션 설명 all_success 기본값, 상위 Task가 모두 성공하면 실행 all_failed 상위 Task가 모두 failed 상태면 실행 all_done 상위 Task가 모두 수행되면 실행 (성공 또는 실패) all_skipped 상위 Task가 모두 skipped 상태면 실행 one_failed 상위 Task 중 하나 이상 실패하면 실행 one_success 상위 Task 중 하나 이상 성공하면 실행 one_done 상위 Task 중 하나 이상 수행되면 실행 (성공 또는 실패) none_failed 상위 Task 중에 failed 상태가 없으면 실행 none_failed_min_one_success 상위 Task 중에 failed 상태가 없고 성공한 Task가 1개 이상이면 실행 none_skipped 상위 Task 중에 skipped 상태가 없으면 실행 always 항상 실행 all_done 예시 # all_done 의 동작을 확인하기 위한 예시 DAG 작성 3개의 상위 Task 중 2번째 Task에서 의도적으로 예외를 발생시켜서 failed 상태를 유발 하위 Task downstream_task 에 trigger_rule 파라미터로 all_done 전달 Copy python # dags/trigger_rule1.py from airflow.sdk import DAG, task from airflow.exceptions import AirflowException from airflow.providers.standard.operators.bash import BashOperator import pendulum with DAG( dag_id=\"trigger_rule1\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: upstream_task1 = BashOperator( task_id=\"upstream_task1\", bash_command=\"echo upstream1\" ) @task(task_id=\"upstream_task2\") def upstream_task2(): raise AirflowException(\"upstream2 Exception\") @task(task_id=\"upstream_task3\") def upstream_task3(): print(\"정상 처리\") @task(task_id=\"downstream_task\", trigger_rule=\"all_done\") def downstream_task(): print(\"정상 처리\") [upstream_task1, upstream_task2(), upstream_task3()] \u003e\u003e downstream_task() all_done 은 상위 Task가 성공 또는 실패 여부에 관계없이 모두 수행되면 실행하는 옵션으로, upstream_task2 가 실패 처리되어도 downstream_task 가 수행되는 모습을 확인 none_skipped 예시 # none_skipped 의 동작을 확인하기 위한 예시 DAG 작성 3개의 상위 Task 중 랜덤한 한 Task만 수행하고 나머지 Task에선 skipped 상태를 유발 하위 Task downstream_task 에 trigger_rule 파라미터로 none_skipped 전달 Copy python # dags/trigger_rule2.py from airflow.sdk import DAG, task from airflow.providers.standard.operators.bash import BashOperator import pendulum with DAG( dag_id=\"trigger_rule2\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: @task.branch(task_id=\"branching\") def random_branch(): import random item_lst = ['A','B','C'] selected_item = random.choice(item_lst) if selected_item == 'A': return \"upstream_task_a\" elif selected_item == 'B': return \"upstream_task_b\" elif selected_item == 'C': return \"upstream_task_c\" upstream_task_a = BashOperator( task_id=\"upstream_task_a\", bash_command=\"echo upstream1\" ) @task(task_id=\"upstream_task_b\") def upstream_task_b(): print(\"정상 처리\") @task(task_id=\"upstream_task_c\") def upstream_task_c(): print(\"정상 처리\") @task(task_id=\"downstream_task\", trigger_rule=\"none_skipped\") def downstream_task(): print(\"정상 처리\") random_branch() \u003e\u003e [upstream_task_a, upstream_task_b(), upstream_task_c()] \u003e\u003e downstream_task() none_skipped 은 상위 Task가 skipped 상태가 아니어야 실행하는 옵션으로, upstream_task1 만 성공하고 나머지는 skipped 처리되었기 때문에, downstream_task 도 수행되지 못하고 skipped 처리 TriggerDagRunOperator # airflow.operators.trigger_dagrun — Airflow Documentationairflow.apache.org 다른 DAG을 실행시키는 Operator 실행할 다른 DAG의 ID를 지정하여 수행 선행 DAG이 하나만 있을 경우 TriggerDagRunOperator 를 사용하고, 선행 DAG이 2개 이상인 경우는 ExternalTaskSensor 를 사용 권장 run_id # DAG의 수행 방식과 시간을 유일하게 식별해주는 키 수행 방식(Schedule, manual, Backfill)에 따라 키가 달라짐 스케줄에 의해 실행된 경우 scheduled__{{data_interval_start}} 값을 가짐 예시) scheduled__2025-06-01T00:00:00+00:00 TriggerDagRun 활용 # trigger_run_id : DAG을 실행시킬 때 어떤 run_id 로 실행할지 지정 가능 logical_date : DAG이 트리거된 시간을 지정 가능, manual__{{logical_date}} reset_dag_run : run_id 로 수행된 이력이 있어도 실행시키려면 True 로 설정 wait_for_completion : 지정한 DAG이 완료되어야 다음 Task를 실행하고 싶을 경우 True 로 설정 기본적으로는 DAG의 완료 여부에 관계없이 success 로 빠져나가 다음 Task를 실행 poke_interval : 지정한 DAG이 완료되었는지 확인하는 주기 allowed_states : Task가 success 상태가 되기 위한 DAG의 처리 상태 목록 failed_states : Task가 failed 상태가 되기 위한 DAG의 처리 상태 목록 Copy python # dags/trigger_dagrun.py from airflow.sdk import DAG from airflow.providers.standard.operators.trigger_dagrun import TriggerDagRunOperator from airflow.providers.standard.operators.bash import BashOperator import pendulum with DAG( dag_id=\"trigger_dagrun\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"dagrun\"], ) as dag: start_task = BashOperator( task_id=\"start_task\", bash_command=\"echo \\\"start!\\\"\", ) trigger_dag_task = TriggerDagRunOperator( task_id=\"trigger_dag_task\", trigger_dag_id=\"python_operator\", trigger_run_id=None, logical_date=\"{{data_interval_start}}\", reset_dag_run=True, wait_for_completion=False, poke_interval=60, allowed_states=[\"success\"], failed_states=None ) start_task \u003e\u003e trigger_dag_taskDAG 실행 # trigger_dag_task 의 실행 로그에서 python_operator 가 호출된 것을 확인 Copy bash [2025-06-07, 10:52:54] INFO - DAG bundles loaded: dags-folder: source=\"airflow.dag_processing.bundles.manager.DagBundlesManager\" [2025-06-07, 10:52:54] INFO - Filling up the DagBag from /opt/airflow/dags/trigger_dagrun.py: source=\"airflow.models.dagbag.DagBag\" [2025-06-07, 10:52:54] INFO - Triggering Dag Run.: trigger_dag_id=\"python_operator\": source=\"task\" [2025-06-07, 10:52:54] INFO - Dag Run triggered successfully.: trigger_dag_id=\"python_operator\": source=\"task\" 두 번째 이미지인 PythonOperator의 run_id 가 첫 번째 이미지인 TriggerDagRunOperator의 실행 시간과 같다는 것을 알 수 있으며, trigger_run_id 를 지정하지 않았기 때문에 manual 로 지정 TaskGroup # Dags — Airflow 3.1.3 Documentationairflow.apache.org 여러 Task들을 그룹화하는 개념 UI 상에서 Task들을 모아서 편하게 보고 관리하기 쉽게 하기 위한 목적 TaskGroup 활용 # @task_group 데코레이터 또는 TaskGroup 클래스를 활용하여 TaskGroup을 구현 docstring을 추가해 Airflow UI에서 TaskGroup에 대한 Tooltip을 표시 또는, tooltip 파라미터로 UI에 표시할 내용을 전달할 수도 있음 (파라미터가 docstring보다 우선) Copy python # dags/task_group.py from airflow.sdk import DAG, task, task_group, TaskGroup from airflow.providers.standard.operators.python import PythonOperator import pendulum with DAG( dag_id=\"task_group\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: def inner_function2(**kwargs): msg = kwargs.get(\"msg\") or str() print(msg) @task_group(group_id=\"first_group\") def first_group(): \"\"\" 첫 번째 TaskGroup 에 대한 Tooltip 입니다. \"\"\" @task(task_id=\"inner_function1\") def inner_function1(**kwargs): print(\"첫 번째 TaskGroup 내 첫 번째 Task 입니다.\") inner_function2 = PythonOperator( task_id=\"inner_function2\", python_callable=inner_function2, op_kwargs={\"msg\":\"첫 번째 TaskGroup 내 두 번째 Task 입니다.\"} ) inner_function1() \u003e\u003e inner_function2 with TaskGroup(group_id=\"second_group\", tooltip=\"두 번째 TaskGroup 에 대한 Tooltip 입니다.\") as second_group: \"\"\" tooltip 파라미터의 내용이 우선적으로 표시됩니다. \"\"\" @task(task_id=\"inner_function1\") def inner_function1(**kwargs): print(\"두 번째 TaskGroup 내 첫 번째 Task 입니다.\") inner_function2 = PythonOperator( task_id=\"inner_function2\", python_callable=inner_function2, op_kwargs={\"msg\": \"두 번째 TaskGroup 내 두 번째 Task 입니다.\"} ) inner_function1() \u003e\u003e inner_function2 first_group() \u003e\u003e second_groupTaskGroup 조회 # DAG 실행 후 Graph View에서 두 개의 TaskGroup을 확인 기대와 다르게 지정한 Tooltip이 표시되지 않았는데, Airflow 3.0 버전의 버그인 것으로 추정 TaskGroup을 클릭하면 펼쳐지면서 내부 Task를 표시 Edge Label # Dags — Airflow 3.1.3 Documentationairflow.apache.org Task 연결에 대한 설명을 추가하는 개념 Task 종속성을 나타내는 \u003e\u003e 또는 \u003c\u003c 연산자 사이에 Label 을 추가 Edge Label 활용 # 첫 번째 Label은 두 개의 단일 Task 사이를 연결 두 번째와 세 번째 Label은 Branch의 시작과 끝을 각각 연결 Copy python # dags/edge_label.py from airflow.sdk import DAG, Label from airflow.providers.standard.operators.empty import EmptyOperator import pendulum with DAG( dag_id=\"edge_label\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: empty_1 = EmptyOperator( task_id=\"empty_1\" ) empty_2 = EmptyOperator( task_id=\"empty_2\" ) empty_1 \u003e\u003e Label(\"라벨\") \u003e\u003e empty_2 empty_3 = EmptyOperator( task_id=\"empty_3\" ) empty_4 = EmptyOperator( task_id=\"empty_4\" ) empty_5 = EmptyOperator( task_id=\"empty_5\" ) empty_6 = EmptyOperator( task_id=\"empty_6\" ) empty_2 \u003e\u003e Label(\"브랜치 시작\") \u003e\u003e [empty_3,empty_4,empty_5] \u003e\u003e Label(\"브랜치 종료\") \u003e\u003e empty_6Edge Label 조회 # Airflow UI의 Graph View에서 Edge Label을 확인 Branch 연결에 대해서는 모든 연결에 동일한 내용의 Label을 표시 ","wordCount":"1085","inLanguage":"ko","image":"https:\/\/dl.dropboxusercontent.com\/scl\/fi\/8oxi6rw0kesl9l3egs78s\/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle\u0026raw=1","datePublished":"2025-06-07T11:08:37+09:00","dateModified":"2025-06-07T11:08:37+09:00","author":{"@type":"Person","name":"minyeamer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minyeamer.github.io/blog/airflow-study-5/"},"publisher":{"@type":"Person","name":"Minystory","logo":{"@type":"ImageObject","url":"https://minyeamer.github.io/images/favicons/favicon.ico"}}}</script><script>(function(){const e=256+768*1.3;window.innerWidth>e&&localStorage.getItem("menu-expanded")==="false"&&document.documentElement.classList.add("menu-initial-collapsed")})()</script><title>Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)</title><link rel=icon href=/images/favicon.ico><link rel=manifest href=/data/manifest.json><link rel=canonical href=https://minyeamer.github.io/blog/airflow-study-5/><link rel=stylesheet href=/main.min.44fc0505f6872b4a598b54c012cea774317b8a26d8041717a50b96fa828c4449.css integrity="sha256-RPwFBfaHK0pZi1TAEs6ndDF7iibYBBcXpQuW+oKMREk=" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ8Z9RMBPJ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BJ8Z9RMBPJ")</script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css crossorigin=anonymous><script>(function(){const e=console.warn;console.warn=function(...n){const t=(new Error).stack||"";if(t.includes("highlight.min.js")||t.includes("highlightjs-line-numbers"))return;e.apply(console,n)}})()</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js crossorigin=anonymous></script><script defer src=/js/scroll-progress.min.841ade7e507a5f6d59c4e7bf2fe2b2ca034070677ff7957eec55610a024dd776.js integrity="sha256-hBreflB6X21ZxOe/L+KyygNAcGd/95V+7FVhCgJN13Y=" crossorigin=anonymous></script><script defer src=/js/menu-toggle.min.dd99cf31bd583912ea1bbd2c953c8c6b53d89da9846e8f05c9189de9369c97c9.js integrity="sha256-3ZnPMb1YORLqG70slTyMa1PYnamEbo8FyRid6Tacl8k=" crossorigin=anonymous></script><script defer src=/js/toc-toggle.min.48870f47596275987bbd50f04ba301b2b9469da2b3ed9d94e569774691851717.js integrity="sha256-SIcPR1lidZh7vVDwS6MBsrlGnaKz7Z2U5Wl3RpGFFxc=" crossorigin=anonymous></script><script defer src=/js/set-theme.min.986446861d7c48b101b4a6f53724b7fc97d6efec2a87906c6630cb9e503897c4.js integrity="sha256-mGRGhh18SLEBtKb1NyS3/JfW7+wqh5BsZjDLnlA4l8Q=" crossorigin=anonymous></script><script defer src=/js/copy-code.min.e18ffc44cf6beb1757c467945bb2897b0e1cb2ee52f08b460ee3ee57f0db6d60.js integrity="sha256-4Y/8RM9r6xdXxGeUW7KJew4csu5S8ItGDuPuV/DbbWA=" crossorigin=anonymous></script><script defer src=/js/toc-highlight.min.7917ead4ecb7378779bfbf3f988251ac76bd55ca7f12fd5919870777dbcd6095.js integrity="sha256-eRfq1Oy3N4d5v78/mIJRrHa9Vcp/Ev1ZGYcHd9vNYJU=" crossorigin=anonymous></script><script defer src=/js/reading-time.min.c8cf75fb9d8569d73b13b6a2bf6f52c235ff03ad7848e0386ccce2d7dcb8d9be.js integrity="sha256-yM91+52Fadc7E7aiv29SwjX/A614SOA4bMzi19y42b4=" crossorigin=anonymous></script><script defer src=/js/image-zoom.min.73ef1954212429af5df3e0386860f8f9b32748998c0ed1eb62ed800e348a2fab.js integrity="sha256-c+8ZVCEkKa9d8+A4aGD4+bMnSJmMDtHrYu2ADjSKL6s=" crossorigin=anonymous></script><script>window.siteSearch=window.siteSearch||{}</script><script>window.siteSearch.contentUrl="/data/content.min.f3b652cb66cb040f8eb5ca20c06922a9440fe7ee107052a23170db218558f251.json"</script><script>window.siteSearch.categoriesUrl="/data/categories.min.249a3bfbb1ae8ee6e09c08bd2449462f8e161c8a98748da0169c2abe6f79598e.json"</script><script>window.siteSearch.tagsUrl="/data/tags.min.11b7d30fcd3cbb5269823c54a83c4889d580a62df2d1988344ddf158197da767.json"</script><script defer src=/fuse.min.js></script><script defer src=/js/search/init.min.3ec02e8ced439eef10e68b1663c5dab0c0ec89f63a79e154e33b0d62221bdbdb.js integrity="sha256-PsAujO1Dnu8Q5osWY8XasMDsifY6eeFU4zsNYiIb29s=" crossorigin=anonymous></script><script defer src=/js/search/input.min.0e671152b340ac6a9b9fbe81fc80cbc821f1d7dd4faf0c80a2195b52a3373c84.js integrity="sha256-DmcRUrNArGqbn76B/IDLyCHx191PrwyAohlbUqM3PIQ=" crossorigin=anonymous></script><script defer src=/js/search/list.min.985cf5b5f5b98133bffdd5b9f1d502cf1deb431146225583ca9d116ed6d737be.js integrity="sha256-mFz1tfW5gTO//dW58dUCzx3rQxFGIlWDyp0RbtbXN74=" crossorigin=anonymous></script></head><body dir=ltr class="site-kind-page site-type-posts site-layout-post"><div class=scroll-progress><div class=scroll-progress-bar></div></div><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=menu-overlay></div><main class=container><aside class=site-menu aria-label=메뉴><div class=menu-content><nav><div class=menu-profile><div class=profile-image-wrap><a href=https://minyeamer.github.io/><img src=/images/profile/menu.jpg alt=Profile class=profile-image decoding=async></a></div><h2 class=profile-title><a class="flex align-center" href=https://minyeamer.github.io/><span>Minystory</span></a></h2></div><div class=menu-links><a href=https://github.com/minyeamer target=_blank id=github-link title=GitHub><i class="fa-brands fa-github"></i>
</a><a href=/categories/ id=categories-link title=Categories><i class="fa-solid fa-folder"></i>
</a><a href=/tags/ id=tags-link title=Tags><i class="fa-solid fa-tags"></i>
</a><button class=dark-mode-toggle id=theme-toggle-button aria-label="Toggle color scheme">
<i class="fa-solid fa-circle-half-stroke"></i></button></div><div class=menu-search id=search-input data-hotkeys=s/ role=button tabindex=0 aria-label=검색><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=search-placeholder><code>/</code> 를 눌러 검색하세요</span></div><div class=menu-categories><input type=checkbox class="hidden toggle" id=categories-control checked>
<label for=categories-control class="categories-label categories-toggle"><a href=/categories/ class=categories-root><i class="fa-solid fa-folder"></i>
전체
<span class=category-count>(40)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li><input type=checkbox class="hidden toggle" id=cat-algorithm>
<label for=cat-algorithm class="categories-label categories-toggle"><a href="/search/?category1=Algorithm"><i class="fa-solid fa-folder"></i>Algorithm<span class=category-count>(4)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Algorithm&category2=Graph"><i class="fa-solid fa-file"></i>Graph<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=Python"><i class="fa-solid fa-file"></i>Python<span class=category-count>(2)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=SQL"><i class="fa-solid fa-file"></i>SQL<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-cloud>
<label for=cat-cloud class="categories-label categories-toggle"><a href="/search/?category1=Cloud"><i class="fa-solid fa-folder"></i>Cloud<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Cloud&category2=Kubernetes"><i class="fa-solid fa-file"></i>Kubernetes<span class=category-count>(2)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-analysis>
<label for=cat-data-analysis class="categories-label categories-toggle"><a href="/search/?category1=Data%20Analysis"><i class="fa-solid fa-folder"></i>Data Analysis<span class=category-count>(3)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Analysis&category2=Dacon"><i class="fa-solid fa-file"></i>Dacon<span class=category-count>(3)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-engineering>
<label for=cat-data-engineering class="categories-label categories-toggle"><a href="/search/?category1=Data%20Engineering"><i class="fa-solid fa-folder"></i>Data Engineering<span class=category-count>(19)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Airflow"><i class="fa-solid fa-file"></i>Apache Airflow<span class=category-count>(7)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Spark"><i class="fa-solid fa-file"></i>Apache Spark<span class=category-count>(8)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Crawling"><i class="fa-solid fa-file"></i>Crawling<span class=category-count>(4)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-frontend>
<label for=cat-frontend class="categories-label categories-toggle"><a href="/search/?category1=Frontend"><i class="fa-solid fa-folder"></i>Frontend<span class=category-count>(9)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Frontend&category2=Blog"><i class="fa-solid fa-file"></i>Blog<span class=category-count>(9)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-linux>
<label for=cat-linux class="categories-label categories-toggle"><a href="/search/?category1=Linux"><i class="fa-solid fa-folder"></i>Linux<span class=category-count>(1)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Linux&category2=Ubuntu"><i class="fa-solid fa-file"></i>Ubuntu<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-project>
<label for=cat-project class="categories-label categories-toggle"><a href="/search/?category1=Project"><i class="fa-solid fa-folder"></i>Project<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Project&category2=Open%20Source"><i class="fa-solid fa-file"></i>Open Source<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Project&category2=Tools"><i class="fa-solid fa-file"></i>Tools<span class=category-count>(1)</span></a></li></ul></li></ul></div><div class=recent-posts><div class=recent-post-label><i class="fa-solid fa-clock"></i>
<span>최신글</span></div><ul class=recent-post-list><li class=recent-post-item><a href=/blog/hugo-blog-5/ title="Hugo 블로그 만들기 (5) - 본문 레이아웃 개선 (헤더와 푸터 및 Disqus 댓글 기능 구현)"><div class=recent-post-title>Hugo 블로그 만들기 (5) - 본문 레이아웃 개선 (헤더와 푸터 및 Disqus 댓글 기능 구현)</div><div class=recent-post-date><time datetime=2025-12-15>2025.12.15</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-4/ title="Hugo 블로그 만들기 (4) - 검색 기능 개선 및 검색 페이지 구현 (Fuse.js)"><div class=recent-post-title>Hugo 블로그 만들기 (4) - 검색 기능 개선 및 검색 페이지 구현 (Fuse.js)</div><div class=recent-post-date><time datetime=2025-12-14>2025.12.14</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-3/ title="Hugo 블로그 만들기 (3) - Taxonomies로 태그/카테고리 페이지 커스터마이징"><div class=recent-post-title>Hugo 블로그 만들기 (3) - Taxonomies로 태그/카테고리 페이지 커스터마이징</div><div class=recent-post-date><time datetime=2025-11-22>2025.11.22</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-2/ title="Hugo 블로그 만들기 (2) - 메인 레이아웃 커스터마이징 (메뉴, 목차, 헤더)"><div class=recent-post-title>Hugo 블로그 만들기 (2) - 메인 레이아웃 커스터마이징 (메뉴, 목차, 헤더)</div><div class=recent-post-date><time datetime=2025-11-04>2025.11.04</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-1/ title="Hugo 블로그 만들기 (1) - 프로젝트 구성과 GitHub Pages 배포 (Submodule 활용)"><div class=recent-post-title>Hugo 블로그 만들기 (1) - 프로젝트 구성과 GitHub Pages 배포 (Submodule 활용)</div><div class=recent-post-date><time datetime=2025-11-01>2025.11.01</time></div></a></li></ul></div></nav><script>(function(){var e=document.querySelector("aside .menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=main-wrap><header class=site-header><div class="flex align-center justify-between"><label for=menu-control aria-label="메뉴 접기/펼치기" title="메뉴 접기/펼치기"><i class="fa-solid fa-bars menu-icon" id=menu-icon></i></label><div class=mobile-search id=mobile-search-input role=button tabindex=0 aria-label=검색><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=mobile-title>Minystory</span>
<i class=mobile-title-pad></i></div><label for=toc-control aria-label="목차 접기/펼치기" title="목차 접기/펼치기"><i class="fa-solid fa-list menu-icon" id=toc-icon></i></label></div></header><article class="content-wrap markdown"><header class=content-header><div class=content-category><a href="/search/?category1=Data%20Engineering&category2=Apache%20Airflow" class=content-category-link>Data Engineering/Apache Airflow</a></div><h1 class=content-title>Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)</h1><div class=content-datetime><time datetime=2025-06-07T11:08:37+09:00>2025. 6. 7. 11:08
</time><span id=reading-time></span></div></header><div class=content-cover-wrap><img src="https://dl.dropboxusercontent.com/scl/fi/8oxi6rw0kesl9l3egs78s/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle&amp;raw=1" class=content-cover alt="Cover Image" decoding=async></div><div id=series-anchor></div><div class=sc-series><div class=series-bookmark><svg width="32" height="48" fill="currentColor" viewBox="0 0 32 48" class="series-corner-image"><path fill="currentColor" d="M32 0H0v48h.163l16-16L32 47.836V0z"/></svg></div><div class=series-header><h2 class=series-title>Apache Airflow 배우기</h2></div><input type=checkbox id=series-toggle class=series-toggle-input hidden><div class=series-content><ol class=series-list><li class=series-item><span class=series-item-index>1.</span>
<a href=/blog/airflow-study-1/#series-anchor>설치하기 (Docker Compose)</a></li><li class=series-item><span class=series-item-index>2.</span>
<a href=/blog/airflow-study-2/#series-anchor>기본 Operator 이해하기 (Bash, Python)</a></li><li class=series-item><span class=series-item-index>3.</span>
<a href=/blog/airflow-study-3/#series-anchor>데이터 전달과 템플릿 활용 (Jinja, XCom, Variable)</a></li><li class=series-item><span class=series-item-index>4.</span>
<a href=/blog/airflow-study-4/#series-anchor>조건부 실행과 알림 (Branch, Email Operator)</a></li><li class="series-item active"><span class=series-item-index>5.</span>
<a href=/blog/airflow-study-5/#series-anchor>DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)</a></li><li class=series-item><span class=series-item-index>6.</span>
<a href=/blog/airflow-study-6/#series-anchor>REST API 연동과 Custom Operator 구현</a></li><li class=series-item><span class=series-item-index>7.</span>
<a href=/blog/airflow-study-7/#series-anchor>외부 시스템 연동 (Connection, Hook, PostgreSQL)</a></li></ol></div><div class=series-footer><label for=series-toggle class=series-toggle-label><span class=series-toggle-icon><i class="fas fa-caret-up"></i></span>
<span class=series-toggle-text-hide>숨기기</span>
<span class=series-toggle-text-show>목록 보기</span></label><div class=series-nav><span class=series-nav-info>5/7</span><div class=series-nav-buttons><a href=/blog/airflow-study-4/#series-anchor class=series-nav-button><i class="fas fa-chevron-left"></i></a>
<a href=/blog/airflow-study-6/#series-anchor class=series-nav-button><i class="fas fa-chevron-right"></i></a></div></div></div></div><script>(function(){const e=document.getElementById("series-toggle"),t="series-expanded",n=localStorage.getItem(t)??"true";n==="true"&&(e.checked=!0),e.addEventListener("change",function(){localStorage.setItem(t,this.checked)})})()</script><h2 id=trigger-rule>Trigger Rule
<a class=anchor href=#trigger-rule>#</a></h2><a href=https://airflow.apache.org/docs/apache-airflow/stable/core-concepts/dags.html#trigger-rules target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://airflow.apache.org/docs/apache-airflow/stable/_images/basic_dag.png alt="Dags — Airflow 3.1.3 Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Dags — Airflow 3.1.3 Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>상위 Task들의 상태에 따라 수행여부를 결정하고 싶을 때 사용</li><li>기본적으로는 상위 Task가 모두 성공해야 실행</li></ul><label class=sc-image for=sc-image-toggle-2 style=text-align:center><a href=https://marclamberti.com/blog/airflow-trigger-rules-all-you-need-to-know/ target=_blank><img src="https://dl.dropboxusercontent.com/scl/fi/dydw147s5pt1s7fg6leop/airflow-31-trigger-rule.webp?rlkey=rg9lo0dungmd863zk8gh76fgj&amp;raw=1" alt="Trigger Rule (Failed, Skipped, Success -> Running)" loading=lazy decoding=async style=zgotmplz></a></label><h3 id=trigger-rule-종류>Trigger Rule 종류
<a class=anchor href=#trigger-rule-%ec%a2%85%eb%a5%98>#</a></h3><table><thead><tr><th>옵션</th><th>설명</th></tr></thead><tbody><tr><td><code>all_success</code></td><td>기본값, 상위 Task가 모두 성공하면 실행</td></tr><tr><td><code>all_failed</code></td><td>상위 Task가 모두 <code>failed</code> 상태면 실행</td></tr><tr><td><code>all_done</code></td><td>상위 Task가 모두 수행되면 실행 (성공 또는 실패)</td></tr><tr><td><code>all_skipped</code></td><td>상위 Task가 모두 <code>skipped</code> 상태면 실행</td></tr><tr><td><code>one_failed</code></td><td>상위 Task 중 하나 이상 실패하면 실행</td></tr><tr><td><code>one_success</code></td><td>상위 Task 중 하나 이상 성공하면 실행</td></tr><tr><td><code>one_done</code></td><td>상위 Task 중 하나 이상 수행되면 실행 (성공 또는 실패)</td></tr><tr><td><code>none_failed</code></td><td>상위 Task 중에 <code>failed</code> 상태가 없으면 실행</td></tr><tr><td><code>none_failed_min_one_success</code></td><td>상위 Task 중에 <code>failed</code> 상태가 없고 성공한 Task가 1개 이상이면 실행</td></tr><tr><td><code>none_skipped</code></td><td>상위 Task 중에 <code>skipped</code> 상태가 없으면 실행</td></tr><tr><td><code>always</code></td><td>항상 실행</td></tr></tbody></table><h3 id=all_done-예시>all_done 예시
<a class=anchor href=#all_done-%ec%98%88%ec%8b%9c>#</a></h3><ul><li><code>all_done</code> 의 동작을 확인하기 위한 예시 DAG 작성</li><li>3개의 상위 Task 중 2번째 Task에서 의도적으로 예외를 발생시켜서 <code>failed</code> 상태를 유발</li><li>하위 Task <code>downstream_task</code> 에 <code>trigger_rule</code> 파라미터로 <code>all_done</code> 전달</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/trigger_rule1.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span><span class=p>,</span> <span class=n>task</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.exceptions</span> <span class=kn>import</span> <span class=n>AirflowException</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.bash</span> <span class=kn>import</span> <span class=n>BashOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;trigger_rule1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>upstream_task1</span> <span class=o>=</span> <span class=n>BashOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;upstream_task1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>bash_command</span><span class=o>=</span><span class=s2>&#34;echo upstream1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;upstream_task2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>upstream_task2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>AirflowException</span><span class=p>(</span><span class=s2>&#34;upstream2 Exception&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;upstream_task3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>upstream_task3</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;정상 처리&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;downstream_task&#34;</span><span class=p>,</span> <span class=n>trigger_rule</span><span class=o>=</span><span class=s2>&#34;all_done&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>downstream_task</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;정상 처리&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>upstream_task1</span><span class=p>,</span> <span class=n>upstream_task2</span><span class=p>(),</span> <span class=n>upstream_task3</span><span class=p>()]</span> <span class=o>&gt;&gt;</span> <span class=n>downstream_task</span><span class=p>()</span></span></span></code></pre></div></div><ul><li><code>all_done</code> 은 상위 Task가 성공 또는 실패 여부에 관계없이 모두 수행되면 실행하는 옵션으로,
<code>upstream_task2</code> 가 실패 처리되어도 <code>downstream_task</code> 가 수행되는 모습을 확인</li></ul><label class=sc-image for=sc-image-toggle-3 style=text-align:center><input class="hidden toggle" type=checkbox id=sc-image-toggle-3><img src="https://dl.dropboxusercontent.com/scl/fi/dxr2449t4dkkoomh1qr1u/airflow-32-trigger-all-done.webp?rlkey=9vxn9jjqug6t88csakmh9m87y&amp;raw=1" alt="all_done - upstream failed > downstream success" loading=lazy decoding=async style=zgotmplz></label><h3 id=none_skipped-예시>none_skipped 예시
<a class=anchor href=#none_skipped-%ec%98%88%ec%8b%9c>#</a></h3><ul><li><code>none_skipped</code> 의 동작을 확인하기 위한 예시 DAG 작성</li><li>3개의 상위 Task 중 랜덤한 한 Task만 수행하고 나머지 Task에선 <code>skipped</code> 상태를 유발</li><li>하위 Task <code>downstream_task</code> 에 <code>trigger_rule</code> 파라미터로 <code>none_skipped</code> 전달</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/trigger_rule2.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span><span class=p>,</span> <span class=n>task</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.bash</span> <span class=kn>import</span> <span class=n>BashOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;trigger_rule2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nd>@task.branch</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;branching&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>random_branch</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>item_lst</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>selected_item</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>item_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>selected_item</span> <span class=o>==</span> <span class=s1>&#39;A&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;upstream_task_a&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>selected_item</span> <span class=o>==</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;upstream_task_b&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>selected_item</span> <span class=o>==</span> <span class=s1>&#39;C&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;upstream_task_c&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>upstream_task_a</span> <span class=o>=</span> <span class=n>BashOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;upstream_task_a&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>bash_command</span><span class=o>=</span><span class=s2>&#34;echo upstream1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;upstream_task_b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>upstream_task_b</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;정상 처리&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;upstream_task_c&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>upstream_task_c</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;정상 처리&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;downstream_task&#34;</span><span class=p>,</span> <span class=n>trigger_rule</span><span class=o>=</span><span class=s2>&#34;none_skipped&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>downstream_task</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;정상 처리&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>random_branch</span><span class=p>()</span> <span class=o>&gt;&gt;</span> <span class=p>[</span><span class=n>upstream_task_a</span><span class=p>,</span> <span class=n>upstream_task_b</span><span class=p>(),</span> <span class=n>upstream_task_c</span><span class=p>()]</span> <span class=o>&gt;&gt;</span> <span class=n>downstream_task</span><span class=p>()</span></span></span></code></pre></div></div><ul><li><code>none_skipped</code> 은 상위 Task가 <code>skipped</code> 상태가 아니어야 실행하는 옵션으로, <code>upstream_task1</code> 만 성공하고
나머지는 <code>skipped</code> 처리되었기 때문에, <code>downstream_task</code> 도 수행되지 못하고 <code>skipped</code> 처리</li></ul><label class=sc-image for=sc-image-toggle-4 style=text-align:center><input class="hidden toggle" type=checkbox id=sc-image-toggle-4><img src="https://dl.dropboxusercontent.com/scl/fi/3tjf1xjx31kjcufq3fkmp/airflow-33-trigger-none-skipped.webp?rlkey=t89irlnfi2j04e61kh7tie1yz&amp;raw=1" alt="none_skipped - upstream failed > downstream success" loading=lazy decoding=async style=zgotmplz></label><h2 id=triggerdagrunoperator>TriggerDagRunOperator
<a class=anchor href=#triggerdagrunoperator>#</a></h2><a href=https://airflow.apache.org/docs/apache-airflow/2.3.4/_api/airflow/operators/trigger_dagrun/index.html target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src="https://dl.dropboxusercontent.com/scl/fi/jaltieh1sb4r7ozm6ju3e/airflow-00-cover-bg.webp?rlkey=s10wwm9o11zy79dwm1vje30sb&amp;raw=1" alt="airflow.operators.trigger_dagrun — Airflow Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>airflow.operators.trigger_dagrun — Airflow Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>다른 DAG을 실행시키는 Operator</li><li>실행할 다른 DAG의 ID를 지정하여 수행</li><li>선행 DAG이 하나만 있을 경우 <code>TriggerDagRunOperator</code> 를 사용하고, 선행 DAG이 2개 이상인 경우는 <code>ExternalTaskSensor</code> 를 사용 권장</li></ul><div class="sc-columns flex flex-wrap"><div class="flex-even markdown-inner" style=flex-grow:1><p><label class=sc-image for=sc-image-toggle-0><input class="hidden toggle" type=checkbox id=sc-image-toggle-0>&lt;img src="https://dl.dropboxusercontent.com/scl/fi/vxkt9g7uy44cwfc4vl174/airflow-34-trigger-dagrun-operator.webp?rlkey=t3i8pjpa7l1yfsscggh3d3j8t&amp;raw=1"alt="TriggerDagRunOperator"loading="lazy"
decoding="async"style="height: auto"></label></p></div><div class="flex-even markdown-inner" style=flex-grow:1><p><label class=sc-image for=sc-image-toggle-1><input class="hidden toggle" type=checkbox id=sc-image-toggle-1>&lt;img src="https://dl.dropboxusercontent.com/scl/fi/o2urlt1hg28y1apeobgom/airflow-35-external-task-sensor.webp?rlkey=rg8l6wgbfja8jw934akg8t5qg&amp;raw=1"alt="ExternalTaskSensor"loading="lazy"
decoding="async"style="height: auto"></label></p></div></div><h3 id=run_id>run_id
<a class=anchor href=#run_id>#</a></h3><ul><li>DAG의 수행 방식과 시간을 유일하게 식별해주는 키</li><li>수행 방식(Schedule, manual, Backfill)에 따라 키가 달라짐</li><li>스케줄에 의해 실행된 경우 scheduled__{{data_interval_start}} 값을 가짐<ul><li>예시) <code>scheduled__2025-06-01T00:00:00+00:00</code></li></ul></li></ul><h3 id=triggerdagrun-활용>TriggerDagRun 활용
<a class=anchor href=#triggerdagrun-%ed%99%9c%ec%9a%a9>#</a></h3><ul><li><code>trigger_run_id</code> : DAG을 실행시킬 때 어떤 <code>run_id</code> 로 실행할지 지정 가능</li><li><code>logical_date</code> : DAG이 트리거된 시간을 지정 가능, <code>manual__{{logical_date}}</code></li><li><code>reset_dag_run</code> : <code>run_id</code> 로 수행된 이력이 있어도 실행시키려면 <code>True</code> 로 설정</li><li><code>wait_for_completion</code> : 지정한 DAG이 완료되어야 다음 Task를 실행하고 싶을 경우 <code>True</code> 로 설정<ul><li>기본적으로는 DAG의 완료 여부에 관계없이 <code>success</code> 로 빠져나가 다음 Task를 실행</li></ul></li><li><code>poke_interval</code> : 지정한 DAG이 완료되었는지 확인하는 주기</li><li><code>allowed_states</code> : Task가 <code>success</code> 상태가 되기 위한 DAG의 처리 상태 목록</li><li><code>failed_states</code> : Task가 <code>failed</code> 상태가 되기 위한 DAG의 처리 상태 목록</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/trigger_dagrun.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.trigger_dagrun</span> <span class=kn>import</span> <span class=n>TriggerDagRunOperator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.bash</span> <span class=kn>import</span> <span class=n>BashOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;trigger_dagrun&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;dagrun&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>start_task</span> <span class=o>=</span> <span class=n>BashOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;start_task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>bash_command</span><span class=o>=</span><span class=s2>&#34;echo </span><span class=se>\&#34;</span><span class=s2>start!</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>trigger_dag_task</span> <span class=o>=</span> <span class=n>TriggerDagRunOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;trigger_dag_task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>trigger_dag_id</span><span class=o>=</span><span class=s2>&#34;python_operator&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>trigger_run_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>logical_date</span><span class=o>=</span><span class=s2>&#34;{{data_interval_start}}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>reset_dag_run</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>wait_for_completion</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>poke_interval</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>allowed_states</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;success&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>failed_states</span><span class=o>=</span><span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>start_task</span> <span class=o>&gt;&gt;</span> <span class=n>trigger_dag_task</span></span></span></code></pre></div></div><h3 id=dag-실행>DAG 실행
<a class=anchor href=#dag-%ec%8b%a4%ed%96%89>#</a></h3><ul><li><code>trigger_dag_task</code> 의 실행 로그에서 <code>python_operator</code> 가 호출된 것을 확인</li></ul><div class=sc-codeblock data-lang=bash><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">bash</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>2025-06-07, 10:52:54<span class=o>]</span> INFO - DAG bundles loaded: dags-folder: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.dag_processing.bundles.manager.DagBundlesManager&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-07, 10:52:54<span class=o>]</span> INFO - Filling up the DagBag from /opt/airflow/dags/trigger_dagrun.py: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.models.dagbag.DagBag&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-07, 10:52:54<span class=o>]</span> INFO - Triggering Dag Run.: <span class=nv>trigger_dag_id</span><span class=o>=</span><span class=s2>&#34;python_operator&#34;</span>: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;task&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-07, 10:52:54<span class=o>]</span> INFO - Dag Run triggered successfully.: <span class=nv>trigger_dag_id</span><span class=o>=</span><span class=s2>&#34;python_operator&#34;</span>: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;task&#34;</span></span></span></code></pre></div></div><ul><li>두 번째 이미지인 PythonOperator의 <code>run_id</code> 가 첫 번째 이미지인 TriggerDagRunOperator의 실행 시간과 같다는 것을 알 수 있으며,
<code>trigger_run_id</code> 를 지정하지 않았기 때문에 <code>manual</code> 로 지정</li></ul><p><label class=md-image for=md-image-toggle-0><input class="hidden toggle" type=checkbox id=md-image-toggle-0>
<img src="https://dl.dropboxusercontent.com/scl/fi/6sxhtm8e4yteuivcrjqla/airflow-36-trigger-dagrun-scheduled.webp?rlkey=wvlbjj9imkl733q0ujdi9ot6k&amp;raw=1" alt="Scheduled Dag Run" loading=lazy decoding=async></label></p><p><label class=md-image for=md-image-toggle-1><input class="hidden toggle" type=checkbox id=md-image-toggle-1>
<img src="https://dl.dropboxusercontent.com/scl/fi/76871p6tozn66wxhspgsq/airflow-37-trigger-dagrun-manual.webp?rlkey=3azwukh8qp6syyb8p8u5vgh0d&amp;raw=1" alt="Manual Dag Run" loading=lazy decoding=async></label></p><h2 id=taskgroup>TaskGroup
<a class=anchor href=#taskgroup>#</a></h2><a href=https://airflow.apache.org/docs/apache-airflow/stable/core-concepts/dags.html#taskgroups target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://airflow.apache.org/docs/apache-airflow/stable/_images/basic_dag.png alt="Dags — Airflow 3.1.3 Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Dags — Airflow 3.1.3 Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>여러 Task들을 그룹화하는 개념</li><li>UI 상에서 Task들을 모아서 편하게 보고 관리하기 쉽게 하기 위한 목적</li></ul><p><label class=md-image for=md-image-toggle-2><input class="hidden toggle" type=checkbox id=md-image-toggle-2>
<img src="https://dl.dropboxusercontent.com/scl/fi/0ake7j9qyw49ei0nze6n3/airflow-38-task-group.gif?rlkey=eauhbvmxgwh15ybsyx2yh57xn&amp;raw=1" alt="TaskGroups - Airflow Documentation" loading=lazy decoding=async></label></p><h3 id=taskgroup-활용>TaskGroup 활용
<a class=anchor href=#taskgroup-%ed%99%9c%ec%9a%a9>#</a></h3><ul><li><code>@task_group</code> 데코레이터 또는 <code>TaskGroup</code> 클래스를 활용하여 TaskGroup을 구현</li><li>docstring을 추가해 Airflow UI에서 TaskGroup에 대한 Tooltip을 표시<ul><li>또는, <code>tooltip</code> 파라미터로 UI에 표시할 내용을 전달할 수도 있음 (파라미터가 docstring보다 우선)</li></ul></li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/task_group.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span><span class=p>,</span> <span class=n>task</span><span class=p>,</span> <span class=n>task_group</span><span class=p>,</span> <span class=n>TaskGroup</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.python</span> <span class=kn>import</span> <span class=n>PythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;task_group&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>inner_function2</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>msg</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;msg&#34;</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>str</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@task_group</span><span class=p>(</span><span class=n>group_id</span><span class=o>=</span><span class=s2>&#34;first_group&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>first_group</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34; 첫 번째 TaskGroup 에 대한 Tooltip 입니다. &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;inner_function1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>inner_function1</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;첫 번째 TaskGroup 내 첫 번째 Task 입니다.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>inner_function2</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;inner_function2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>python_callable</span><span class=o>=</span><span class=n>inner_function2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;msg&#34;</span><span class=p>:</span><span class=s2>&#34;첫 번째 TaskGroup 내 두 번째 Task 입니다.&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>inner_function1</span><span class=p>()</span> <span class=o>&gt;&gt;</span> <span class=n>inner_function2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>TaskGroup</span><span class=p>(</span><span class=n>group_id</span><span class=o>=</span><span class=s2>&#34;second_group&#34;</span><span class=p>,</span> <span class=n>tooltip</span><span class=o>=</span><span class=s2>&#34;두 번째 TaskGroup 에 대한 Tooltip 입니다.&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>second_group</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34; tooltip 파라미터의 내용이 우선적으로 표시됩니다. &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nd>@task</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;inner_function1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>inner_function1</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;두 번째 TaskGroup 내 첫 번째 Task 입니다.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>inner_function2</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;inner_function2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>python_callable</span><span class=o>=</span><span class=n>inner_function2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;msg&#34;</span><span class=p>:</span> <span class=s2>&#34;두 번째 TaskGroup 내 두 번째 Task 입니다.&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>inner_function1</span><span class=p>()</span> <span class=o>&gt;&gt;</span> <span class=n>inner_function2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>first_group</span><span class=p>()</span> <span class=o>&gt;&gt;</span> <span class=n>second_group</span></span></span></code></pre></div></div><h3 id=taskgroup-조회>TaskGroup 조회
<a class=anchor href=#taskgroup-%ec%a1%b0%ed%9a%8c>#</a></h3><ul><li>DAG 실행 후 Graph View에서 두 개의 TaskGroup을 확인</li><li>기대와 다르게 지정한 Tooltip이 표시되지 않았는데, Airflow 3.0 버전의 버그인 것으로 추정</li></ul><label class=sc-image for=sc-image-toggle-8 style=text-align:center><input class="hidden toggle" type=checkbox id=sc-image-toggle-8><img src="https://dl.dropboxusercontent.com/scl/fi/8eszfqcf35b9trq3n7yzi/airflow-39-task-group-summary.webp?rlkey=87f0vvl76lsxexlqz8i8385mb&amp;raw=1" alt="TaskGroup 요약" loading=lazy decoding=async style=zgotmplz></label><ul><li>TaskGroup을 클릭하면 펼쳐지면서 내부 Task를 표시</li></ul><p><label class=md-image for=md-image-toggle-3><input class="hidden toggle" type=checkbox id=md-image-toggle-3>
<img src="https://dl.dropboxusercontent.com/scl/fi/xlxj8po8fb7c79w4kt03x/airflow-40-task-group-detail.webp?rlkey=epggkqvb5m36jsf3bsse28ntb&amp;raw=1" alt="TaskGroup 상세" loading=lazy decoding=async></label></p><h2 id=edge-label>Edge Label
<a class=anchor href=#edge-label>#</a></h2><a href=https://airflow.apache.org/docs/apache-airflow/stable/core-concepts/dags.html#edge-labels target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://airflow.apache.org/docs/apache-airflow/stable/_images/basic_dag.png alt="Dags — Airflow 3.1.3 Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Dags — Airflow 3.1.3 Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>Task 연결에 대한 설명을 추가하는 개념</li><li>Task 종속성을 나타내는 <code>>></code> 또는 <code>&lt;&lt;</code> 연산자 사이에 <code>Label</code> 을 추가</li></ul><h3 id=edge-label-활용>Edge Label 활용
<a class=anchor href=#edge-label-%ed%99%9c%ec%9a%a9>#</a></h3><ul><li>첫 번째 Label은 두 개의 단일 Task 사이를 연결</li><li>두 번째와 세 번째 Label은 Branch의 시작과 끝을 각각 연결</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/edge_label.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span><span class=p>,</span> <span class=n>Label</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.empty</span> <span class=kn>import</span> <span class=n>EmptyOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;edge_label&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>empty_1</span> <span class=o>=</span> <span class=n>EmptyOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;empty_1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_2</span> <span class=o>=</span> <span class=n>EmptyOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;empty_2&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_1</span> <span class=o>&gt;&gt;</span> <span class=n>Label</span><span class=p>(</span><span class=s2>&#34;라벨&#34;</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=n>empty_2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_3</span> <span class=o>=</span> <span class=n>EmptyOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;empty_3&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_4</span> <span class=o>=</span> <span class=n>EmptyOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;empty_4&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_5</span> <span class=o>=</span> <span class=n>EmptyOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;empty_5&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_6</span> <span class=o>=</span> <span class=n>EmptyOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;empty_6&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>empty_2</span> <span class=o>&gt;&gt;</span> <span class=n>Label</span><span class=p>(</span><span class=s2>&#34;브랜치 시작&#34;</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=p>[</span><span class=n>empty_3</span><span class=p>,</span><span class=n>empty_4</span><span class=p>,</span><span class=n>empty_5</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=n>Label</span><span class=p>(</span><span class=s2>&#34;브랜치 종료&#34;</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=n>empty_6</span></span></span></code></pre></div></div><h3 id=edge-label-조회>Edge Label 조회
<a class=anchor href=#edge-label-%ec%a1%b0%ed%9a%8c>#</a></h3><ul><li>Airflow UI의 Graph View에서 Edge Label을 확인</li><li>Branch 연결에 대해서는 모든 연결에 동일한 내용의 Label을 표시</li></ul><p><label class=md-image for=md-image-toggle-4><input class="hidden toggle" type=checkbox id=md-image-toggle-4>
<img src="https://dl.dropboxusercontent.com/scl/fi/81h4ymeiwu26fjkdbozxw/airflow-41-edge-label.webp?rlkey=vw8g2kjbmf2kq2q1n988nj4vg&amp;raw=1" alt="Edge Label - 브랜치 시작 > 브랜치 종료" loading=lazy decoding=async></label></p></article><footer class=site-footer><div class=tags-wrap><a href="/search/?tags=Apache%20Airflow" class=tag>#Apache Airflow</a>
<a href="/search/?tags=TriggerDagRunOperator" class=tag>#TriggerDagRunOperator</a>
<a href="/search/?tags=TaskGroup" class=tag>#TaskGroup</a>
<a href="/search/?tags=Trigger%20Rule" class=tag>#Trigger Rule</a>
<a href="/search/?tags=Edge%20Label" class=tag>#Edge Label</a>
<a href="/search/?tags=%eb%8d%b0%ec%9d%b4%ed%84%b0%20%ec%97%94%ec%a7%80%eb%8b%88%ec%96%b4%eb%a7%81" class=tag>#데이터 엔지니어링</a>
<a href="/search/?tags=%ec%97%90%ec%96%b4%ed%94%8c%eb%a1%9c%ec%9a%b0" class=tag>#에어플로우</a>
<a href="/search/?tags=Python" class=tag>#Python</a>
<a href="/search/?tags=Study" class=tag>#Study</a></div><div class=prev-next-wrap><a href=/blog/airflow-study-4/ class=prev-link><span class=prev-next-label><i class="fa-solid fa-backward"></i> PREV</span>
<span class=prev-next-title>Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)</span>
</a><a href=/blog/airflow-study-6/ class=next-link><span class=prev-next-label>NEXT <i class="fa-solid fa-forward"></i></span>
<span class=prev-next-title>Apache Airflow - REST API 연동과 Custom Operator 구현</span></a></div><div class=comments-wrap><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://minyeamer.github.io/blog/airflow-study-5/",this.page.identifier="https://minyeamer.github.io/blog/airflow-study-5/"};(function(){var e=document,t=e.createElement("script");t.src="https://minyeamer.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})();function reloadDisqus(){window.DISQUS&&DISQUS.reset({reload:!0,config:function(){this.page.url="https://minyeamer.github.io/blog/airflow-study-5/",this.page.identifier="https://minyeamer.github.io/blog/airflow-study-5/"}})}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class="copyright-wrap flex justify-center"><small>Minystory - <a href=https://creativecommons.org/licenses/by/4.0/legalcode target=_blank rel="noopener noreferrer">© CC BY 4.0</a></small></div></footer><label for=menu-control class="hidden site-menu-overlay"></label></div><aside class=site-toc aria-label=목차><div class=toc-content><nav id=TableOfContents><ul><li><a href=#trigger-rule>Trigger Rule</a><ul><li><a href=#trigger-rule-종류>Trigger Rule 종류</a></li><li><a href=#all_done-예시>all_done 예시</a></li><li><a href=#none_skipped-예시>none_skipped 예시</a></li></ul></li><li><a href=#triggerdagrunoperator>TriggerDagRunOperator</a><ul><li><a href=#run_id>run_id</a></li><li><a href=#triggerdagrun-활용>TriggerDagRun 활용</a></li><li><a href=#dag-실행>DAG 실행</a></li></ul></li><li><a href=#taskgroup>TaskGroup</a><ul><li><a href=#taskgroup-활용>TaskGroup 활용</a></li><li><a href=#taskgroup-조회>TaskGroup 조회</a></li></ul></li><li><a href=#edge-label>Edge Label</a><ul><li><a href=#edge-label-활용>Edge Label 활용</a></li><li><a href=#edge-label-조회>Edge Label 조회</a></li></ul></li></ul></nav></div><div class=hidden id=toc-config data-start=2 data-end=3></div></aside><div class=site-toolbar role=toolbar aria-label="툴바'"><input type=checkbox id=toolbar-toggle class="hidden toggle"><div class=toolbar-items><button class=toolbar-button onclick='window.scrollTo({top:0,behavior:"smooth"})' title="Go to top">
<i class="fa fa-chevron-up"></i>
</button>
<button class=toolbar-button onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' title="Go to bottom">
<i class="fa fa-chevron-down"></i>
</button>
<button class=toolbar-button onclick=history.back() title="Go back">
<i class="fa-solid fa-arrow-left"></i></button></div><label for=toolbar-toggle class="toolbar-button toolbar-toggle-label"><i class="fa-solid fa-plus icon-expand"></i>
<i class="fa-solid fa-xmark icon-collapse"></i></label></div></main></body></html>