<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><meta name=author content><meta name=keywords content="Apache Airflow,BranchOperator,EmailOperator,Branching,SMTP,Email,데이터 엔지니어링,에어플로우,Python,Study"><meta name=description content="Apache Airflow의 BranchOperator와 EmailOperator 개념을 소개하고, Branching 기능과 이메일 전송 방법을 단계별로 안내합니다. …"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><link rel=icon href=https://minyeamer.github.io/images/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://minyeamer.github.io/images/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://minyeamer.github.io/images/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><link rel=mask-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><meta name=google-site-verification content="u1tWcHmHUZWfFT1cHaku6sqU-bK40N3WLR-C-4VUWN0"><meta name=naver-site-verification content="6eaf8e9da1a6104780f056f1a7797fe5a3a5a0da"><meta property="og:title" content="Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)"><meta property="og:description" content="Apache Airflow의 BranchOperator와 EmailOperator 개념을 소개하고, Branching 기능과 이메일 전송 방법을 단계별로 안내합니다. …"><meta property="og:type" content="article"><meta property="og:url" content="https://minyeamer.github.io/blog/airflow-study-4/"><meta property="og:image" content="https://dl.dropboxusercontent.com/scl/fi/8oxi6rw0kesl9l3egs78s/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle&amp;raw=1"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-06T16:36:50+09:00"><meta property="article:modified_time" content="2025-06-06T16:36:50+09:00"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-7/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-6/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-5/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-3/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/airflow-study-2/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dl.dropboxusercontent.com/scl/fi/8oxi6rw0kesl9l3egs78s/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle&amp;raw=1"><meta name=twitter:title content="Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)"><meta name=twitter:description content="Apache Airflow의 BranchOperator와 EmailOperator 개념을 소개하고, Branching 기능과 이메일 전송 방법을 단계별로 안내합니다. …"><meta name=twitter:site content="@https://x.com/minyeamer"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minyeamer.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)","item":"https://minyeamer.github.io/blog/airflow-study-4/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)","name":"Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)","description":"Apache Airflow의 BranchOperator와 EmailOperator 개념을 소개하고, Branching 기능과 이메일 전송 방법을 단계별로 안내합니다. BranchPythonOperator, @task.branch 데코레이터, BaseBranchOperator 상속, SMTP 설정, Connection 추가, SSLError 해결까지 다룹니다.\n","keywords":["Apache Airflow, BranchOperator, EmailOperator, Branching, SMTP, Email, 데이터 엔지니어링, 에어플로우, Python, Study"],"articleBody":" Apache Airflow 배우기 1. 설치하기 (Docker Compose) 2. 기본 Operator 이해하기 (Bash, Python) 3. 데이터 전달과 템플릿 활용 (Jinja, XCom, Variable) 4. 조건부 실행과 알림 (Branch, Email Operator) 5. DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup) 6. REST API 연동과 Custom Operator 구현 7. 외부 시스템 연동 (Connection, Hook, PostgreSQL) 숨기기 목록 보기 4/7 BranchOperator #Branching # Dags — Airflow 3.1.3 Documentationairflow.apache.org 특정 Task의 결과에 따라 하위 Task를 선별해서 수행시키고 싶을 때 사용 BranchPythonOperator # BranchPythonOperator 에서 랜덤한 조건에 따라 task_a 만 수행하거나, task_b 와 task_c 를 같이 수행하는 분기 처리 Copy python # dags/branch_python.py from airflow.sdk import DAG from airflow.providers.standard.operators.python import PythonOperator from airflow.providers.standard.operators.python import BranchPythonOperator import pendulum with DAG( dag_id=\"branch_python\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: def select_random(): import random item_lst = ['A','B','C'] selected_item = random.choice(item_lst) if selected_item == 'A': return \"task_a\" else: return [\"task_b\",\"task_c\"] branch_task = BranchPythonOperator( task_id=\"branch_task\", python_callable=select_random ) def print_selected(**kwargs): print(kwargs[\"selected\"]) task_a = PythonOperator( task_id=\"task_a\", python_callable=print_selected, op_kwargs={\"selected\":'A'} ) task_b = PythonOperator( task_id=\"task_b\", python_callable=print_selected, op_kwargs={\"selected\":'B'} ) task_c = PythonOperator( task_id=\"task_c\", python_callable=print_selected, op_kwargs={\"selected\":'C'} ) branch_task \u003e\u003e [task_a, task_b, task_c] 여러 번 Trigger하여 실행했는데, 의도대로 task_a 만 수행되거나, task_b 와 task_c 가 같이 수행되는 두 가지 경우를 확인 또한, task_a 가 선택되는 작업에서 XCom을 보면 skipmixin_key 키로 {'followed': ['task_a']} 값이 전달되는데, 이를 통해 다른 Task에서도 어떤 분기 처리가 되었는지 확인 가능 마찬가지로 실행 로그에서도 어떤 Task가 선택되었고, 어떤 Task가 Skip되었는지 조회 가능 Copy bash # branch_task [2025-06-06, 11:19:07] INFO - Done. Returned value was: task_a: source=\"airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator\" [2025-06-06, 11:19:07] INFO - Branch into task_a: source=\"airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator\" [2025-06-06, 11:19:07] INFO - Following branch {'task_a'}: source=\"airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator\" [2025-06-06, 11:19:07] INFO - Skipping tasks [('task_b', -1), ('task_c', -1)]: source=\"airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator\" [2025-06-06, 11:19:07] INFO - Skipping downstream tasks.: source=\"task\"@task.branch # BranchPythonOperator 대신에 @task.branch 데코레이터를 써서 아래와 같이 표현도 가능 함수를 호출하여 종속성 표현 (select_random() \u003e\u003e [task_a, task_b, task_c]) Copy python # dags/branch_python_decorator.py from airflow.sdk import DAG, task from airflow.providers.standard.operators.python import PythonOperator import pendulum with DAG( dag_id=\"branch_python_decorator\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: @task.branch(task_id=\"branch_task\") def select_random(): import random item_lst = ['A','B','C'] selected_item = random.choice(item_lst) if selected_item == 'A': return \"task_a\" else: return [\"task_b\",\"task_c\"] def print_selected(**kwargs): print(kwargs[\"selected\"]) task_a = PythonOperator( task_id=\"task_a\", python_callable=print_selected, op_kwargs={\"selected\":'A'} ) task_b = PythonOperator( task_id=\"task_b\", python_callable=print_selected, op_kwargs={\"selected\":'B'} ) task_c = PythonOperator( task_id=\"task_c\", python_callable=print_selected, op_kwargs={\"selected\":'C'} ) select_random() \u003e\u003e [task_a, task_b, task_c]BaseBranchOperator # airflow.operators.branch — Airflow Documentationairflow.apache.org Branching 기능을 제공하는 Operator의 기본 클래스 해당 클래스를 상속받을 경우 choose_branch(self, context) 메서드를 구현해야 하고, 분기 처리 로직을 통해 선택되어야 할 Task를 한 개(문자열) 또는 여러 개(리스트)로 반환해야 함 Copy python # dags/branch_base.py from airflow.sdk import DAG from airflow.providers.standard.operators.branch import BaseBranchOperator from airflow.providers.standard.operators.python import PythonOperator import pendulum with DAG( dag_id=\"branch_base\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 0 * * *\", catchup=False, tags=[\"example\", \"branch\"], ) as dag: class CustomBranchOperator(BaseBranchOperator): def choose_branch(self, context): import random item_lst = ['A','B','C'] selected_item = random.choice(item_lst) if selected_item == 'A': return \"task_a\" else: return [\"task_b\",\"task_c\"] custom_branch_task = CustomBranchOperator(task_id=\"custom_branch_task\") def print_selected(**kwargs): print(kwargs[\"selected\"]) task_a = PythonOperator( task_id=\"task_a\", python_callable=print_selected, op_kwargs={\"selected\":'A'} ) task_b = PythonOperator( task_id=\"task_b\", python_callable=print_selected, op_kwargs={\"selected\":'B'} ) task_c = PythonOperator( task_id=\"task_c\", python_callable=print_selected, op_kwargs={\"selected\":'C'} ) custom_branch_task \u003e\u003e [task_a, task_b, task_c]EmailOperator # airflow.operators.email_operator — Airflow Documentationairflow.apache.org 이메일을 전송해주는 Operator SMTP 프로토콜을 통해 개인 Gmail에서 다른 주소로 메일을 보내는 기능 구현 Gmail 옵션에서 IMAP 사용 설정 및 앱 비밀번호 생성이 선행되어야 함 docker-compose 수정 # Email Configuration — Airflow 3.1.3 Documentationairflow.apache.org docker-compose.yaml 파일 내에 아래와 같은 항목을 추가 AIRFLOW__SMTP__SMTP_USER 에는 앱 비밀번호를 생성한 구글 계정을 입력 AIRFLOW__SMTP__SMTP_PASSWORD 에는 발급받은 앱 비밀번호를 공백없이 입력 AIRFLOW__SMTP__SMTP_MAIL_FROM 에는 메일을 보내는 계정을 입력 Copy yaml # docker-compose.yaml x-airflow-common: environment: AIRFLOW__SMTP__SMTP_HOST: smtp.gmail.com AIRFLOW__SMTP__SMTP_USER: ${SMTP_USER} AIRFLOW__SMTP__SMTP_PASSWORD: ${SMTP_PASSWORD} AIRFLOW__SMTP__SMTP_PORT: 587 AIRFLOW__SMTP__SMTP_MAIL_FROM: ${SMTP_USER}Connection 추가 # Managing Connections — Airflow 3.1.3 Documentationairflow.apache.org Airflow 3.0 버전부터는 SMTP 설정을 환경변수나 설정 파일에서 가져오는 것이 아닌, Connection을 활용하도록 권장 Airflow UI의 사이드바에서 Admin-\u003eConnections 메뉴로 이동한 후, Add Connection 버튼을 클릭하여 Connection 추가 아래 이미지와 같이 Connection Type 으로 smtp 를 선택하고, docker-compose 파일에 추가했던 것처럼 구글 계정과 앱 비밀번호를 포함한 메일 연결 설정을 입력 Extra Fields 에서 메일을 보내는 계정 등 추가적인 정보를 입력 가능 EmailOperator 활용 예시 # 생성한 Connection을 사용하기 위해 conn_id 로 지정한 Connection ID 를 입력 대상 이메일 주소를 to 에 입력하고, 제목은 subject, 내용은 html_content 에 입력 참조를 추가할 시 cc 파라미터로 추가로 입력 가능 Copy python from airflow.sdk import DAG from airflow.providers.smtp.operators.smtp import EmailOperator import pendulum with DAG( dag_id=\"email_operator\", start_date=pendulum.datetime(2025, 1, 1, tz=\"Asia/Seoul\"), schedule=\"0 9 1 * *\", catchup=False, tags=[\"example\", \"email\"], ) as dag: send_email_task = EmailOperator( task_id=\"send_email_task\", conn_id=\"gmail\", to=\"example@gmail.com\", subject=\"Airflow 테스트\", html_content=\"Airflow 작업이 완료되었습니다.\" )SSLError # 정상적으로 메일이 보내질 것을 기대했지만, 예상치못한 SSLError 가 발생 Copy bash SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1010) ... File \"/usr/local/lib/python3.12/smtplib.py\", line 1022 in __init__ File \"/usr/local/lib/python3.12/smtplib.py\", line 255 in __init__ File \"/usr/local/lib/python3.12/smtplib.py\", line 341 in connect File \"/usr/local/lib/python3.12/smtplib.py\", line 1029 in _get_socket File \"/usr/local/lib/python3.12/ssl.py\", line 455 in wrap_socket File \"/usr/local/lib/python3.12/ssl.py\", line 1041 in _create File \"/usr/local/lib/python3.12/ssl.py\", line 1319 in do_handshake 원인 파악은 못했지만, Connection에서 SSL 비활성화 후 재시도하니 정상적으로 메일 전송 메일 발송 확인 # 정상적으로 메일이 전송되었을 때, 대상 메일에 접속하면 EmailOperator 에서 지정한 것과 동일한 제목과 내용의 메일이 전송된 것을 확인 가능 Copy html \u003ch2\u003eAirflow 테스트\u003c/h2\u003e \u003cdiv\u003eAirflow 작업이 완료되었습니다.\u003c/div\u003e 실행 로그에서도 메일 전송을 위해 임의로 생성한 Connection gmail 을 사용한 것을 확인 Copy bash [2025-06-06, 21:10:46] INFO - DAG bundles loaded: dags-folder: source=\"airflow.dag_processing.bundles.manager.DagBundlesManager\" [2025-06-06, 21:10:46] INFO - Filling up the DagBag from /opt/airflow/dags/email_operator.py: source=\"airflow.models.dagbag.DagBag\" [2025-06-06, 21:10:46] INFO - Secrets backends loaded for worker: count=1: backend_classes=[\"EnvironmentVariablesBackend\"]: source=\"supervisor\" [2025-06-06, 21:10:46] INFO - Connection Retrieved 'gmail': source=\"airflow.hooks.base\"","wordCount":"899","inLanguage":"ko","image":"https:\/\/dl.dropboxusercontent.com\/scl\/fi\/8oxi6rw0kesl9l3egs78s\/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle\u0026raw=1","datePublished":"2025-06-06T16:36:50+09:00","dateModified":"2025-06-06T16:36:50+09:00","author":{"@type":"Person","name":"minyeamer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minyeamer.github.io/blog/airflow-study-4/"},"publisher":{"@type":"Person","name":"Minystory","logo":{"@type":"ImageObject","url":"https://minyeamer.github.io/images/favicons/favicon.ico"}}}</script><script>(function(){const e=256+768*1.3;window.innerWidth>e&&localStorage.getItem("menu-expanded")==="false"&&document.documentElement.classList.add("menu-initial-collapsed")})()</script><title>Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)</title><link rel=icon href=/images/favicon.ico><link rel=manifest href=/data/manifest.json><link rel=canonical href=https://minyeamer.github.io/blog/airflow-study-4/><link rel=stylesheet href=/main.min.5cef15459c75888e1b1985caa72c3b3683ebe3aad0d82d5eebb539a840899be7.css integrity="sha256-XO8VRZx1iI4bGYXKpyw7NoPr46rQ2C1e67U5qECJm+c=" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ8Z9RMBPJ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BJ8Z9RMBPJ")</script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css crossorigin=anonymous><script>(function(){const e=console.warn;console.warn=function(...n){const t=(new Error).stack||"";if(t.includes("highlight.min.js")||t.includes("highlightjs-line-numbers"))return;e.apply(console,n)}})()</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js crossorigin=anonymous></script><script>window.siteI18n=window.siteI18n||{},window.siteI18n.defaultLang="en"</script><script>window.siteI18n.dataUrl="/data/i18n.min.a69d97976d04e681499d74d71f0019de3d6ed9f29a55bc606a9459d1454b3b65.json"</script><script>window.siteI18n.initData=function(){return window.siteI18n.data?Promise.resolve(window.siteI18n.data):fetch(window.siteI18n.dataUrl).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(window.siteI18n.data=e,window.siteI18n.data))},window.siteI18n.getLanguage=function(e={}){const s="site-language",t=localStorage.getItem(s);if(t)return t;const n=(navigator.language||navigator.userLanguage).split("-")[0];return!e||e[n]?n:window.siteI18n.defaultLang},window.siteI18n.translate=function(e,t=""){if(window.siteI18n.data){const n=window.siteI18n.getLanguage(),t=window.siteI18n.data[n];if(t&&e in t)return t[e]}return t},void window.siteI18n.initData().catch(()=>{})</script><script defer src=/js/core/i18n.min.c076e5ad51c454cca138121312827bfde8c5526a930ce57cea2207f501fea0d7.js integrity="sha256-wHblrVHEVMyhOBITEoJ7/ejFUmqTDOV86iIH9QH+oNc=" crossorigin=anonymous></script><script defer src=/js/partials/scroll-progress.min.841ade7e507a5f6d59c4e7bf2fe2b2ca034070677ff7957eec55610a024dd776.js integrity="sha256-hBreflB6X21ZxOe/L+KyygNAcGd/95V+7FVhCgJN13Y=" crossorigin=anonymous></script><script defer src=/js/partials/menu-toggle.min.7ee0f34ad37a564fe94803318b77c9128244ae7747bf68a99f5c639cd14ee1bc.js integrity="sha256-fuDzStN6Vk/pSAMxi3fJEoJErndHv2ipn1xjnNFO4bw=" crossorigin=anonymous></script><script defer src=/js/partials/toc-toggle.min.245e40eb40fe121e595f13897569556fa17b72530600a710a00a5d636dbf140d.js integrity="sha256-JF5A60D+Eh5ZXxOJdWlVb6F7clMGAKcQoApdY22/FA0=" crossorigin=anonymous></script><script defer src=/js/core/set-theme.min.986446861d7c48b101b4a6f53724b7fc97d6efec2a87906c6630cb9e503897c4.js integrity="sha256-mGRGhh18SLEBtKb1NyS3/JfW7+wqh5BsZjDLnlA4l8Q=" crossorigin=anonymous></script><script defer src=/js/shortcodes/copy-code.min.e18ffc44cf6beb1757c467945bb2897b0e1cb2ee52f08b460ee3ee57f0db6d60.js integrity="sha256-4Y/8RM9r6xdXxGeUW7KJew4csu5S8ItGDuPuV/DbbWA=" crossorigin=anonymous></script><script defer src=/js/partials/toc-highlight.min.7917ead4ecb7378779bfbf3f988251ac76bd55ca7f12fd5919870777dbcd6095.js integrity="sha256-eRfq1Oy3N4d5v78/mIJRrHa9Vcp/Ev1ZGYcHd9vNYJU=" crossorigin=anonymous></script><script defer src=/js/partials/reading-time.min.9dae1dd14e75a79711e28a5864bf1fe636869815c32110f680ff8e1d61bfdf28.js integrity="sha256-na4d0U51p5cR4opYZL8f5jaGmBXDIRD2gP+OHWG/3yg=" crossorigin=anonymous></script><script defer src=/js/shortcodes/image-zoom.min.bb446c50cbec91f1b4fdfbb9f695d753ef4811f43de0a9411201c8466ffe204a.js integrity="sha256-u0RsUMvskfG0/fu59pXXU+9IEfQ94KlBEgHIRm/+IEo=" crossorigin=anonymous></script><script defer src=/js/shortcodes/data-table.min.d20aaf7f506ee989f91746098231f979e58b8435513de0d4f05eefb9c45743e7.js integrity="sha256-0gqvf1Bu6Yn5F0YJgjH5eeWLhDVRPeDU8F7vucRXQ+c=" crossorigin=anonymous></script><script>window.siteSearch=window.siteSearch||{}</script><script>window.siteSearch.contentUrl="/data/content.min.0d9c35258206161520526aeccdea6826417931b6c7dda3db171fe4099b3a26f1.json"</script><script>window.siteSearch.categoriesUrl="/data/categories.min.a110e9708cdf79e3dc8d271224586cc9deffc0232514190c37e24dc74470851c.json"</script><script>window.siteSearch.tagsUrl="/data/tags.min.d80e1fb9a5142d159b8e7e3b9adea10216e811adf810f15fbe9bd79b2b6c83d8.json"</script><script defer src=/fuse.min.js></script><script defer src=/js/search/init.min.ee793e2de351fef268c6642567b4af23bd3763c2cb74f767e7240807e394417d.js integrity="sha256-7nk+LeNR/vJoxmQlZ7SvI703Y8LLdPdn5yQIB+OUQX0=" crossorigin=anonymous></script><script defer src=/js/search/input.min.d9380107ad7925e0b0ba621d64e1648e8119523b6f8cff46cdf240117921a06b.js integrity="sha256-2TgBB615JeCwumIdZOFkjoEZUjtvjP9GzfJAEXkhoGs=" crossorigin=anonymous></script><script defer src=/js/search/list.min.19c27643078f3be0fb15443fbb4903ffe3234c85373d568e3de7478ac45b16e5.js integrity="sha256-GcJ2QwePO+D7FUQ/u0kD/+MjTIU3PVaOPedHisRbFuU=" crossorigin=anonymous></script></head><body class="site-kind-page site-type-posts site-layout-post" dir=ltr><div class=scroll-progress><div class=scroll-progress-bar></div></div><label class=image-overlay-wrap for=image-overlay-toggle><input class="hidden toggle" type=checkbox id=image-overlay-toggle><div class=image-overlay></div></label><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=menu-overlay></div><main class=container><aside class=site-menu aria-label=메뉴 data-i18n-id=menu.aside.tooltip data-i18n-attrs=aira-label><div class=menu-content><nav><div class=menu-profile><div class=profile-image-wrap><a href=https://minyeamer.github.io/><img src=/images/profile/menu.jpg alt=Profile class=profile-image decoding=async></a></div><h2 class=profile-title><a class="flex align-center" href=https://minyeamer.github.io/><span>Minystory</span></a></h2></div><div class=menu-links><a href=https://github.com/minyeamer target=_blank id=github-link title=GitHub><i class="fa-brands fa-github"></i>
</a><a href=/categories/ id=categories-link title=Categories><i class="fa-solid fa-folder"></i>
</a><a href=/tags/ id=tags-link title=Tags><i class="fa-solid fa-tags"></i>
</a><button class=dark-mode-toggle id=theme-toggle-button aria-label="Toggle color scheme">
<i class="fa-solid fa-circle-half-stroke"></i></button></div><div class=menu-search id=search-input data-hotkeys=s/ role=button tabindex=0 aria-label=검색 data-i18n-id=search.action.label data-i18n-attrs=aira-label><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=search-placeholder data-i18n-id=search.input.label data-i18n-text='{"`/`": "$code"}'><code>/</code> 를 눌러 검색하세요</span></div><div class=menu-categories><input type=checkbox class="hidden toggle" id=categories-control checked>
<label for=categories-control class="categories-label categories-toggle"><a href=/categories/ class=categories-root><i class="fa-solid fa-folder"></i>
<span data-i18n-id=categories.root.label data-i18n-text>전체
</span><span class=category-count>(41)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li><input type=checkbox class="hidden toggle" id=cat-algorithm>
<label for=cat-algorithm class="categories-label categories-toggle"><a href="/search/?category1=Algorithm"><i class="fa-solid fa-folder"></i>Algorithm<span class=category-count>(4)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Algorithm&category2=Graph"><i class="fa-solid fa-file"></i>Graph<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=Python"><i class="fa-solid fa-file"></i>Python<span class=category-count>(2)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=SQL"><i class="fa-solid fa-file"></i>SQL<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-cloud>
<label for=cat-cloud class="categories-label categories-toggle"><a href="/search/?category1=Cloud"><i class="fa-solid fa-folder"></i>Cloud<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Cloud&category2=Kubernetes"><i class="fa-solid fa-file"></i>Kubernetes<span class=category-count>(2)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-analysis>
<label for=cat-data-analysis class="categories-label categories-toggle"><a href="/search/?category1=Data%20Analysis"><i class="fa-solid fa-folder"></i>Data Analysis<span class=category-count>(3)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Analysis&category2=Dacon"><i class="fa-solid fa-file"></i>Dacon<span class=category-count>(3)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-engineering>
<label for=cat-data-engineering class="categories-label categories-toggle"><a href="/search/?category1=Data%20Engineering"><i class="fa-solid fa-folder"></i>Data Engineering<span class=category-count>(19)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Airflow"><i class="fa-solid fa-file"></i>Apache Airflow<span class=category-count>(7)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Spark"><i class="fa-solid fa-file"></i>Apache Spark<span class=category-count>(8)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Crawling"><i class="fa-solid fa-file"></i>Crawling<span class=category-count>(4)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-frontend>
<label for=cat-frontend class="categories-label categories-toggle"><a href="/search/?category1=Frontend"><i class="fa-solid fa-folder"></i>Frontend<span class=category-count>(10)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Frontend&category2=Blog"><i class="fa-solid fa-file"></i>Blog<span class=category-count>(10)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-linux>
<label for=cat-linux class="categories-label categories-toggle"><a href="/search/?category1=Linux"><i class="fa-solid fa-folder"></i>Linux<span class=category-count>(1)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Linux&category2=Ubuntu"><i class="fa-solid fa-file"></i>Ubuntu<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-project>
<label for=cat-project class="categories-label categories-toggle"><a href="/search/?category1=Project"><i class="fa-solid fa-folder"></i>Project<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Project&category2=Open%20Source"><i class="fa-solid fa-file"></i>Open Source<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Project&category2=Tools"><i class="fa-solid fa-file"></i>Tools<span class=category-count>(1)</span></a></li></ul></li></ul></div><div class=recent-posts><div class=recent-post-label><i class="fa-solid fa-clock"></i>
<span data-i18n-id=menu.recent.posts data-i18n-text>최신글</span></div><ul class=recent-post-list><li class=recent-post-item><a href=/blog/hugo-seotax-1/ title="Hugo 서택스(SeoTax) 테마 제작기 - 동적 렌더링으로 확장된 검색"><div class=recent-post-title>Hugo 서택스(SeoTax) 테마 제작기 - 동적 렌더링으로 확장된 검색</div><div class=recent-post-date><time datetime=2026-01-25>2026.01.25</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-5/ title="Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)"><div class=recent-post-title>Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)</div><div class=recent-post-date><time datetime=2025-12-15>2025.12.15</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-4/ title="Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기"><div class=recent-post-title>Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기</div><div class=recent-post-date><time datetime=2025-12-14>2025.12.14</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-3/ title="Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현"><div class=recent-post-title>Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현</div><div class=recent-post-date><time datetime=2025-11-22>2025.11.22</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-2/ title="Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선"><div class=recent-post-title>Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선</div><div class=recent-post-date><time datetime=2025-11-04>2025.11.04</time></div></a></li></ul></div></nav><script>(function(){var e=document.querySelector("aside .menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=main-wrap><header class=site-header><div class="flex align-center justify-between"><label for=menu-control aria-label="메뉴 접기/펼치기" title="메뉴 접기/펼치기" data-i18n-id=menu.toggle.tooltip data-i18n-attrs=aria-label,title><i class="fa-solid fa-bars menu-icon" id=menu-icon></i></label><div class=mobile-search id=mobile-search-input role=button tabindex=0 aria-label=검색 data-i18n-id=search.action.label data-i18n-attrs=aria-label><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=mobile-title>Minystory</span>
<i class=mobile-title-pad></i></div><label for=toc-control aria-label="목차 접기/펼치기" title="목차 접기/펼치기" data-i18n-id=toc.toggle.tooltip data-i18n-attrs=aria-label,title><i class="fa-solid fa-list menu-icon" id=toc-icon></i></label></div></header><article class="content-wrap markdown" id=content-wrap><header class=content-header><div class=content-category><a href="/search/?category1=Data%20Engineering&category2=Apache%20Airflow" class=content-category-link>Data Engineering/Apache Airflow</a></div><h1 class=content-title>Apache Airflow - 조건부 실행과 알림 (Branch, Email Operator)</h1><div class=content-datetime><time datetime=2025-06-06T16:36:50+09:00>2025. 06. 06. 16:36
</time><span id=reading-time></span></div></header><div class=content-cover-wrap><img src="https://dl.dropboxusercontent.com/scl/fi/8oxi6rw0kesl9l3egs78s/airflow-00-cover.webp?rlkey=6abx67jiweasmlwehj4o4gdle&amp;raw=1" class=content-cover alt="Cover Image" decoding=async></div><div id=series-anchor></div><div class=sc-series><div class=series-bookmark><svg width="32" height="48" fill="currentColor" viewBox="0 0 32 48" class="series-corner-image"><path fill="currentColor" d="M32 0H0v48h.163l16-16L32 47.836V0z"/></svg></div><div class=series-header><h2 class=series-title>Apache Airflow 배우기</h2></div><input type=checkbox id=series-toggle class=series-toggle-input hidden><div class=series-content><ol class=series-list><li class=series-item><span class=series-item-index>1.</span>
<a href=/blog/airflow-study-1/#series-anchor>설치하기 (Docker Compose)</a></li><li class=series-item><span class=series-item-index>2.</span>
<a href=/blog/airflow-study-2/#series-anchor>기본 Operator 이해하기 (Bash, Python)</a></li><li class=series-item><span class=series-item-index>3.</span>
<a href=/blog/airflow-study-3/#series-anchor>데이터 전달과 템플릿 활용 (Jinja, XCom, Variable)</a></li><li class="series-item active"><span class=series-item-index>4.</span>
<a href=/blog/airflow-study-4/#series-anchor>조건부 실행과 알림 (Branch, Email Operator)</a></li><li class=series-item><span class=series-item-index>5.</span>
<a href=/blog/airflow-study-5/#series-anchor>DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)</a></li><li class=series-item><span class=series-item-index>6.</span>
<a href=/blog/airflow-study-6/#series-anchor>REST API 연동과 Custom Operator 구현</a></li><li class=series-item><span class=series-item-index>7.</span>
<a href=/blog/airflow-study-7/#series-anchor>외부 시스템 연동 (Connection, Hook, PostgreSQL)</a></li></ol></div><div class=series-footer><label for=series-toggle class=series-toggle-label><span class=series-toggle-icon><i class="fas fa-caret-up"></i></span>
<span class=series-toggle-text-hide data-i18n-id=series.hide.label data-i18n-text>숨기기</span>
<span class=series-toggle-text-show data-i18n-id=series.show.label data-i18n-text>목록 보기</span></label><div class=series-nav><span class=series-nav-info>4/7</span><div class=series-nav-buttons><a href=/blog/airflow-study-3/#series-anchor class=series-nav-button><i class="fas fa-chevron-left"></i></a>
<a href=/blog/airflow-study-5/#series-anchor class=series-nav-button><i class="fas fa-chevron-right"></i></a></div></div></div></div><script>(function(){const e=document.getElementById("series-toggle"),t="series-expanded",n=localStorage.getItem(t)??"true";n==="true"&&(e.checked=!0),e.addEventListener("change",function(){localStorage.setItem(t,this.checked)})})()</script><h2 id=branchoperator>BranchOperator
<a class=anchor href=#branchoperator>#</a></h2><h3 id=branching>Branching
<a class=anchor href=#branching>#</a></h3><a href=https://airflow.apache.org/docs/apache-airflow/stable/core-concepts/dags.html#branching target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://airflow.apache.org/docs/apache-airflow/stable/_images/basic_dag.png alt="Dags — Airflow 3.1.3 Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Dags — Airflow 3.1.3 Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>특정 Task의 결과에 따라 하위 Task를 선별해서 수행시키고 싶을 때 사용</li></ul><p><label class=md-image for=md-image-toggle-0><input class="hidden toggle" type=checkbox id=md-image-toggle-0>
<img src="https://dl.dropboxusercontent.com/scl/fi/72b4oq3ksv4r7gs6ykyf2/airflow-25-branch-workflow.webp?rlkey=zm635gumlsypzyjip6ao28j5a&amp;raw=1" alt="branch_good - Airflow Documentation" loading=lazy decoding=async></label></p><h3 id=branchpythonoperator>BranchPythonOperator
<a class=anchor href=#branchpythonoperator>#</a></h3><ul><li><code>BranchPythonOperator</code> 에서 랜덤한 조건에 따라 <code>task_a</code> 만 수행하거나, <code>task_b</code> 와 <code>task_c</code> 를 같이 수행하는 분기 처리</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/branch_python.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.python</span> <span class=kn>import</span> <span class=n>PythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.python</span> <span class=kn>import</span> <span class=n>BranchPythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;branch_python&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>select_random</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>item_lst</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>selected_item</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>item_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>selected_item</span> <span class=o>==</span> <span class=s1>&#39;A&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;task_a&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[</span><span class=s2>&#34;task_b&#34;</span><span class=p>,</span><span class=s2>&#34;task_c&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>branch_task</span> <span class=o>=</span> <span class=n>BranchPythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;branch_task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>select_random</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>print_selected</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>kwargs</span><span class=p>[</span><span class=s2>&#34;selected&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_a</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_a&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;A&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_b</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_b&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;B&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_c</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_c&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;C&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>branch_task</span> <span class=o>&gt;&gt;</span> <span class=p>[</span><span class=n>task_a</span><span class=p>,</span> <span class=n>task_b</span><span class=p>,</span> <span class=n>task_c</span><span class=p>]</span></span></span></code></pre></div></div><ul><li>여러 번 Trigger하여 실행했는데, 의도대로 <code>task_a</code> 만 수행되거나, <code>task_b</code> 와 <code>task_c</code> 가 같이 수행되는 두 가지 경우를 확인</li></ul><div class="sc-columns flex flex-wrap"><div class="flex-even markdown-inner" style=flex-grow:1><label class=sc-image for=sc-image-toggle-1><input class="hidden toggle" type=checkbox id=sc-image-toggle-1><img src="https://dl.dropboxusercontent.com/scl/fi/zmqrndlh8ei1rlngzxz76/airflow-26-branch-success-a.webp?rlkey=zxsorrt87pao4n0azm8j8378q&amp;raw=1" alt="branch_task >> task_a 성공" id=sc-image-1 loading=lazy decoding=async></label></div><div class="flex-even markdown-inner" style=flex-grow:1><label class=sc-image for=sc-image-toggle-2><input class="hidden toggle" type=checkbox id=sc-image-toggle-2><img src="https://dl.dropboxusercontent.com/scl/fi/uu93j7ryw1blnzp5m178z/airflow-27-branch-success-bc.webp?rlkey=kd14bt6phatm40q8mbb56iyoc&amp;raw=1" alt="branch_task >> task_b, task_c 성공" id=sc-image-2 loading=lazy decoding=async></label></div></div><ul><li>또한, <code>task_a</code> 가 선택되는 작업에서 XCom을 보면 <code>skipmixin_key</code> 키로 <code>{'followed': ['task_a']}</code> 값이 전달되는데,
이를 통해 다른 Task에서도 어떤 분기 처리가 되었는지 확인 가능</li></ul><p><label class=md-image for=md-image-toggle-1><input class="hidden toggle" type=checkbox id=md-image-toggle-1>
<img src="https://dl.dropboxusercontent.com/scl/fi/jrraft65v5seeqr3hr21f/airflow-28-branch-skipmixin-key.webp?rlkey=ndgnddwg7dxwruzts4ke8pywa&amp;raw=1" alt="skipmixin_key = {'followed': ['task_a']}" loading=lazy decoding=async></label></p><ul><li>마찬가지로 실행 로그에서도 어떤 Task가 선택되었고, 어떤 Task가 Skip되었는지 조회 가능</li></ul><div class=sc-codeblock data-lang=bash><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">bash</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># branch_task</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 11:19:07<span class=o>]</span> INFO - Done. Returned value was: task_a: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 11:19:07<span class=o>]</span> INFO - Branch into task_a: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 11:19:07<span class=o>]</span> INFO - Following branch <span class=o>{</span><span class=s1>&#39;task_a&#39;</span><span class=o>}</span>: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 11:19:07<span class=o>]</span> INFO - Skipping tasks <span class=o>[(</span><span class=s1>&#39;task_b&#39;</span>, -1<span class=o>)</span>, <span class=o>(</span><span class=s1>&#39;task_c&#39;</span>, -1<span class=o>)]</span>: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.task.operators.airflow.providers.standard.operators.python.BranchPythonOperator&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 11:19:07<span class=o>]</span> INFO - Skipping downstream tasks.: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;task&#34;</span></span></span></code></pre></div></div><h3 id=taskbranch>@task.branch
<a class=anchor href=#taskbranch>#</a></h3><ul><li><code>BranchPythonOperator</code> 대신에 <code>@task.branch</code> 데코레이터를 써서 아래와 같이 표현도 가능</li><li>함수를 호출하여 종속성 표현 (<code>select_random() >> [task_a, task_b, task_c]</code>)</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/branch_python_decorator.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span><span class=p>,</span> <span class=n>task</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.python</span> <span class=kn>import</span> <span class=n>PythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;branch_python_decorator&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nd>@task.branch</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;branch_task&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>select_random</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>item_lst</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>selected_item</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>item_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>selected_item</span> <span class=o>==</span> <span class=s1>&#39;A&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;task_a&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[</span><span class=s2>&#34;task_b&#34;</span><span class=p>,</span><span class=s2>&#34;task_c&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>print_selected</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>kwargs</span><span class=p>[</span><span class=s2>&#34;selected&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_a</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_a&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;A&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_b</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_b&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;B&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_c</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_c&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;C&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>select_random</span><span class=p>()</span> <span class=o>&gt;&gt;</span> <span class=p>[</span><span class=n>task_a</span><span class=p>,</span> <span class=n>task_b</span><span class=p>,</span> <span class=n>task_c</span><span class=p>]</span></span></span></code></pre></div></div><h3 id=basebranchoperator>BaseBranchOperator
<a class=anchor href=#basebranchoperator>#</a></h3><a href=https://airflow.apache.org/docs/apache-airflow/2.9.2/_api/airflow/operators/branch/index.html#airflow.operators.branch.BaseBranchOperator target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src="https://dl.dropboxusercontent.com/scl/fi/jaltieh1sb4r7ozm6ju3e/airflow-00-cover-bg.webp?rlkey=s10wwm9o11zy79dwm1vje30sb&amp;raw=1" alt="airflow.operators.branch — Airflow Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>airflow.operators.branch — Airflow Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>Branching 기능을 제공하는 Operator의 기본 클래스</li><li>해당 클래스를 상속받을 경우 <code>choose_branch(self, context)</code> 메서드를 구현해야 하고,
분기 처리 로직을 통해 선택되어야 할 Task를 한 개(문자열) 또는 여러 개(리스트)로 반환해야 함</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dags/branch_base.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.branch</span> <span class=kn>import</span> <span class=n>BaseBranchOperator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.standard.operators.python</span> <span class=kn>import</span> <span class=n>PythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;branch_base&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 0 * * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;branch&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>CustomBranchOperator</span><span class=p>(</span><span class=n>BaseBranchOperator</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>choose_branch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>item_lst</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>selected_item</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>item_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>selected_item</span> <span class=o>==</span> <span class=s1>&#39;A&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=s2>&#34;task_a&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=s2>&#34;task_b&#34;</span><span class=p>,</span><span class=s2>&#34;task_c&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>custom_branch_task</span> <span class=o>=</span> <span class=n>CustomBranchOperator</span><span class=p>(</span><span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;custom_branch_task&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>print_selected</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>kwargs</span><span class=p>[</span><span class=s2>&#34;selected&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_a</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_a&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;A&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_b</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_b&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;B&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>task_c</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;task_c&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>python_callable</span><span class=o>=</span><span class=n>print_selected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>op_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;selected&#34;</span><span class=p>:</span><span class=s1>&#39;C&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>custom_branch_task</span> <span class=o>&gt;&gt;</span> <span class=p>[</span><span class=n>task_a</span><span class=p>,</span> <span class=n>task_b</span><span class=p>,</span> <span class=n>task_c</span><span class=p>]</span></span></span></code></pre></div></div><h2 id=emailoperator>EmailOperator
<a class=anchor href=#emailoperator>#</a></h2><a href=https://airflow.apache.org/docs/apache-airflow/1.10.9/_api/airflow/operators/email_operator/index.html target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src="https://dl.dropboxusercontent.com/scl/fi/jaltieh1sb4r7ozm6ju3e/airflow-00-cover-bg.webp?rlkey=s10wwm9o11zy79dwm1vje30sb&amp;raw=1" alt="airflow.operators.email_operator — Airflow Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>airflow.operators.email_operator — Airflow Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>이메일을 전송해주는 Operator</li><li>SMTP 프로토콜을 통해 개인 Gmail에서 다른 주소로 메일을 보내는 기능 구현</li><li>Gmail 옵션에서 <a href=https://support.google.com/a/answer/9003945 target=_blank rel="noopener noreferrer">IMAP 사용 설정</a>
및 <a href=https://support.google.com/accounts/answer/185833 target=_blank rel="noopener noreferrer">앱 비밀번호 생성</a>이 선행되어야 함</li></ul><h3 id=docker-compose-수정>docker-compose 수정
<a class=anchor href=#docker-compose-%ec%88%98%ec%a0%95>#</a></h3><a href=https://airflow.apache.org/docs/apache-airflow/stable/howto/email-config.html target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://airflow.apache.org/docs/apache-airflow/stable/_images/email_connection.png alt="Email Configuration — Airflow 3.1.3 Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Email Configuration — Airflow 3.1.3 Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li><code>docker-compose.yaml</code> 파일 내에 아래와 같은 항목을 추가</li><li><code>AIRFLOW__SMTP__SMTP_USER</code> 에는 앱 비밀번호를 생성한 구글 계정을 입력</li><li><code>AIRFLOW__SMTP__SMTP_PASSWORD</code> 에는 발급받은 앱 비밀번호를 공백없이 입력</li><li><code>AIRFLOW__SMTP__SMTP_MAIL_FROM</code> 에는 메일을 보내는 계정을 입력</li></ul><div class=sc-codeblock data-lang=yaml><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">yaml</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># docker-compose.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>x-airflow-common</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>AIRFLOW__SMTP__SMTP_HOST</span><span class=p>:</span><span class=w> </span><span class=l>smtp.gmail.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>AIRFLOW__SMTP__SMTP_USER</span><span class=p>:</span><span class=w> </span><span class=l>${SMTP_USER}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>AIRFLOW__SMTP__SMTP_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>${SMTP_PASSWORD}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>AIRFLOW__SMTP__SMTP_PORT</span><span class=p>:</span><span class=w> </span><span class=m>587</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>AIRFLOW__SMTP__SMTP_MAIL_FROM</span><span class=p>:</span><span class=w> </span><span class=l>${SMTP_USER}</span></span></span></code></pre></div></div><h3 id=connection-추가>Connection 추가
<a class=anchor href=#connection-%ec%b6%94%ea%b0%80>#</a></h3><a href=https://airflow.apache.org/docs/apache-airflow/stable/howto/connection.html target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://airflow.apache.org/docs/apache-airflow/stable/_images/connection_create.png alt="Managing Connections — Airflow 3.1.3 Documentation" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Managing Connections — Airflow 3.1.3 Documentation</h3><small class=sc-bookmark-url>airflow.apache.org</small></div></a><ul><li>Airflow 3.0 버전부터는 SMTP 설정을 환경변수나 설정 파일에서 가져오는 것이 아닌, Connection을 활용하도록 권장</li><li>Airflow UI의 사이드바에서 <code>Admin->Connections</code> 메뉴로 이동한 후, <code>Add Connection</code> 버튼을 클릭하여 Connection 추가</li><li>아래 이미지와 같이 <code>Connection Type</code> 으로 <code>smtp</code> 를 선택하고,
docker-compose 파일에 추가했던 것처럼 구글 계정과 앱 비밀번호를 포함한 메일 연결 설정을 입력</li><li><code>Extra Fields</code> 에서 메일을 보내는 계정 등 추가적인 정보를 입력 가능</li></ul><label class=sc-image for=sc-image-toggle-3 style=text-align:center><input class="hidden toggle" type=checkbox id=sc-image-toggle-3><img src="https://dl.dropboxusercontent.com/scl/fi/7tj5wzmg7xo93p8cftpps/airflow-29-smtp-connection.webp?rlkey=sglggl4g8gib7vr4stn0jw1ae&amp;raw=1" alt="Edit Connection - SMTP" id=sc-image-3 loading=lazy decoding=async style=max-width:691px></label><h3 id=emailoperator-활용-예시>EmailOperator 활용 예시
<a class=anchor href=#emailoperator-%ed%99%9c%ec%9a%a9-%ec%98%88%ec%8b%9c>#</a></h3><ul><li>생성한 Connection을 사용하기 위해 <code>conn_id</code> 로 지정한 <code>Connection ID</code> 를 입력</li><li>대상 이메일 주소를 <code>to</code> 에 입력하고, 제목은 <code>subject</code>, 내용은 <code>html_content</code> 에 입력</li><li>참조를 추가할 시 <code>cc</code> 파라미터로 추가로 입력 가능</li></ul><div class=sc-codeblock data-lang=python><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">python</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.sdk</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.smtp.operators.smtp</span> <span class=kn>import</span> <span class=n>EmailOperator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pendulum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dag_id</span><span class=o>=</span><span class=s2>&#34;email_operator&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=o>=</span><span class=n>pendulum</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2025</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&#34;Asia/Seoul&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>=</span><span class=s2>&#34;0 9 1 * *&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>catchup</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;example&#34;</span><span class=p>,</span> <span class=s2>&#34;email&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>dag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>send_email_task</span> <span class=o>=</span> <span class=n>EmailOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;send_email_task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>conn_id</span><span class=o>=</span><span class=s2>&#34;gmail&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>to</span><span class=o>=</span><span class=s2>&#34;example@gmail.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>subject</span><span class=o>=</span><span class=s2>&#34;Airflow 테스트&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>html_content</span><span class=o>=</span><span class=s2>&#34;Airflow 작업이 완료되었습니다.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span></span></span></code></pre></div></div><h3 id=sslerror>SSLError
<a class=anchor href=#sslerror>#</a></h3><ul><li>정상적으로 메일이 보내질 것을 기대했지만, 예상치못한 <code>SSLError</code> 가 발생</li></ul><div class=sc-codeblock data-lang=bash><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">bash</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>SSLError: <span class=o>[</span>SSL: WRONG_VERSION_NUMBER<span class=o>]</span> wrong version number <span class=o>(</span>_ssl.c:1010<span class=o>)</span>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/smtplib.py&#34;</span>, line <span class=m>1022</span> in __init__
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/smtplib.py&#34;</span>, line <span class=m>255</span> in __init__
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/smtplib.py&#34;</span>, line <span class=m>341</span> in connect
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/smtplib.py&#34;</span>, line <span class=m>1029</span> in _get_socket
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/ssl.py&#34;</span>, line <span class=m>455</span> in wrap_socket
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/ssl.py&#34;</span>, line <span class=m>1041</span> in _create
</span></span><span class=line><span class=cl>File <span class=s2>&#34;/usr/local/lib/python3.12/ssl.py&#34;</span>, line <span class=m>1319</span> in do_handshake</span></span></code></pre></div></div><ul><li>원인 파악은 못했지만, Connection에서 SSL 비활성화 후 재시도하니 정상적으로 메일 전송</li></ul><label class=sc-image for=sc-image-toggle-4 style=text-align:center><input class="hidden toggle" type=checkbox id=sc-image-toggle-4><img src="https://dl.dropboxusercontent.com/scl/fi/jrubhr3qfjs3pv2ll5csk/airflow-30-smtp-disable-ssl.webp?rlkey=fp6yfxpdgry4h7ojyuv77ruel&amp;raw=1" alt="Edit Connection - SMTP > Disable SSL" id=sc-image-4 loading=lazy decoding=async style=max-width:691px></label><h3 id=메일-발송-확인>메일 발송 확인
<a class=anchor href=#%eb%a9%94%ec%9d%bc-%eb%b0%9c%ec%86%a1-%ed%99%95%ec%9d%b8>#</a></h3><ul><li>정상적으로 메일이 전송되었을 때, 대상 메일에 접속하면 <code>EmailOperator</code> 에서 지정한 것과 동일한 제목과 내용의 메일이 전송된 것을 확인 가능</li></ul><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>Airflow 테스트<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span> <span class=c>&lt;!-- 제목 --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>Airflow 작업이 완료되었습니다.<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!-- 내용 --&gt;</span></span></span></code></pre></div></div><ul><li>실행 로그에서도 메일 전송을 위해 임의로 생성한 Connection <code>gmail</code> 을 사용한 것을 확인</li></ul><div class=sc-codeblock data-lang=bash><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">bash</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>2025-06-06, 21:10:46<span class=o>]</span> INFO - DAG bundles loaded: dags-folder: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.dag_processing.bundles.manager.DagBundlesManager&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 21:10:46<span class=o>]</span> INFO - Filling up the DagBag from /opt/airflow/dags/email_operator.py: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.models.dagbag.DagBag&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 21:10:46<span class=o>]</span> INFO - Secrets backends loaded <span class=k>for</span> worker: <span class=nv>count</span><span class=o>=</span>1: <span class=nv>backend_classes</span><span class=o>=[</span><span class=s2>&#34;EnvironmentVariablesBackend&#34;</span><span class=o>]</span>: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;supervisor&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2025-06-06, 21:10:46<span class=o>]</span> INFO - Connection Retrieved <span class=s1>&#39;gmail&#39;</span>: <span class=nv>source</span><span class=o>=</span><span class=s2>&#34;airflow.hooks.base&#34;</span></span></span></code></pre></div></div></article><footer class=site-footer><div class=tags-wrap><a href="/search/?tags=Apache%20Airflow" class=tag>#Apache Airflow</a>
<a href="/search/?tags=BranchOperator" class=tag>#BranchOperator</a>
<a href="/search/?tags=EmailOperator" class=tag>#EmailOperator</a>
<a href="/search/?tags=Branching" class=tag>#Branching</a>
<a href="/search/?tags=SMTP" class=tag>#SMTP</a>
<a href="/search/?tags=Email" class=tag>#Email</a>
<a href="/search/?tags=%eb%8d%b0%ec%9d%b4%ed%84%b0%20%ec%97%94%ec%a7%80%eb%8b%88%ec%96%b4%eb%a7%81" class=tag>#데이터 엔지니어링</a>
<a href="/search/?tags=%ec%97%90%ec%96%b4%ed%94%8c%eb%a1%9c%ec%9a%b0" class=tag>#에어플로우</a>
<a href="/search/?tags=Python" class=tag>#Python</a>
<a href="/search/?tags=Study" class=tag>#Study</a></div><div class=prev-next-wrap><a href=/blog/airflow-study-3/ class=prev-link><span class=prev-next-label><i class="fa-solid fa-backward"></i>
<span data-i18n-id=post.prev.link data-i18n-text>이전</span>
</span><span class=prev-next-title>Apache Airflow - 데이터 전달과 템플릿 활용 (Jinja, XCom, Variable)</span>
</a><a href=/blog/airflow-study-5/ class=next-link><span class=prev-next-label><span data-i18n-id=post.next.link data-i18n-text>다음</span>
<i class="fa-solid fa-forward"></i>
</span><span class=prev-next-title>Apache Airflow - DAG 흐름 제어 (Trigger Rule, TriggerDagRun, TaskGroup)</span></a></div><div class=comments-wrap><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://minyeamer.github.io/blog/airflow-study-4/",this.page.identifier="https://minyeamer.github.io/blog/airflow-study-4/"};window.relocateDisqus=()=>{let e=0;const t=20,n=setInterval(()=>{e++;const s=document.getElementById(atob(atob("WkdsemNYVnpYM1JvY21WaFpBPT0=")));var o=!1;if(s){const e=s.querySelector(atob(atob("VzNOeVl5bzlKMkZrY3lkZA==")));e&&(s.appendChild(e),o=!0)}(o||e>t)&&clearInterval(n)},1e3)},function(){var e=document,t=e.createElement("script");t.src="https://minyeamer.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}(),window.relocateDisqus();function reloadDisqus(){window.DISQUS&&(DISQUS.reset({reload:!0,config:function(){this.page.url="https://minyeamer.github.io/blog/airflow-study-4/",this.page.identifier="https://minyeamer.github.io/blog/airflow-study-4/"}}),window.relocateDisqus())}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class="copyright-wrap flex justify-center"><small>Minystory - <a href=https://creativecommons.org/licenses/by/4.0/legalcode target=_blank rel="noopener noreferrer">© CC BY 4.0</a></small></div></footer><label for=menu-control class="hidden site-menu-overlay"></label></div><aside class=site-toc aria-label=목차 data-i18n-id=toc.aside.tooltip data-i18n-attrs=aira-label><div class=toc-content><nav id=TableOfContents><ul><li><a href=#branchoperator>BranchOperator</a><ul><li><a href=#branching>Branching</a></li><li><a href=#branchpythonoperator>BranchPythonOperator</a></li><li><a href=#taskbranch>@task.branch</a></li><li><a href=#basebranchoperator>BaseBranchOperator</a></li></ul></li><li><a href=#emailoperator>EmailOperator</a><ul><li><a href=#docker-compose-수정>docker-compose 수정</a></li><li><a href=#connection-추가>Connection 추가</a></li><li><a href=#emailoperator-활용-예시>EmailOperator 활용 예시</a></li><li><a href=#sslerror>SSLError</a></li><li><a href=#메일-발송-확인>메일 발송 확인</a></li></ul></li></ul></nav></div><div class=hidden id=toc-config data-start=2 data-end=3></div></aside><div class=site-toolbar role=toolbar aria-label="툴바'" data-i18n-id=toolbar.wrap.tooltip data-i18n-attrs=aira-label><input type=checkbox id=toolbar-toggle class="hidden toggle"><div class=toolbar-items><div class="toolbar-button i18n-button"><i class="fa-solid fa-globe"></i>
<select class=i18n-selector id=i18n-selector aria-label="i18n `toolbar.i18n.tooltip` | default `Select language`" title="i18n `toolbar.i18n.tooltip` | default `Select language`" data-i18n-id=toolbar.i18n.tooltip data-i18n-attrs=aria-label,title><option value=ko>한국어</option><option value=en>English</option><option value=ja>日本語</option><option value=zh>中文</option><option value=es>Español</option><option value=fr>Français</option><option value=de>Deutsch</option><option value=it>Italiano</option><option value=pt>Português</option><option value=ru>Русский</option><option value=am>አማርኛ</option><option value=bg>Български</option><option value=bn>বাংলা</option><option value=cn>简体中文</option><option value=cs>Čeština</option><option value=fa>فارسی</option><option value=he>עברית</option><option value=nb>Norsk</option><option value=nl>Nederlands</option><option value=oc>Occitan</option><option value=pl>Polski</option><option value=pt-BR>Português (BR)</option><option value=sv>Svenska</option><option value=sw>Kiswahili</option><option value=tr>Türkçe</option><option value=uk>Українська</option><option value=zh-TW>繁體中文</option></select></div><button class=toolbar-button onclick='window.scrollTo({top:0,behavior:"smooth"})' aria-label="i18n `toolbar.top.tooltip` | default `Go to top`" title="i18n `toolbar.top.tooltip` | default `Go to top`" data-i18n-id=toolbar.top.tooltip data-i18n-attrs=aria-label,title>
<i class="fa fa-chevron-up"></i>
</button>
<button class=toolbar-button onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' aria-label="i18n `toolbar.bottom.tooltip` | default `Go to bottom`" title="i18n `toolbar.bottom.tooltip` | default `Go to bottom`" data-i18n-id=toolbar.bottom.tooltip data-i18n-attrs=aria-label,title>
<i class="fa fa-chevron-down"></i>
</button>
<button class=toolbar-button onclick=history.back() aria-label="i18n `toolbar.back.tooltip` | default `Go back`" title="i18n `toolbar.back.tooltip` | default `Go back`" data-i18n-id=toolbar.back.tooltip data-i18n-attrs=aria-label,title>
<i class="fa-solid fa-arrow-left"></i></button></div><label for=toolbar-toggle class="toolbar-button toolbar-toggle-label"><i class="fa-solid fa-plus icon-expand"></i>
<i class="fa-solid fa-xmark icon-collapse"></i></label></div></main></body></html>