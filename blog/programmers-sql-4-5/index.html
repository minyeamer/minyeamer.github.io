<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><meta name=author content><meta name=keywords content="프로그래머스,알고리즘,코딩테스트,SQL,JOIN,GROUP BY,SELECT,프로그래머스 Lv4,프로그래머스 Lv5,알고리즘 문제풀이"><meta name=description content="이직 준비를 하면서 오랜만에 코딩테스트를 보게되었는데, SQL 코딩테스트는 어떻게 나오나 궁금해서 프로그래머스 Lv.4, 5 수준의 문제를 모두 풀어보았습니다. 표에서 제목을 클릭 …"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><link rel=icon href=https://minyeamer.github.io/images/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://minyeamer.github.io/images/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://minyeamer.github.io/images/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><link rel=mask-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><meta name=google-site-verification content="u1tWcHmHUZWfFT1cHaku6sqU-bK40N3WLR-C-4VUWN0"><meta name=naver-site-verification content="6eaf8e9da1a6104780f056f1a7797fe5a3a5a0da"><meta property="og:title" content="프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)"><meta property="og:description" content="이직 준비를 하면서 오랜만에 코딩테스트를 보게되었는데, SQL 코딩테스트는 어떻게 나오나 궁금해서 프로그래머스 Lv.4, 5 수준의 문제를 모두 풀어보았습니다. 표에서 제목을 클릭 …"><meta property="og:type" content="article"><meta property="og:url" content="https://minyeamer.github.io/blog/programmers-sql-4-5/"><meta property="og:image" content="https://dl.dropboxusercontent.com/scl/fi/nrqqo3iyw68si0zamyqey/programmers-logo.webp?rlkey=emibt2grzxs1ra3bla48pe6r8&amp;raw=1"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-03T23:15:02+09:00"><meta property="article:modified_time" content="2025-07-03T23:15:02+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dl.dropboxusercontent.com/scl/fi/nrqqo3iyw68si0zamyqey/programmers-logo.webp?rlkey=emibt2grzxs1ra3bla48pe6r8&amp;raw=1"><meta name=twitter:title content="프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)"><meta name=twitter:description content="이직 준비를 하면서 오랜만에 코딩테스트를 보게되었는데, SQL 코딩테스트는 어떻게 나오나 궁금해서 프로그래머스 Lv.4, 5 수준의 문제를 모두 풀어보았습니다. 표에서 제목을 클릭 …"><meta name=twitter:site content="@https://x.com/minyeamer"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minyeamer.github.io/posts/"},{"@type":"ListItem","position":2,"name":"프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)","item":"https://minyeamer.github.io/blog/programmers-sql-4-5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)","name":"프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)","description":"이직 준비를 하면서 오랜만에 코딩테스트를 보게되었는데, SQL 코딩테스트는 어떻게 나오나 궁금해서 프로그래머스 Lv.4, 5 수준의 문제를 모두 풀어보았습니다. 표에서 제목을 클릭하면 프로그래머스 문제 풀이로 이동합니다.\n","keywords":["프로그래머스, 알고리즘, 코딩테스트, SQL, JOIN, GROUP BY, SELECT, 프로그래머스 Lv4, 프로그래머스 Lv5, 알고리즘 문제풀이"],"articleBody":"이직 준비를 하면서 오랜만에 코딩테스트를 보게되었는데, SQL 코딩테스트는 어떻게 나오나 궁금해서 프로그래머스 Lv.4, 5 수준의 문제를 모두 풀어보았습니다.\n모든 문제 #표에서 ID를 클릭하면 프로그래머스 문제 풀이로 이동합니다. 문제는 최신순으로 정렬되어 있는데 풀이 순서는 표에서 역순으로, 즉 오래된순으로 나열합니다.\n문제를 순서대로 풀어보면 유사한 데이터를 사용하는 경우가 있어 비슷한건 큰 제목으로 묶었습니다. 테이블 구조는 생략하고 문제 요약 \u003e 문제 해석 + 풀이 \u003e SQL문 순서로 구성합니다.\nID제목유형난이도정답률문제풀기풀이보기 301651멸종위기의 대장균 찾기SELECTLv.521%링크링크301650특정 세대의 대장균 찾기SELECTLv.461%링크링크284528연간 평가점수에 해당하는 평가 등급 및 성과금 조회하기GROUP BYLv.472%링크링크276036언어별 개발자 분류하기GROUP BYLv.441%링크링크276035FrontEnd 개발자 찾기JOINLv.451%링크링크157339특정 기간동안 대여 가능한 자동차들의 대여비용 구하기JOINLv.449%링크링크151141자동차 대여 기록 별 대여 금액 구하기String, DateLv.451%링크링크144856저자 별 카테고리 별 매출액 집계하기GROUP BYLv.476%링크링크133027주문량이 많은 아이스크림들 조회하기JOINLv.474%링크링크132204취소되지 않은 진료 예약 조회하기String, DateLv.479%링크링크131537오프라인/온라인 판매 데이터 통합하기SELECTLv.467%링크링크131534상품을 구매한 회원 비율 구하기JOINLv.546%링크링크131532년, 월, 성별 별 상품 구매 회원 수 구하기GROUP BYLv.475%링크링크131124그룹별 조건에 맞는 식당 목록 출력하기JOINLv.471%링크링크131118서울에 위치한 식당 목록 출력하기SELECTLv.475%링크링크1311175월 식품들의 총매출 조회하기JOINLv.484%링크링크131116식품분류별 가장 비싼 식품의 정보 조회하기GROUP BYLv.485%링크링크62284우유와 요거트가 담긴 장바구니GROUP BYLv.474%링크링크59413입양 시각 구하기(2)GROUP BYLv.461%링크링크59045보호소에서 중성화한 동물JOINLv.485%링크링크 동물 입양 테이블 #보호소에서 중성화한 동물 # ANIMAL_INS 테이블은 동물 보호소에 들어온 동물의 정보를 담은 테이블입니다. ANIMAL_OUTS 테이블은 동물 보호소에서 입양 보낸 동물의 정보를 담은 테이블입니다.\n보호소에서 중성화 수술을 거친 동물 정보를 알아보려 합니다. 보호소에 들어올 당시에는 중성화되지 않았지만, 보호소를 나갈 당시에는 중성화된 동물의 아이디와 생물 종, 이름을 조회하는 아이디 순으로 조회하는 SQL 문을 작성해주세요.\n보호소에 들어올 당시에 대한 테이블 ANIMAL_INS 에서 특정 조건만 선택하고, 보호소를 나갈 당시에 대한 테이블 ANIMAL_OUTS 에서 특정 조건만 선택해서, 두 테이블을 INNER JOIN 하여 두 조건을 만족하는 경우만 선택하는 문제입니다.\nANIMAL_INS 테이블에서는 중성화되지 않은 조건인, 성별 및 중성화 여부(SEX_UPON_INTAKE)에 \"Intact\" 단어가 포함된 경우를 선택하면 됩니다. 중성화 여부를 나타내는 단어는 앞에 있기 때문에 LIKE 'Intact%' 조건식을 사용했습니다.\nANIMAL_OUTS 테이블에서는 중성화된 조건인, 성별 및 중성화 여부(SEX_UPON_INTAKE)에 \"Spayed\" 또는 \"Neutered\" 단어가 포함된 경우를 선택하면 됩니다. 너무 길게 쓰는건 좋아하지 않아서 정규표현식을 활용하여 REGEXP '^Spayed|Neutered' 로 표현했습니다.\nCopy sql SELECT INS.ANIMAL_ID, INS.ANIMAL_TYPE, INS.NAME FROM ANIMAL_INS AS INS INNER JOIN ANIMAL_OUTS AS OUTS ON INS.ANIMAL_ID = OUTS.ANIMAL_ID WHERE INS.SEX_UPON_INTAKE LIKE 'Intact%' AND OUTS.SEX_UPON_OUTCOME REGEXP '^Spayed|Neutered' ORDER BY ANIMAL_ID;입양 시각 구하기(2) # ANIMAL_OUTS 테이블은 동물 보호소에서 입양 보낸 동물의 정보를 담은 테이블입니다.\n보호소에서는 몇 시에 입양이 가장 활발하게 일어나는지 알아보려 합니다. 0시부터 23시까지, 각 시간대별로 입양이 몇 건이나 발생했는지 조회하는 SQL문을 작성해주세요. 이때 결과는 시간대 순으로 정렬해야 합니다.\n입양일(DATETIME)에서 시간만 추출하고, 추출한 값을 기준으로 COUNT 집계하는 문제입니다.\n주의할 점은, 0시부터 23시까지 모든 행이 존재해야 합니다. ANIMAL_OUTS 테이블에 모든 시간대가 있지 않기 때문에 0시부터 23시까지 값을 가지는 테이블을 만들어야 합니다.\n잘 안써본 구문이라 찾아봤는데 RECURSIVE 라는 재귀적 쿼리를 활용하면 간단하게 해결될 것 같았습니다. 재귀적 쿼리를 사용한 HOURS 임시 테이블을 생성하고, 여기에 ANIMAL_OUTS 테이블을 COUNT 집계한 COUNTS 임시 테이블을 LEFT JOIN 으로 붙여서 모든 시간대를 표시했습니다.\nCopy sql WITH RECURSIVE HOURS AS ( SELECT 0 AS HOUR UNION ALL SELECT HOUR + 1 FROM HOURS WHERE HOUR \u003c 23 ), COUNTS AS ( SELECT HOUR(DATETIME) AS HOUR, COUNT(ANIMAL_ID) AS COUNT FROM ANIMAL_OUTS GROUP BY HOUR ) SELECT HR.HOUR, COALESCE(CNT.COUNT, 0) AS COUNT FROM HOURS AS HR LEFT JOIN COUNTS AS CNT ON HR.HOUR = CNT.HOUR ORDER BY HOUR;식품 테이블 #우유와 요거트가 담긴 장바구니 # CART_PRODUCTS 테이블은 장바구니에 담긴 상품 정보를 담은 테이블입니다.\n데이터 분석 팀에서는 우유(Milk)와 요거트(Yogurt)를 동시에 구입한 장바구니가 있는지 알아보려 합니다. 우유와 요거트를 동시에 구입한 장바구니의 아이디를 조회하는 SQL 문을 작성해주세요. 이때 결과는 장바구니의 아이디 순으로 나와야 합니다.\n장바구니의 아이디(CART_ID) 그룹으로 집계하면서, 상품 종류(NAME) 에 \"Milk\"가 있는 경우와 \"Yogurt\"가 있는 경우를 모두 만족하는 아이디만 선택하는 문제입니다.\n자주 쓰는 Python에서는 Boolean 타입의 True / False 를 각각 정수 1과 0으로 인식할 수 있는데, SQL도 그렇지 않을까 싶어서 SUM 집계해봤습니다. 두 가지 조건에 대해 SUM 집계 결과가 1 이상인 경우만 선택해서 아이디만 조회했습니다.\nCopy sql WITH COUNTS AS ( SELECT CART_ID, SUM(NAME = \"Milk\") AS MILK_COUNT, SUM(NAME = \"Yogurt\") AS YOG_COUNT FROM CART_PRODUCTS GROUP BY CART_ID ) SELECT CART_ID FROM COUNTS WHERE MILK_COUNT \u003e 0 AND YOG_COUNT \u003e 0 ORDER BY CART_ID;식품분류별 가장 비싼 식품의 정보 조회하기 # FOOD_PRODUCT 테이블은 식품의 정보를 담은 테이블입니다.\nFOOD_PRODUCT 테이블에서 식품분류별로 가격이 제일 비싼 식품의 분류, 가격, 이름을 조회하는 SQL문을 작성해주세요. 이때 식품분류가 '과자', '국', '김치', '식용유'인 경우만 출력시켜 주시고 결과는 식품 가격을 기준으로 내림차순 정렬해주세요.\n식품분류(CATEGORY) 그룹에서 가격(PRICE)이 가장 큰 항목만 선택하는 문제입니다.\n가격(PRICE)이 MAX 집계 결과와 동일한 항목만 선택하는 경우도 있지만, 더 간단하게 WINDOW 함수를 사용했습니다. 식품분류(CATEGORY) 파티션에 대해 가격(PRICE)을 내림차순으로 정렬한 순번(ROW_NUMBER)이 1인 경우만 선택하면 동일한 결과를 조회할 수 있습니다.\nCopy sql WITH HIGHEST AS ( SELECT PRODUCT_ID, ROW_NUMBER() OVER (PARTITION BY CATEGORY ORDER BY PRICE DESC) AS SEQ FROM FOOD_PRODUCT WHERE CATEGORY IN (\"과자\",\"국\",\"김치\",\"식용유\") ) SELECT PRD.CATEGORY, PRD.PRICE AS MAX_PRICE, PRD.PRODUCT_NAME FROM FOOD_PRODUCT AS PRD INNER JOIN (SELECT * FROM HIGHEST WHERE SEQ = 1) AS HGT ON PRD.PRODUCT_ID = HGT.PRODUCT_ID ORDER BY MAX_PRICE DESC;5월 식품들의 총매출 조회하기 # FOOD_PRODUCT 테이블은 식품의 정보를 담은 테이블입니다. FOOD_ORDER 테이블은 식품의 주문 정보를 담은 테이블입니다.\nFOOD_PRODUCT 와 FOOD_ORDER 테이블에서 생산일자가 2022년 5월인 식품들의 식품 ID, 식품 이름, 총매출을 조회하는 SQL문을 작성해주세요. 이때 결과는 총매출을 기준으로 내림차순 정렬해주시고 총매출이 같다면 식품 ID를 기준으로 오름차순 정렬해주세요.\n식품 ID(PRODUCT_ID) 그룹에 대해 총매출(SUM(AMOUNT * PRICE))을 계산하는 문제입니다.\nJOIN 을 먼저해서 매출(AMOUNT * PRICE)을 계산하고 SUM 집계하는 경우도 가능한데, 개인적으로는 GROUP BY 시에 식품 이름(PRODUCT_NAME)과 같은 긴 문자열을 포함하는 것을 선호하지 않습니다.\n입고일(PRODUCE_DATE)에 따라 가격(PRICE)이 바뀌는 것도 아니기 때문에 JOIN 과 GROUP BY 의 순서를 신경쓸 필요도 없습니다. 물론, FOOD_PRODUCT 테이블에서 식품 ID(PRODUCT_ID)에 중복이 없음을 전제로 합니다.\n따라서, 식품 ID(PRODUCT_ID)에 대해서 먼저 GROUP BY 하여 총주문량(SUM(AMOUNT))을 계산하고, 가격(PRICE)을 나중에 곱해 총매출(SUM(AMOUNT) * PRICE)을 만들었습니다.\nCopy sql WITH AMOUNTS AS ( SELECT PRODUCT_ID, SUM(AMOUNT) AS TOTAL_AMOUNT FROM FOOD_ORDER WHERE PRODUCE_DATE BETWEEN '2022-05-01' AND '2022-05-31' GROUP BY PRODUCT_ID ) SELECT AMT.PRODUCT_ID, PRD.PRODUCT_NAME, (AMT.TOTAL_AMOUNT * PRD.PRICE) AS TOTAL_SALES FROM AMOUNTS AS AMT INNER JOIN FOOD_PRODUCT AS PRD ON AMT.PRODUCT_ID = PRD.PRODUCT_ID ORDER BY TOTAL_SALES DESC, PRODUCT_ID ASC;식당 테이블 #서울에 위치한 식당 목록 출력하기 # REST_INFO 테이블은 식당의 정보를 담은 테이블입니다. REST_REVIEW 테이블은 식당의 리뷰 정보를 담은 테이블입니다.\nREST_INFO 와 REST_REVIEW 테이블에서 서울에 위치한 식당들의 식당 ID, 식당 이름, 음식 종류, 즐겨찾기수, 주소, 리뷰 평균 점수를 조회하는 SQL문을 작성해주세요. 이때 리뷰 평균점수는 소수점 세 번째 자리에서 반올림 해주시고 결과는 평균점수를 기준으로 내림차순 정렬해주시고, 평균점수가 같다면 즐겨찾기수를 기준으로 내림차순 정렬해주세요.\nREST_REVIEW 테이블에서 식당 ID(REST_ID) 그룹에 대해 리뷰 평균 점수(AVG(REVIEW_SCORE))를 계산하고, REST_INFO 테이블에 계산 결과를 결합하는 문제입니다.\nREST_INFO 테이블을 조회하면 서울에 있는 식당은 전부 주소(ADDRESS)가 \"서울\"로 시작합니다. 정렬 기준만 맞춰서 조회하면 정답을 도출할 수 있습니다.\nCopy sql WITH REVIEWS AS ( SELECT REST_ID, ROUND(AVG(REVIEW_SCORE),2) AS SCORE FROM REST_REVIEW GROUP BY REST_ID ) SELECT INFO.REST_ID, INFO.REST_NAME, INFO.FOOD_TYPE, INFO.FAVORITES, INFO.ADDRESS, RVW.SCORE FROM REST_INFO AS INFO INNER JOIN REVIEWS AS RVW ON INFO.REST_ID = RVW.REST_ID WHERE INFO.ADDRESS LIKE \"서울%\" ORDER BY SCORE DESC, FAVORITES DESC;그룹별 조건에 맞는 식당 목록 출력하기 # MEMBER_PROFILE 테이블은 고객의 정보를 담은 테이블입니다. REST_REVIEW 테이블은 식당의 리뷰 정보를 담은 테이블입니다.\nMEMBER_PROFILE 와 REST_REVIEW 테이블에서 리뷰를 가장 많이 작성한 회원의 리뷰들을 조회하는 SQL문을 작성해주세요. 회원 이름, 리뷰 텍스트, 리뷰 작성일이 출력되도록 작성해주시고, 결과는 리뷰 작성일을 기준으로 오름차순, 리뷰 작성일이 같다면 리뷰 텍스트를 기준으로 오름차순 정렬해주세요.\nREST_REVIEW 테이블에서 리뷰 수(COUNT(REVIEW_ID))가 가장 큰 회원 ID(MEMBER_ID)에 대한 리뷰 목록을 조회하는 문제입니다.\n회원 ID(MEMBER_ID) 그룹별 리뷰 수(COUNT(REVIEW_ID))를 계산하고, 내림차순 정렬하여 첫 번째 항목만 조회하여 리뷰를 가장 많이 작성한 회원을 구합니다.\n해당 회원 ID(MEMBER_ID)에 대한 REST_REVIEW 항목을 모두 조회하면서, MEMBER_PROFILE 테이블을 결합해 회원 이름(MEMBER_NAME)을 같이 표시합니다. DATE 타입의 리뷰 작성일(REVIEW_DATE)은 그대로 출력하면 안되고 %Y-%m-%d 날짜 포맷팅을 해야합니다.\nCopy sql WITH BEST_MEMBER AS ( SELECT MEMBER_ID, COUNT(REVIEW_ID) AS REVIEW_COUNT FROM REST_REVIEW GROUP BY MEMBER_ID ORDER BY REVIEW_COUNT DESC LIMIT 1 ) SELECT MEM.MEMBER_NAME, RVW.REVIEW_TEXT, DATE_FORMAT(RVW.REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE FROM REST_REVIEW AS RVW INNER JOIN BEST_MEMBER AS BST ON RVW.MEMBER_ID = BST.MEMBER_ID INNER JOIN MEMBER_PROFILE AS MEM ON RVW.MEMBER_ID = MEM.MEMBER_ID ORDER BY REVIEW_DATE;쇼핑몰 테이블 #년, 월, 성별 별 상품 구매 회원 수 구하기 # USER_INFO 테이블은 의류 쇼핑몰에 가입한 회원 정보를 담은 테이블입니다. ONLINE_SALE 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.\nUSER_INFO 테이블과 ONLINE_SALE 테이블에서 년, 월, 성별 별로 상품을 구매한 회원수를 집계하는 SQL문을 작성해주세요. 결과는 년, 월, 성별을 기준으로 오름차순 정렬해주세요. 이때, 성별 정보가 없는 경우 결과에서 제외해주세요.\n두 테이블을 INNER JOIN 하면서 성별(GENDER)이 있는(IS NOT NULL) 경우만 선택합니다.\n판매일(SALES_DATE)에서 각각 연도(YEAR), 월(MONTH)을 추출하고, 성별(GENDER)과 함께 세 가지 기준에 대해 GROUP BY 합니다. 그룹 내에서 중복 없는 회원 ID(DISTINCT USER_ID)를 COUNT 집계해 회원수를 계산합니다.\nCopy sql SELECT EXTRACT(YEAR FROM SALES.SALES_DATE) AS YEAR, EXTRACT(MONTH FROM SALES.SALES_DATE) AS MONTH, USR.GENDER, COUNT(DISTINCT SALES.USER_ID) AS USERS FROM ONLINE_SALE AS SALES INNER JOIN USER_INFO AS USR ON SALES.USER_ID = USR.USER_ID WHERE USR.GENDER IS NOT NULL GROUP BY YEAR, MONTH, GENDER ORDER BY YEAR, MONTH, GENDER;상품을 구매한 회원 비율 구하기 # USER_INFO 테이블은 의류 쇼핑몰에 가입한 회원 정보를 담은 테이블입니다. ONLINE_SALE 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.\nUSER_INFO 테이블과 ONLINE_SALE 테이블에서 2021년에 가입한 전체 회원들 중 상품을 구매한 회원수와 상품을 구매한 회원의 비율(=2021년에 가입한 회원 중 상품을 구매한 회원수 / 2021년에 가입한 전체 회원 수)을 년, 월 별로 출력하는 SQL문을 작성해주세요. 상품을 구매한 회원의 비율은 소수점 두번째자리에서 반올림하고, 전체 결과는 년을 기준으로 오름차순 정렬해주시고 년이 같다면 월을 기준으로 오름차순 정렬해주세요.\n2021년에 가입한 회원수와, 그중에서 상품을 구매한 회원수를 집계해 그 비율을 계산하는 문제입니다.\n우선, 대상을 2021년에 가입한 회원으로 좁히기 위해 USER_INFO 에서 가입일(JOINED)의 연도가 2021인 항목만 선택한 TARGET_USERS 임시 테이블 결과를 ONLINE_SALE 에 INNER JOIN 으로 연결합니다.\n가입일(JOINED)에서 연도(YEAR) 와 월(MONTH)을 추출하고, 두 가지 기준에 대해 GROUP BY 합니다. 그룹 내에서 중복 없는 회원 ID(DISTINCT USER_ID)를 COUNT 집계해 회원수를 계산하는데, 이때 판매량(SALES_AMOUNT)이 1 이상인, 즉 상품을 구매한 회원 ID만 고려합니다. 조건에 맞지 않는 회원 ID는 NULL 로 바꿔서 COUNT 집계에서 제외했습니다.\n이렇게 계산한 PURCHASED_USERS 값을 분자로, 회원 ID(USER_ID)를 COUNT 집계한 값을 분모로 하여 상품을 구매한 회원의 비율(PURCHASED_RATIO)을 계산합니다.\nCopy sql WITH TARGET_USERS AS ( SELECT DISTINCT USER_ID FROM USER_INFO WHERE EXTRACT(YEAR FROM JOINED) = 2021 ), PURCHASED AS ( SELECT EXTRACT(YEAR FROM SALES.SALES_DATE) AS YEAR, EXTRACT(MONTH FROM SALES.SALES_DATE) AS MONTH, COUNT(DISTINCT IF(SALES.SALES_AMOUNT \u003e 0, USERS.USER_ID, NULL)) AS PURCHASED_USERS FROM ONLINE_SALE AS SALES INNER JOIN TARGET_USERS AS USERS ON SALES.USER_ID = USERS.USER_ID GROUP BY YEAR, MONTH ) SELECT YEAR, MONTH, PURCHASED_USERS, ROUND(PURCHASED_USERS / (SELECT COUNT(USER_ID) FROM TARGET_USERS), 1) AS PUCHASED_RATIO FROM PURCHASED ORDER BY YEAR, MONTH;오프라인/온라인 판매 데이터 통합하기 # ONLINE_SALE 테이블은 온라인 상품 판매 정보를 담은 테이블입니다. ONLINE_SALE 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.\nONLINE_SALE 테이블과 OFFLINE_SALE 테이블에서 2022년 3월의 오프라인/온라인 상품 판매 데이터의 판매 날짜, 상품ID, 유저ID, 판매량을 출력하는 SQL문을 작성해주세요. OFFLINE_SALE 테이블의 판매 데이터의 USER_ID 값은 NULL 로 표시해주세요. 결과는 판매일을 기준으로 오름차순 정렬해주시고 판매일이 같다면 상품 ID를 기준으로 오름차순, 상품ID까지 같다면 유저 ID를 기준으로 오름차순 정렬해주세요.\n두 테이블을 결과를 세로로 결합하고 정렬하는 문제입니다.\nONLINE_SALE 테이블은 판매일(SALES_DATE), 상품 ID(PRODUCT_ID), 회원 ID(USER_ID) 그룹별로 판매량(SALES_AMOUNT)을 SUM 집계했습니다. GROUP BY 하라는 지문이 없어 안해도 되었던 것 같은데 개인적으로 판매 데이터를 보면 버릇처럼 GROUP BY 하게 됩니다.\nOFFLINE_SALE 테이블은 회원 ID(USER_ID)가 없지만, UNION ALL 연산을 위해 ONLINE_SALE 테이블과 구성을 맞춰줄 목적으로 NULL 값을 가지는 USER_ID 열을 추가합니다.\nDATE 타입의 판매일(REVIEW_DATE)은 그대로 출력하면 안되고 %Y-%m-%d 날짜 포맷팅을 해야합니다.\nCopy sql SELECT DATE_FORMAT(TOTAL.SALES_DATE, '%Y-%m-%d') AS SALES_DATE, TOTAL.PRODUCT_ID, TOTAL.USER_ID, TOTAL.SALES_AMOUNT FROM ( SELECT SALES_DATE, PRODUCT_ID, USER_ID, SUM(SALES_AMOUNT) AS SALES_AMOUNT FROM ONLINE_SALE WHERE SALES_DATE BETWEEN '2022-03-01' AND '2022-03-31' GROUP BY SALES_DATE, PRODUCT_ID, USER_ID UNION ALL SELECT SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SUM(SALES_AMOUNT) AS SALES_AMOUNT FROM OFFLINE_SALE WHERE SALES_DATE BETWEEN '2022-03-01' AND '2022-03-31' GROUP BY SALES_DATE, PRODUCT_ID ) AS TOTAL ORDER BY SALES_DATE, PRODUCT_ID, USER_ID;진료 테이블 #취소되지 않은 진료 예약 조회하기 # PATIENT 테이블은 환자 정보를 담은 테이블입니다. DOCTOR 테이블은 의사 정보를 담은 테이블입니다. APPOINTMENT 테이블은 진료 예약목록을 담은 테이블입니다.\nPATIENT, DOCTOR 그리고 APPOINTMENT 테이블에서 2022년 4월 13일 취소되지 않은 흉부외과(CS) 진료 예약 내역을 조회하는 SQL문을 작성해주세요. 진료예약번호, 환자이름, 환자번호, 진료과코드, 의사이름, 진료예약일시 항목이 출력되도록 작성해주세요. 결과는 진료예약일시를 기준으로 오름차순 정렬해주세요.\n세 개의 테이블에서 조건에 맞는 항목들만 선택해 결합하는 문제입니다.\nAPPOINTMENT 테이블에서는 진료 예약일시(APNT_YMD)가 '2022-04-13' 과 동일하고 예약취소여부(APNT_CNCL_YN)가 'N'에 해당하는 경우만 선택합니다.\nDOCTOR 테이블에서는 진료과코드(MCDP_CD)가 'CS'에 해당하는 경우만 선택합니다.\nPATIENT 테이블은 환자이름(PT_NAME)을 가져오기 위한 목적이며 따로 조건은 없습니다.\n세 개의 테이블을 INNER JOIN 하여 조건을 결합하고 필요한 항목들을 출력합니다.\nCopy sql SELECT APP.APNT_NO, PAT.PT_NAME, APP.PT_NO, APP.MCDP_CD, DOC.DR_NAME, APP.APNT_YMD FROM APPOINTMENT AS APP INNER JOIN DOCTOR AS DOC ON APP.MDDR_ID = DOC.DR_ID INNER JOIN PATIENT AS PAT ON APP.PT_NO = PAT.PT_NO WHERE DATE_FORMAT(APP.APNT_YMD, '%Y-%m-%d') = '2022-04-13' AND APP.APNT_CNCL_YN = 'N' AND DOC.MCDP_CD = 'CS' ORDER BY APNT_YMD판매 테이블 #주문량이 많은 아이스크림들 조회하기 # FIRST_HALF 테이블은 아이스크림 가게의 상반기 주문 정보를 담은 테이블입니다. JULY 테이블은 7월의 아이스크림 주문 정보를 담은 테이블입니다.\n7월 아이스크림 총 주문량과 상반기의 아이스크림 총 주문량을 더한 값이 큰 순서대로 상위 3개의 맛을 조회하는 SQL 문을 작성해주세요.\n아이스크림 총주문량(TOTAL_ORDER)을 내림차순 정렬하여 상위 3개 항목만 조회하는 문제입니다.\n구성이 동일한 FIRST_HALF 테이블과 JULY 테이블을 UNION ALL 결합하고 아이스크림 맛(FLAVOR) 그룹별로 아이스크림 총주문량(TOTAL_ORDER)을 SUM 집계합니다.\n이때, 집계한 값을 출력할 필요는 없기 때문에 굳이 SELECT 하지는 않고 ORDER BY 구문에서 직접적으로 사용합니다. 집계한 값을 내림차순 정렬한 후 LIMIT 3 으로 상위 3개 항목만 조회합니다.\nCopy sql SELECT FLAVOR FROM ( SELECT * FROM FIRST_HALF UNION ALL SELECT * FROM JULY ) AS TOTAL GROUP BY FLAVOR ORDER BY SUM(TOTAL_ORDER) DESC LIMIT 3저자 별 카테고리 별 매출액 집계하기 # BOOK 테이블은 각 도서의 정보를 담은 테이블입니다. AUTHOR 테이블은 도서의 저자의 정보를 담은 테이블입니다. BOOK_SALES 테이블은 각 도서의 날짜 별 판매량 정보를 담은 테이블입니다.\n2022년 1월의 도서 판매 데이터를 기준으로 저자 별, 카테고리 별 매출액(TOTAL_SALES = 판매량 * 판매가) 을 구하여, 저자 ID(AUTHOR_ID), 저자명(AUTHOR_NAME), 카테고리(CATEGORY), 매출액(SALES) 리스트를 출력하는 SQL문을 작성해주세요. 결과는 저자 ID를 오름차순으로, 저자 ID가 같다면 카테고리를 내림차순 정렬해주세요.\n세 개의 테이블을 결합하고 제시된 그룹별 매출액을 계산하는 문제입니다.\nBOOK_SALES 테이블에서 BOOK_ID, AUTHOR_ID 를 기준으로 각각 BOOK, AUTHOR 테이블과 INNER JOIN 합니다. BOOK_SALES 테이블의 판매량(SALES)과 BOOK 테이블의 판매가(PRICE)를 곱한 매출액을 SUM 집계하여 총매출액(TOTAL_SALES)을 계산합니다.\nCopy sql SELECT BK.AUTHOR_ID, AU.AUTHOR_NAME, BK.CATEGORY, SUM(SALES.SALES * BK.PRICE) AS TOTAL_SALES FROM BOOK_SALES AS SALES INNER JOIN BOOK AS BK ON SALES.BOOK_ID = BK.BOOK_ID INNER JOIN AUTHOR AS AU ON BK.AUTHOR_ID = AU.AUTHOR_ID WHERE SALES.SALES_DATE BETWEEN '2022-01-01' AND '2022-01-31' GROUP BY AUTHOR_ID, AUTHOR_NAME, CATEGORY ORDER BY AUTHOR_ID, CATEGORY DESC;자동차 대여 테이블 #자동차 대여 기록 별 대여 금액 구하기 # CAR_RENTAL_COMPANY_CAR 테이블은 대여 중인 자동차들의 정보를 담은 테이블입니다. CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블은 자동차 대여 기록 정보를 담은 테이블입니다. CAR_RENTAL_COMPANY_DISCOUNT_PLAN 테이블은 자동차 종류 별 대여 기간 종류 별 할인 정책 정보를 담은 테이블 입니다.\nCAR_RENTAL_COMPANY_CAR 테이블과 CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블과 CAR_RENTAL_COMPANY_DISCOUNT_PLAN 테이블에서 자동차 종류가 '트럭'인 자동차의 대여 기록에 대해서 대여 기록 별로 대여 금액(컬럼명: FEE)을 구하여 대여 기록 ID와 대여 금액 리스트를 출력하는 SQL문을 작성해주세요. 결과는 대여 금액을 기준으로 내림차순 정렬하고, 대여 금액이 같은 경우 대여 기록 ID를 기준으로 내림차순 정렬해주세요.\n세 개의 테이블을 결합하는데, 우선 대여 시작일(START_DATE)과 대여 종료일(END_DATE) 기간에 대한 날짜수를 기준으로 할인율 적용 기준을 분류합니다. 할인율 적용 기준을 통해 할인율(DISCOUNT_RATE) 수치를 도출하여 대여 금액(FEE)에 할인 적용을 하는 문제입니다.\n일수(DAYS)를 계산하는 방법으로 DATEDIFF 함수를 사용합니다. 시작일과 종료일도 기간에 포함되기 때문에 함수의 결과에 +1 을 더합니다. 일수(DAYS)에 대해 CASE 조건문을 통해 대여 기간 종류(DURATION_TYPE)에 해당하는 4가지 분류로 구분합니다. 대여 기간 종류(DURATION_TYPE)는 그대로 LEFT JOIN 의 기준으로써, CAR_RENTAL_COMPANY_DISCOUNT_PLAN 테이블로부터 할인율(DISCOUNT_RATE)을 도출하는데 사용됩니다.\n대여 금액(FEE)은 일일 대여 요금(DAILY_FEE)에 앞에서 구한 일수(DAYS)와 할인율(DISCOUNT_RATE)을 곱한 결과입니다. 이때, 정수 타입인 할인율(DISCOUNT_RATE)은 그대로 사용하지 않고, 1.0 - (할인율 / 100) 계산식에 넣어 배율로 변환합니다.\nCopy sql WITH HISTORY AS ( SELECT *, (DATEDIFF(END_DATE, START_DATE) + 1) AS DAYS FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY ) SELECT HIST.HISTORY_ID, ROUND(CAR.DAILY_FEE * HIST.DAYS * (1.0 - (IFNULL(DIS.DISCOUNT_RATE, 0) / 100))) AS FEE FROM HISTORY AS HIST INNER JOIN CAR_RENTAL_COMPANY_CAR AS CAR ON HIST.CAR_ID = CAR.CAR_ID LEFT JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN AS DIS ON DIS.CAR_TYPE = CAR.CAR_TYPE AND DIS.DURATION_TYPE = ( CASE WHEN HIST.DAYS \u003e= 90 THEN '90일 이상' WHEN HIST.DAYS \u003e= 30 THEN '30일 이상' WHEN HIST.DAYS \u003e= 7 THEN '7일 이상' ELSE '7일 미만' END) WHERE CAR.CAR_TYPE = '트럭' ORDER BY FEE DESC, HISTORY_ID DESC특정 기간동안 대여 가능한 자동차들의 대여비용 구하기 # CAR_RENTAL_COMPANY_CAR 테이블은 대여 중인 자동차들의 정보를 담은 테이블입니다. CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블은 자동차 대여 기록 정보를 담은 테이블입니다. CAR_RENTAL_COMPANY_DISCOUNT_PLAN 테이블은 자동차 종류 별 대여 기간 종류 별 할인 정책 정보를 담은 테이블 입니다.\nCAR_RENTAL_COMPANY_CAR 테이블과 CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블과 CAR_RENTAL_COMPANY_DISCOUNT_PLAN 테이블에서 자동차 종류가 '세단' 또는 'SUV' 인 자동차 중 2022년 11월 1일부터 2022년 11월 30일까지 대여 가능하고 30일간의 대여 금액이 50만원 이상 200만원 미만인 자동차에 대해서 자동차 ID, 자동차 종류, 대여 금액(컬럼명: FEE) 리스트를 출력하는 SQL문을 작성해주세요. 결과는 대여 금액을 기준으로 내림차순 정렬하고, 대여 금액이 같은 경우 자동차 종류를 기준으로 오름차순 정렬, 자동차 종류까지 같은 경우 자동차 ID를 기준으로 내림차순 정렬해주세요.\n앞선 문제와 테이블 및 대여 금액(FEE) 계산 방법이 동일한데, 세부적인 조건이 늘어났습니다.\n첫 번째 조건인 자동차 종류를 선택하는 것은 CAR_RENTAL_COMPANY_CAR 테이블에서 WHERE 절을 통해 자동차 종류(CAR_TYPE)가 '세단' 또는 'SUV'인 것만 선택하면 됩니다.\n두 번째 조건인 2022년 11월 1일부터 2022년 11월 30일까지 대여 가능한 경우는 CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블에서 대여 시작일(START_DATE)과 대여 종료일(END_DATE)이 해당 기간에 걸치는 경우를 파악하고 대상 자동차 ID(CAR_ID)를 WHERE 절의 AND 조건으로 추가해 제외합니다.\n세 번째 조건은 대여 금액(FEE)을 계산한 후, WHERE 절을 통해 50만원 이상 200만원 미만인 경우를 선택합니다. FEE \u003e= (50 * 10000) AND FEE \u003c (200 * 10000) 조건을 적용할 수도 있지만, 상대적으로 길이가 짧은 BETWEEN 절로 표현했습니다. 대여 금액(FEE)은 소수점까지 떨어지지는 않기 때문에 -1 하여 미만(\u003c)과 동일하게 표현할 수 있습니다.\nCopy sql WITH HISTORY AS ( SELECT *, (DATEDIFF(END_DATE, START_DATE) + 1) AS DAYS FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY ), DISCOUNT_PLAN AS ( SELECT CAR_TYPE, DURATION_TYPE, (1.0 - (DISCOUNT_RATE / 100)) AS DISCOUNT_RATE FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN ), CAR_IN_USE AS ( SELECT DISTINCT CAR_ID FROM HISTORY WHERE START_DATE \u003c= '2022-11-30' AND END_DATE \u003e= '2022-11-01' ), CAR AS ( SELECT CAR.CAR_ID, CAR.CAR_TYPE, ROUND(CAR.DAILY_FEE * 30 * IFNULL(DIS.DISCOUNT_RATE, 1.0)) AS FEE FROM CAR_RENTAL_COMPANY_CAR AS CAR LEFT JOIN DISCOUNT_PLAN AS DIS ON CAR.CAR_TYPE = DIS.CAR_TYPE AND DIS.DURATION_TYPE = '30일 이상' WHERE CAR.CAR_TYPE IN ('세단','SUV') AND CAR.CAR_ID NOT IN (SELECT CAR_ID FROM CAR_IN_USE) ) SELECT CAR_ID, CAR_TYPE, FEE FROM CAR WHERE FEE BETWEEN (50 * 10000) AND (200 * 10000 - 1) ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC개발자 스킬 테이블 #FrontEnd 개발자 찾기 # SKILLCODES 테이블은 개발자들이 사용하는 프로그래밍 언어에 대한 정보를 담은 테이블입니다. DEVELOPERS 테이블은 개발자들의 프로그래밍 스킬 정보를 담은 테이블입니다.\nDEVELOPERS 테이블에서 Front End 스킬을 가진 개발자의 정보를 조회하려 합니다. 조건에 맞는 개발자의 ID, 이메일, 이름, 성을 조회하는 SQL 문을 작성해 주세요. 결과는 ID를 기준으로 오름차순 정렬해 주세요.\n두 개의 테이블에서 정수 타입인 스킬 코드 열을 비트 연산하여 공통된 경우를 JOIN 하는 문제입니다.\nSKILLCODES 테이블에서 스킬의 범주(CATEGORY)가 'Front End'에 해당하는 항목만 선택합니다. 해당 테이블의 스킬의 코드(CODE)는 2진수로 표현했을 때 각 비트마다 하나의 스킬에 대응됩니다.\nDEVELOPERS 테이블에도 마찬가지로 개발자에 대한 스킬 코드(SKILL_CODE)가 있습니다. 두 개 테이블의 스킬 코드를 \u0026 연산자를 활용해 비트 연산하면 공통된 비트만 얻을 수 있습니다. 이것이 SKILLCODES 테이블의 스킬의 코드(CODE)와 같다면 해당 스킬을 보유하고 있다고 판단할 수 있습니다.\n'Front End' 스킬을 가진 개발자의 ID(ID)만 따로 추출하고, DEVELOPERS 테이블에서 해당 ID 에 해당하는 항목들만 선택하여 조회합니다.\nCopy sql WITH TARGET AS ( SELECT DISTINCT DEV.ID FROM DEVELOPERS AS DEV INNER JOIN SKILLCODES AS SKL ON (DEV.SKILL_CODE \u0026 SKL.CODE) = SKL.CODE WHERE SKL.CATEGORY = 'Front End' ) SELECT ID, EMAIL, FIRST_NAME, LAST_NAME FROM DEVELOPERS WHERE ID IN (SELECT ID FROM TARGET) ORDER BY ID;언어별 개발자 분류하기 # SKILLCODES 테이블은 개발자들이 사용하는 프로그래밍 언어에 대한 정보를 담은 테이블입니다. DEVELOPERS 테이블은 개발자들의 프로그래밍 스킬 정보를 담은 테이블입니다.\nDEVELOPERS 테이블에서 GRADE별 개발자의 정보를 조회하려 합니다. GRADE는 다음과 같이 정해집니다.\nA : Front End 스킬과 Python 스킬을 함께 가지고 있는 개발자 B : C# 스킬을 가진 개발자 C : 그 외의 Front End 개발자 GRADE가 존재하는 개발자의 GRADE, ID, EMAIL을 조회하는 SQL 문을 작성해 주세요. 결과는 GRADE와 ID를 기준으로 오름차순 정렬해 주세요.\n앞선 문제와, 테이블 및 스킬 코드를 비트 연산하여 개발자가 스킬을 가졌는지 판단하는 방법이 동일한데, 세부적인 조건이 늘어났습니다.\nCASE 조건문을 통해 'A', 'B', 'C' 세 가지 등급으로 개발자를 나누는데, CASE 안에서 직접적으로 조건을 표현하면 길어질 수도 있습니다. 또한, 'Front End' 스킬을 보유한 경우에 대해서는 'A', 'C' 두 가지 등급에서 참조하기 때문에 중복 선언도 피하고 싶습니다.\n따라서, 원하는 스킬을 보유한 경우를 HAS_SKILLS 라는 임시 테이블로 구성하고, 해당 테이블을 DEVELOPERS 테이블에 INNER JOIN 하여 미리 계산한 조건에 대한 Boolean 값을 CASE 안에서 가져다 사용합니다. 조건에 해당되지 않는 나머지 개발자에 대한 등급은 NULL 로 분류하고, 등급이 NULL 인 경우만 제외하여 조회합니다.\nCopy sql WITH HAS_SKILLS AS ( SELECT DEV.ID, (SUM(SKL.CATEGORY = 'Front End') \u003e 0) AS HAS_FRONT, (SUM(SKL.NAME = 'Python') \u003e 0) AS HAS_PYTHON, (SUM(SKL.NAME = 'C#') \u003e 0) AS HAS_CSHARP FROM DEVELOPERS AS DEV LEFT JOIN SKILLCODES AS SKL ON (DEV.SKILL_CODE \u0026 SKL.CODE) = SKL.CODE GROUP BY ID ), WITH_GRADE AS ( SELECT (CASE WHEN SKL.HAS_FRONT AND SKL.HAS_PYTHON THEN 'A' WHEN SKL.HAS_CSHARP THEN 'B' WHEN SKL.HAS_FRONT THEN 'C' ELSE NULL END) AS GRADE, DEV.ID, DEV.EMAIL FROM DEVELOPERS AS DEV INNER JOIN HAS_SKILLS AS SKL ON DEV.ID = SKL.ID ) SELECT * FROM WITH_GRADE WHERE GRADE IS NOT NULL ORDER BY GRADE, ID;인사 테이블 #연간 평가점수에 해당하는 평가 등급 및 성과금 조회하기 # HR_DEPARTMENT 테이블은 회사의 부서 정보를 담은 테이블입니다. HR_EMPLOYEES 테이블은 회사의 사원 정보를 담은 테이블입니다. HR_GRADE 테이블은 2022년 사원의 평가 정보를 담은 테이블입니다.\nHR_DEPARTMENT, HR_EMPLOYEES, HR_GRADE 테이블을 이용해 사원별 성과금 정보를 조회하려합니다. 평가 점수별 등급과 등급에 따른 성과금 정보가 아래와 같을 때, 사번, 성명, 평가 등급, 성과금을 조회하는 SQL문을 작성해주세요.\n평가등급의 컬럼명은 GRADE 로, 성과금의 컬럼명은 BONUS 로 해주세요. 결과는 사번 기준으로 오름차순 정렬해주세요.\nHR_GRADE 테이블의 평가 점수(SCORE)를 기준으로 평가등급(GRADE)과 성과금(BONUS)을 도출하는 문제입니다.\n사원 평가는 반기마다 발생하는데 2022년 내에 두 차례 발생했기 때문에, 사번(EMP_NO) 그룹별로 평가 점수(SCORE)를 AVG 집계합니다. 평균 평가 점수(AVG(SCORE))를 CASE 조건문에 넣어 평가등급(GRADE)과 성과금(BONUS)을 분류합니다.\n분류한 성과금은 연봉에 대한 배율이기 때문에, 최종 답안을 낼 때는 HR_EMPLOYEES 테이블의 연봉(SAL)에 배율을 곱해서 실제 성과금(BONUS)을 계산합니다.\nCopy sql WITH SCORE AS ( SELECT EMP_NO, AVG(SCORE) AS SCORE FROM HR_GRADE GROUP BY EMP_NO ), GRADE AS ( SELECT EMP_NO, (CASE WHEN SCORE \u003e= 96 THEN 'S' WHEN SCORE \u003e= 90 THEN 'A' WHEN SCORE \u003e= 80 THEN 'B' ELSE 'C' END) AS GRADE, (CASE WHEN SCORE \u003e= 96 THEN 0.2 WHEN SCORE \u003e= 90 THEN 0.15 WHEN SCORE \u003e= 80 THEN 0.1 ELSE 0.0 END) AS BONUS FROM SCORE ) SELECT EMP.EMP_NO, EMP.EMP_NAME, GRD.GRADE, ROUND(EMP.SAL * GRD.BONUS) AS BONUS FROM HR_EMPLOYEES AS EMP INNER JOIN GRADE AS GRD ON EMP.EMP_NO = GRD.EMP_NO ORDER BY EMP_NO대장균 개체 테이블 #특정 세대의 대장균 찾기 # ECOLI_DATA 테이블은 실험실에서 배양한 대장균들의 정보를 담은 테이블입니다.\n3세대의 대장균의 ID(ID) 를 출력하는 SQL 문을 작성해주세요. 이때 결과는 대장균의 ID 에 대해 오름차순 정렬해주세요.\n세대별로 JOIN 연산을 중첩해서 사용하여 3세대 대장균의 ID(ID)를 도출하는 문제입니다.\n1세대 대장균(GEN1)은 부모 개체의 ID(PARENT_ID)가 NULL 인 경우입니다.\n2세대 대장균(GEN2)은 1세대(GEN1) 대장균 개체의 ID(ID)가 부모 개체의 ID(PARENT_ID)인 경우입니다. 두 항목을 INNER JOIN 하여 공통된 경우만 2세대로 판단합니다.\n3세대 대장균은 2세대 대장균(GEN2)을 구한 것과 동일한 방식으로 INNER JOIN 연산합니다. 해당하는 3세대 대장균의 ID(ID)를 출력합니다.\nCopy sql WITH GEN1 AS ( SELECT DISTINCT ID FROM ECOLI_DATA WHERE PARENT_ID IS NULL ), GEN2 AS ( SELECT DISTINCT ECOLI.ID FROM ECOLI_DATA AS ECOLI INNER JOIN GEN1 AS PARENT ON ECOLI.PARENT_ID = PARENT.ID ) SELECT DISTINCT ECOLI.ID FROM ECOLI_DATA AS ECOLI INNER JOIN GEN2 AS PARENT ON ECOLI.PARENT_ID = PARENT.ID ORDER BY ID;멸종위기의 대장균 찾기 # ECOLI_DATA 테이블은 실험실에서 배양한 대장균들의 정보를 담은 테이블입니다.\n각 세대별 자식이 없는 개체의 수(COUNT)와 세대(GENERATION)를 출력하는 SQL문을 작성해주세요. 이때 결과는 세대에 대해 오름차순 정렬해주세요. 단, 모든 세대에는 자식이 없는 개체가 적어도 1개체는 존재합니다.\n재귀 쿼리를 사용해 이전 세대의 대장균 ID(ID)와 ECOLI_DATA 테이블의 부모 개체 ID(PARENT_ID)가 동일한 경우를 반복해서 탐색합니다. 다음 세대가 없을 때까지 조회한 모든 결과를 결합하고, 대장균의 ID(ID)가 어떠한 부모 개체의 ID(PARENT_ID)에도 포함되지 않는 경우만 선택하여, 세대(GENERATION)별 개체의 수(COUNT)를 집계하는 문제입니다.\n앞선 문제처럼 n세대까지 JOIN 연산을 중첩하려다가 도저히 아닌 것 같아서 찾아봤는데, 재귀 쿼리를 사용하여 해결할 수 있는 문제였습니다. 평소에 재귀 쿼리를 사용해보지 않아 GEN_DATA 를 도출하는 과정은 검색 결과를 참고했습니다.\nGEN_DATA 에서 자식이 없는 개체만 선택하고 GENERATION 그룹별로 COUNT 집계한 결과를 조회합니다.\nCopy sql WITH RECURSIVE GEN_DATA AS( SELECT ID, 1 AS GENERATION FROM ECOLI_DATA WHERE PARENT_ID IS NULL UNION ALL SELECT ECOLI.ID, PARENT.GENERATION+1 AS GENERATION FROM ECOLI_DATA AS ECOLI INNER JOIN GEN_DATA AS PARENT ON ECOLI.PARENT_ID = PARENT.ID ) SELECT COUNT(PARENT.GENERATION) AS COUNT, PARENT.GENERATION FROM GEN_DATA AS PARENT WHERE PARENT.ID NOT IN ( SELECT DISTINCT PARENT_ID FROM ECOLI_DATA WHERE PARENT_ID IS NOT NULL) GROUP BY GENERATION ORDER BY GENERATION;","wordCount":"3863","inLanguage":"ko","image":"https:\/\/dl.dropboxusercontent.com\/scl\/fi\/nrqqo3iyw68si0zamyqey\/programmers-logo.webp?rlkey=emibt2grzxs1ra3bla48pe6r8\u0026raw=1","datePublished":"2025-07-03T23:15:02+09:00","dateModified":"2025-07-03T23:15:02+09:00","author":{"@type":"Person","name":"minyeamer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minyeamer.github.io/blog/programmers-sql-4-5/"},"publisher":{"@type":"Person","name":"Minystory","logo":{"@type":"ImageObject","url":"https://minyeamer.github.io/images/favicons/favicon.ico"}}}</script><script>(function(){const e=256+768*1.3;window.innerWidth>e&&localStorage.getItem("menu-expanded")==="false"&&document.documentElement.classList.add("menu-initial-collapsed")})()</script><title>프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)</title><link rel=icon href=/images/favicon.ico><link rel=manifest href=/data/manifest.json><link rel=canonical href=https://minyeamer.github.io/blog/programmers-sql-4-5/><link rel=stylesheet href=/main.min.288c1b89a728bef26027ed18337b07d8810feb4d82349a050334c4fbd3d17612.css integrity="sha256-KIwbiacovvJgJ+0YM3sH2IEP602CNJoFAzTE+9PRdhI=" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ8Z9RMBPJ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BJ8Z9RMBPJ")</script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css crossorigin=anonymous><script>(function(){const e=console.warn;console.warn=function(...n){const t=(new Error).stack||"";if(t.includes("highlight.min.js")||t.includes("highlightjs-line-numbers"))return;e.apply(console,n)}})()</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js crossorigin=anonymous></script><script>window.siteI18n=window.siteI18n||{},window.siteI18n.defaultLang="en"</script><script>window.siteI18n.dataUrl="/data/i18n.min.a69d97976d04e681499d74d71f0019de3d6ed9f29a55bc606a9459d1454b3b65.json"</script><script>window.siteI18n.initData=function(){return window.siteI18n.data?Promise.resolve(window.siteI18n.data):fetch(window.siteI18n.dataUrl).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(window.siteI18n.data=e,window.siteI18n.data))},window.siteI18n.getLanguage=function(e={}){const s="site-language",t=localStorage.getItem(s);if(t)return t;const n=(navigator.language||navigator.userLanguage).split("-")[0];return!e||e[n]?n:window.siteI18n.defaultLang},window.siteI18n.translate=function(e,t=""){if(window.siteI18n.data){const n=window.siteI18n.getLanguage(),t=window.siteI18n.data[n];if(t&&e in t)return t[e]}return t},void window.siteI18n.initData().catch(()=>{})</script><script defer src=/js/core/i18n.min.c076e5ad51c454cca138121312827bfde8c5526a930ce57cea2207f501fea0d7.js integrity="sha256-wHblrVHEVMyhOBITEoJ7/ejFUmqTDOV86iIH9QH+oNc=" crossorigin=anonymous></script><script defer src=/js/partials/scroll-progress.min.841ade7e507a5f6d59c4e7bf2fe2b2ca034070677ff7957eec55610a024dd776.js integrity="sha256-hBreflB6X21ZxOe/L+KyygNAcGd/95V+7FVhCgJN13Y=" crossorigin=anonymous></script><script defer src=/js/partials/menu-toggle.min.7ee0f34ad37a564fe94803318b77c9128244ae7747bf68a99f5c639cd14ee1bc.js integrity="sha256-fuDzStN6Vk/pSAMxi3fJEoJErndHv2ipn1xjnNFO4bw=" crossorigin=anonymous></script><script defer src=/js/partials/toc-toggle.min.245e40eb40fe121e595f13897569556fa17b72530600a710a00a5d636dbf140d.js integrity="sha256-JF5A60D+Eh5ZXxOJdWlVb6F7clMGAKcQoApdY22/FA0=" crossorigin=anonymous></script><script defer src=/js/core/set-theme.min.986446861d7c48b101b4a6f53724b7fc97d6efec2a87906c6630cb9e503897c4.js integrity="sha256-mGRGhh18SLEBtKb1NyS3/JfW7+wqh5BsZjDLnlA4l8Q=" crossorigin=anonymous></script><script defer src=/js/shortcodes/copy-code.min.e18ffc44cf6beb1757c467945bb2897b0e1cb2ee52f08b460ee3ee57f0db6d60.js integrity="sha256-4Y/8RM9r6xdXxGeUW7KJew4csu5S8ItGDuPuV/DbbWA=" crossorigin=anonymous></script><script defer src=/js/partials/toc-highlight.min.7917ead4ecb7378779bfbf3f988251ac76bd55ca7f12fd5919870777dbcd6095.js integrity="sha256-eRfq1Oy3N4d5v78/mIJRrHa9Vcp/Ev1ZGYcHd9vNYJU=" crossorigin=anonymous></script><script defer src=/js/partials/reading-time.min.9dae1dd14e75a79711e28a5864bf1fe636869815c32110f680ff8e1d61bfdf28.js integrity="sha256-na4d0U51p5cR4opYZL8f5jaGmBXDIRD2gP+OHWG/3yg=" crossorigin=anonymous></script><script defer src=/js/shortcodes/image-zoom.min.bb446c50cbec91f1b4fdfbb9f695d753ef4811f43de0a9411201c8466ffe204a.js integrity="sha256-u0RsUMvskfG0/fu59pXXU+9IEfQ94KlBEgHIRm/+IEo=" crossorigin=anonymous></script><script defer src=/js/shortcodes/data-table.min.d20aaf7f506ee989f91746098231f979e58b8435513de0d4f05eefb9c45743e7.js integrity="sha256-0gqvf1Bu6Yn5F0YJgjH5eeWLhDVRPeDU8F7vucRXQ+c=" crossorigin=anonymous></script><script>window.siteSearch=window.siteSearch||{}</script><script>window.siteSearch.contentUrl="/data/content.min.0d9c35258206161520526aeccdea6826417931b6c7dda3db171fe4099b3a26f1.json"</script><script>window.siteSearch.categoriesUrl="/data/categories.min.a110e9708cdf79e3dc8d271224586cc9deffc0232514190c37e24dc74470851c.json"</script><script>window.siteSearch.tagsUrl="/data/tags.min.d80e1fb9a5142d159b8e7e3b9adea10216e811adf810f15fbe9bd79b2b6c83d8.json"</script><script defer src=/fuse.min.js></script><script defer src=/js/search/init.min.ee793e2de351fef268c6642567b4af23bd3763c2cb74f767e7240807e394417d.js integrity="sha256-7nk+LeNR/vJoxmQlZ7SvI703Y8LLdPdn5yQIB+OUQX0=" crossorigin=anonymous></script><script defer src=/js/search/input.min.d9380107ad7925e0b0ba621d64e1648e8119523b6f8cff46cdf240117921a06b.js integrity="sha256-2TgBB615JeCwumIdZOFkjoEZUjtvjP9GzfJAEXkhoGs=" crossorigin=anonymous></script><script defer src=/js/search/list.min.19c27643078f3be0fb15443fbb4903ffe3234c85373d568e3de7478ac45b16e5.js integrity="sha256-GcJ2QwePO+D7FUQ/u0kD/+MjTIU3PVaOPedHisRbFuU=" crossorigin=anonymous></script></head><body class="site-kind-page site-type-posts site-layout-post" dir=ltr><div class=scroll-progress><div class=scroll-progress-bar></div></div><label class=image-overlay-wrap for=image-overlay-toggle><input class="hidden toggle" type=checkbox id=image-overlay-toggle><div class=image-overlay></div></label><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=menu-overlay></div><main class=container><aside class=site-menu aria-label=메뉴 data-i18n-id=menu.aside.tooltip data-i18n-attrs=aira-label><div class=menu-content><nav><div class=menu-profile><div class=profile-image-wrap><a href=https://minyeamer.github.io/><img src=/images/profile/menu.jpg alt=Profile class=profile-image decoding=async></a></div><h2 class=profile-title><a class="flex align-center" href=https://minyeamer.github.io/><span>Minystory</span></a></h2></div><div class=menu-links><a href=https://github.com/minyeamer target=_blank id=github-link title=GitHub><i class="fa-brands fa-github"></i>
</a><a href=/categories/ id=categories-link title=Categories><i class="fa-solid fa-folder"></i>
</a><a href=/tags/ id=tags-link title=Tags><i class="fa-solid fa-tags"></i>
</a><button class=dark-mode-toggle id=theme-toggle-button aria-label="Toggle color scheme">
<i class="fa-solid fa-circle-half-stroke"></i></button></div><div class=menu-search id=search-input data-hotkeys=s/ role=button tabindex=0 aria-label=검색 data-i18n-id=search.action.label data-i18n-attrs=aira-label><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=search-placeholder data-i18n-id=search.input.label data-i18n-text='{"`/`": "$code"}'><code>/</code> 를 눌러 검색하세요</span></div><div class=menu-categories><input type=checkbox class="hidden toggle" id=categories-control checked>
<label for=categories-control class="categories-label categories-toggle"><a href=/categories/ class=categories-root><i class="fa-solid fa-folder"></i>
<span data-i18n-id=categories.root.label data-i18n-text>전체
</span><span class=category-count>(41)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li><input type=checkbox class="hidden toggle" id=cat-algorithm>
<label for=cat-algorithm class="categories-label categories-toggle"><a href="/search/?category1=Algorithm"><i class="fa-solid fa-folder"></i>Algorithm<span class=category-count>(4)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Algorithm&category2=Graph"><i class="fa-solid fa-file"></i>Graph<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=Python"><i class="fa-solid fa-file"></i>Python<span class=category-count>(2)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=SQL"><i class="fa-solid fa-file"></i>SQL<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-cloud>
<label for=cat-cloud class="categories-label categories-toggle"><a href="/search/?category1=Cloud"><i class="fa-solid fa-folder"></i>Cloud<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Cloud&category2=Kubernetes"><i class="fa-solid fa-file"></i>Kubernetes<span class=category-count>(2)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-analysis>
<label for=cat-data-analysis class="categories-label categories-toggle"><a href="/search/?category1=Data%20Analysis"><i class="fa-solid fa-folder"></i>Data Analysis<span class=category-count>(3)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Analysis&category2=Dacon"><i class="fa-solid fa-file"></i>Dacon<span class=category-count>(3)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-engineering>
<label for=cat-data-engineering class="categories-label categories-toggle"><a href="/search/?category1=Data%20Engineering"><i class="fa-solid fa-folder"></i>Data Engineering<span class=category-count>(19)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Airflow"><i class="fa-solid fa-file"></i>Apache Airflow<span class=category-count>(7)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Spark"><i class="fa-solid fa-file"></i>Apache Spark<span class=category-count>(8)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Crawling"><i class="fa-solid fa-file"></i>Crawling<span class=category-count>(4)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-frontend>
<label for=cat-frontend class="categories-label categories-toggle"><a href="/search/?category1=Frontend"><i class="fa-solid fa-folder"></i>Frontend<span class=category-count>(10)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Frontend&category2=Blog"><i class="fa-solid fa-file"></i>Blog<span class=category-count>(10)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-linux>
<label for=cat-linux class="categories-label categories-toggle"><a href="/search/?category1=Linux"><i class="fa-solid fa-folder"></i>Linux<span class=category-count>(1)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Linux&category2=Ubuntu"><i class="fa-solid fa-file"></i>Ubuntu<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-project>
<label for=cat-project class="categories-label categories-toggle"><a href="/search/?category1=Project"><i class="fa-solid fa-folder"></i>Project<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Project&category2=Open%20Source"><i class="fa-solid fa-file"></i>Open Source<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Project&category2=Tools"><i class="fa-solid fa-file"></i>Tools<span class=category-count>(1)</span></a></li></ul></li></ul></div><div class=recent-posts><div class=recent-post-label><i class="fa-solid fa-clock"></i>
<span data-i18n-id=menu.recent.posts data-i18n-text>최신글</span></div><ul class=recent-post-list><li class=recent-post-item><a href=/blog/hugo-seotax-1/ title="Hugo 서택스(SeoTax) 테마 제작기 - 동적 렌더링으로 확장된 검색"><div class=recent-post-title>Hugo 서택스(SeoTax) 테마 제작기 - 동적 렌더링으로 확장된 검색</div><div class=recent-post-date><time datetime=2026-01-25>2026.01.25</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-5/ title="Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)"><div class=recent-post-title>Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)</div><div class=recent-post-date><time datetime=2025-12-15>2025.12.15</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-4/ title="Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기"><div class=recent-post-title>Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기</div><div class=recent-post-date><time datetime=2025-12-14>2025.12.14</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-3/ title="Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현"><div class=recent-post-title>Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현</div><div class=recent-post-date><time datetime=2025-11-22>2025.11.22</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-2/ title="Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선"><div class=recent-post-title>Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선</div><div class=recent-post-date><time datetime=2025-11-04>2025.11.04</time></div></a></li></ul></div></nav><script>(function(){var e=document.querySelector("aside .menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=main-wrap><header class=site-header><div class="flex align-center justify-between"><label for=menu-control aria-label="메뉴 접기/펼치기" title="메뉴 접기/펼치기" data-i18n-id=menu.toggle.tooltip data-i18n-attrs=aria-label,title><i class="fa-solid fa-bars menu-icon" id=menu-icon></i></label><div class=mobile-search id=mobile-search-input role=button tabindex=0 aria-label=검색 data-i18n-id=search.action.label data-i18n-attrs=aria-label><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=mobile-title>Minystory</span>
<i class=mobile-title-pad></i></div><label for=toc-control aria-label="목차 접기/펼치기" title="목차 접기/펼치기" data-i18n-id=toc.toggle.tooltip data-i18n-attrs=aria-label,title><i class="fa-solid fa-list menu-icon" id=toc-icon></i></label></div></header><article class="content-wrap markdown" id=content-wrap><header class=content-header><div class=content-category><a href="/search/?category1=Algorithm&category2=SQL" class=content-category-link>Algorithm/SQL</a></div><h1 class=content-title>프로그래머스 SQL Lv.4, 5 완전 정복 - 20문제 상세 풀이 (JOIN, GROUP BY, 윈도우 함수)</h1><div class=content-datetime><time datetime=2025-07-03T23:15:02+09:00>2025. 07. 03. 23:15
</time><span id=reading-time></span></div></header><div class=content-cover-wrap><img src="https://dl.dropboxusercontent.com/scl/fi/3090p904jp5tkidn1l398/programmers-cover.webp?rlkey=yvpp7t47lzzxm8lgsjfdgdeby&amp;raw=1" class=content-cover alt="Cover Image" decoding=async></div><p>이직 준비를 하면서 오랜만에 코딩테스트를 보게되었는데,
SQL 코딩테스트는 어떻게 나오나 궁금해서 프로그래머스 Lv.4, 5 수준의 문제를 모두 풀어보았습니다.</p><h2 id=모든-문제>모든 문제
<a class=anchor href=#%eb%aa%a8%eb%93%a0-%eb%ac%b8%ec%a0%9c>#</a></h2><p>표에서 ID를 클릭하면 프로그래머스 문제 풀이로 이동합니다.
문제는 최신순으로 정렬되어 있는데 풀이 순서는 표에서 역순으로, 즉 오래된순으로 나열합니다.</p><p>문제를 순서대로 풀어보면 유사한 데이터를 사용하는 경우가 있어 비슷한건 큰 제목으로 묶었습니다.
테이블 구조는 생략하고 <code>문제 요약 > 문제 해석 + 풀이 > SQL문</code> 순서로 구성합니다.</p><div class=sc-data-table><table class=data-table data-filename><thead><tr><th title=ID style=text-align:center>ID</th><th title=제목>제목</th><th title=유형>유형</th><th title=난이도 style=text-align:center>난이도</th><th title=정답률 style=text-align:center>정답률</th><th title=문제풀기 style=text-align:center>문제풀기</th><th title=풀이보기 style=text-align:center>풀이보기</th></tr></thead><tbody><tr><td title=301651 style=text-align:center>301651</td><td title="멸종위기의 대장균 찾기">멸종위기의 대장균 찾기</td><td title=SELECT>SELECT</td><td title=Lv.5 style=text-align:center>Lv.5</td><td title=21% style=text-align:center>21%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/301651) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/301651 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#멸종위기의-대장균-찾기) style=text-align:center><a href=#%eb%a9%b8%ec%a2%85%ec%9c%84%ea%b8%b0%ec%9d%98-%eb%8c%80%ec%9e%a5%ea%b7%a0-%ec%b0%be%ea%b8%b0>링크</a></td></tr><tr><td title=301650 style=text-align:center>301650</td><td title="특정 세대의 대장균 찾기">특정 세대의 대장균 찾기</td><td title=SELECT>SELECT</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=61% style=text-align:center>61%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/301650) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/301650 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#특정-세대의-대장균-찾기) style=text-align:center><a href=#%ed%8a%b9%ec%a0%95-%ec%84%b8%eb%8c%80%ec%9d%98-%eb%8c%80%ec%9e%a5%ea%b7%a0-%ec%b0%be%ea%b8%b0>링크</a></td></tr><tr><td title=284528 style=text-align:center>284528</td><td title="연간 평가점수에 해당하는 평가 등급 및 성과금 조회하기">연간 평가점수에 해당하는 평가 등급 및 성과금 조회하기</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=72% style=text-align:center>72%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/284528) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/284528 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#연간-평가점수에-해당하는-평가-등급-및-성과금-조회하기) style=text-align:center><a href=#%ec%97%b0%ea%b0%84-%ed%8f%89%ea%b0%80%ec%a0%90%ec%88%98%ec%97%90-%ed%95%b4%eb%8b%b9%ed%95%98%eb%8a%94-%ed%8f%89%ea%b0%80-%eb%93%b1%ea%b8%89-%eb%b0%8f-%ec%84%b1%ea%b3%bc%ea%b8%88-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=276036 style=text-align:center>276036</td><td title="언어별 개발자 분류하기">언어별 개발자 분류하기</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=41% style=text-align:center>41%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/276036) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/276036 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#언어별-개발자-분류하기) style=text-align:center><a href=#%ec%96%b8%ec%96%b4%eb%b3%84-%ea%b0%9c%eb%b0%9c%ec%9e%90-%eb%b6%84%eb%a5%98%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=276035 style=text-align:center>276035</td><td title="FrontEnd 개발자 찾기">FrontEnd 개발자 찾기</td><td title=JOIN>JOIN</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=51% style=text-align:center>51%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/276035) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/276035 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#frontend-개발자-찾기) style=text-align:center><a href=#frontend-%ea%b0%9c%eb%b0%9c%ec%9e%90-%ec%b0%be%ea%b8%b0>링크</a></td></tr><tr><td title=157339 style=text-align:center>157339</td><td title="특정 기간동안 대여 가능한 자동차들의 대여비용 구하기">특정 기간동안 대여 가능한 자동차들의 대여비용 구하기</td><td title=JOIN>JOIN</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=49% style=text-align:center>49%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/157339) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/157339 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#특정-기간동안-대여-가능한-자동차들의-대여비용-구하기) style=text-align:center><a href=#%ed%8a%b9%ec%a0%95-%ea%b8%b0%ea%b0%84%eb%8f%99%ec%95%88-%eb%8c%80%ec%97%ac-%ea%b0%80%eb%8a%a5%ed%95%9c-%ec%9e%90%eb%8f%99%ec%b0%a8%eb%93%a4%ec%9d%98-%eb%8c%80%ec%97%ac%eb%b9%84%ec%9a%a9-%ea%b5%ac%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=151141 style=text-align:center>151141</td><td title="자동차 대여 기록 별 대여 금액 구하기">자동차 대여 기록 별 대여 금액 구하기</td><td title="String, Date">String, Date</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=51% style=text-align:center>51%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/151141) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/151141 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#자동차-대여-기록-별-대여-금액-구하기) style=text-align:center><a href=#%ec%9e%90%eb%8f%99%ec%b0%a8-%eb%8c%80%ec%97%ac-%ea%b8%b0%eb%a1%9d-%eb%b3%84-%eb%8c%80%ec%97%ac-%ea%b8%88%ec%95%a1-%ea%b5%ac%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=144856 style=text-align:center>144856</td><td title="저자 별 카테고리 별 매출액 집계하기">저자 별 카테고리 별 매출액 집계하기</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=76% style=text-align:center>76%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/144856) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/144856 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#저자-별-카테고리-별-매출액-집계하기) style=text-align:center><a href=#%ec%a0%80%ec%9e%90-%eb%b3%84-%ec%b9%b4%ed%85%8c%ea%b3%a0%eb%a6%ac-%eb%b3%84-%eb%a7%a4%ec%b6%9c%ec%95%a1-%ec%a7%91%ea%b3%84%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=133027 style=text-align:center>133027</td><td title="주문량이 많은 아이스크림들 조회하기">주문량이 많은 아이스크림들 조회하기</td><td title=JOIN>JOIN</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=74% style=text-align:center>74%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/133027) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/133027 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#주문량이-많은-아이스크림들-조회하기) style=text-align:center><a href=#%ec%a3%bc%eb%ac%b8%eb%9f%89%ec%9d%b4-%eb%a7%8e%ec%9d%80-%ec%95%84%ec%9d%b4%ec%8a%a4%ed%81%ac%eb%a6%bc%eb%93%a4-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=132204 style=text-align:center>132204</td><td title="취소되지 않은 진료 예약 조회하기">취소되지 않은 진료 예약 조회하기</td><td title="String, Date">String, Date</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=79% style=text-align:center>79%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/132204) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/132204 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#취소되지-않은-진료-예약-조회하기) style=text-align:center><a href=#%ec%b7%a8%ec%86%8c%eb%90%98%ec%a7%80-%ec%95%8a%ec%9d%80-%ec%a7%84%eb%a3%8c-%ec%98%88%ec%95%bd-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131537 style=text-align:center>131537</td><td title="오프라인/온라인 판매 데이터 통합하기">오프라인/온라인 판매 데이터 통합하기</td><td title=SELECT>SELECT</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=67% style=text-align:center>67%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131537) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131537 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#오프라인/온라인-판매-데이터-통합하기) style=text-align:center><a href=#%ec%98%a4%ed%94%84%eb%9d%bc%ec%9d%b8/%ec%98%a8%eb%9d%bc%ec%9d%b8-%ed%8c%90%eb%a7%a4-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ed%86%b5%ed%95%a9%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131534 style=text-align:center>131534</td><td title="상품을 구매한 회원 비율 구하기">상품을 구매한 회원 비율 구하기</td><td title=JOIN>JOIN</td><td title=Lv.5 style=text-align:center>Lv.5</td><td title=46% style=text-align:center>46%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131534) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131534 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#상품을-구매한-회원-비율-구하기) style=text-align:center><a href=#%ec%83%81%ed%92%88%ec%9d%84-%ea%b5%ac%eb%a7%a4%ed%95%9c-%ed%9a%8c%ec%9b%90-%eb%b9%84%ec%9c%a8-%ea%b5%ac%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131532 style=text-align:center>131532</td><td title="년, 월, 성별 별 상품 구매 회원 수 구하기">년, 월, 성별 별 상품 구매 회원 수 구하기</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=75% style=text-align:center>75%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131532) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131532 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#년,-월,-성별-별-상품-구매-회원-수-구하기) style=text-align:center><a href=#%eb%85%84,-%ec%9b%94,-%ec%84%b1%eb%b3%84-%eb%b3%84-%ec%83%81%ed%92%88-%ea%b5%ac%eb%a7%a4-%ed%9a%8c%ec%9b%90-%ec%88%98-%ea%b5%ac%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131124 style=text-align:center>131124</td><td title="그룹별 조건에 맞는 식당 목록 출력하기">그룹별 조건에 맞는 식당 목록 출력하기</td><td title=JOIN>JOIN</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=71% style=text-align:center>71%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131124) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131124 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#그룹별-조건에-맞는-식당-목록-출력하기) style=text-align:center><a href=#%ea%b7%b8%eb%a3%b9%eb%b3%84-%ec%a1%b0%ea%b1%b4%ec%97%90-%eb%a7%9e%eb%8a%94-%ec%8b%9d%eb%8b%b9-%eb%aa%a9%eb%a1%9d-%ec%b6%9c%eb%a0%a5%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131118 style=text-align:center>131118</td><td title="서울에 위치한 식당 목록 출력하기">서울에 위치한 식당 목록 출력하기</td><td title=SELECT>SELECT</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=75% style=text-align:center>75%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131118) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131118 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#서울에-위치한-식당-목록-출력하기) style=text-align:center><a href=#%ec%84%9c%ec%9a%b8%ec%97%90-%ec%9c%84%ec%b9%98%ed%95%9c-%ec%8b%9d%eb%8b%b9-%eb%aa%a9%eb%a1%9d-%ec%b6%9c%eb%a0%a5%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131117 style=text-align:center>131117</td><td title="5월 식품들의 총매출 조회하기">5월 식품들의 총매출 조회하기</td><td title=JOIN>JOIN</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=84% style=text-align:center>84%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131117) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131117 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#5월-식품들의-총매출-조회하기) style=text-align:center><a href=#5%ec%9b%94-%ec%8b%9d%ed%92%88%eb%93%a4%ec%9d%98-%ec%b4%9d%eb%a7%a4%ec%b6%9c-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=131116 style=text-align:center>131116</td><td title="식품분류별 가장 비싼 식품의 정보 조회하기">식품분류별 가장 비싼 식품의 정보 조회하기</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=85% style=text-align:center>85%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/131116) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131116 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#식품분류별-가장-비싼-식품의-정보-조회하기) style=text-align:center><a href=#%ec%8b%9d%ed%92%88%eb%b6%84%eb%a5%98%eb%b3%84-%ea%b0%80%ec%9e%a5-%eb%b9%84%ec%8b%bc-%ec%8b%9d%ed%92%88%ec%9d%98-%ec%a0%95%eb%b3%b4-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>링크</a></td></tr><tr><td title=62284 style=text-align:center>62284</td><td title="우유와 요거트가 담긴 장바구니">우유와 요거트가 담긴 장바구니</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=74% style=text-align:center>74%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/62284) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/62284 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#우유와-요거트가-담긴-장바구니) style=text-align:center><a href=#%ec%9a%b0%ec%9c%a0%ec%99%80-%ec%9a%94%ea%b1%b0%ed%8a%b8%ea%b0%80-%eb%8b%b4%ea%b8%b4-%ec%9e%a5%eb%b0%94%ea%b5%ac%eb%8b%88>링크</a></td></tr><tr><td title=59413 style=text-align:center>59413</td><td title="입양 시각 구하기(2)">입양 시각 구하기(2)</td><td title="GROUP BY">GROUP BY</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=61% style=text-align:center>61%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/59413) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/59413 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#입양-시각-구하기(2)) style=text-align:center><a href=#%ec%9e%85%ec%96%91-%ec%8b%9c%ea%b0%81-%ea%b5%ac%ed%95%98%ea%b8%b0%282%29>링크</a></td></tr><tr><td title=59045 style=text-align:center>59045</td><td title="보호소에서 중성화한 동물">보호소에서 중성화한 동물</td><td title=JOIN>JOIN</td><td title=Lv.4 style=text-align:center>Lv.4</td><td title=85% style=text-align:center>85%</td><td title=[링크](https://school.programmers.co.kr/learn/courses/30/lessons/59045) style=text-align:center><a href=https://school.programmers.co.kr/learn/courses/30/lessons/59045 target=_blank rel="noopener noreferrer">링크</a></td><td title=[링크](#보호소에서-중성화한-동물) style=text-align:center><a href=#%eb%b3%b4%ed%98%b8%ec%86%8c%ec%97%90%ec%84%9c-%ec%a4%91%ec%84%b1%ed%99%94%ed%95%9c-%eb%8f%99%eb%ac%bc>링크</a></td></tr></tbody></table></div><h2 id=동물-입양-테이블>동물 입양 테이블
<a class=anchor href=#%eb%8f%99%eb%ac%bc-%ec%9e%85%ec%96%91-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=보호소에서-중성화한-동물><a href=https://school.programmers.co.kr/learn/courses/30/lessons/59045 target=_blank rel="noopener noreferrer">보호소에서 중성화한 동물</a>
<a class=anchor href=#%eb%b3%b4%ed%98%b8%ec%86%8c%ec%97%90%ec%84%9c-%ec%a4%91%ec%84%b1%ed%99%94%ed%95%9c-%eb%8f%99%eb%ac%bc>#</a></h3><blockquote class=sc-hint><p><code>ANIMAL_INS</code> 테이블은 동물 보호소에 들어온 동물의 정보를 담은 테이블입니다.
<code>ANIMAL_OUTS</code> 테이블은 동물 보호소에서 입양 보낸 동물의 정보를 담은 테이블입니다.</p><p>보호소에서 중성화 수술을 거친 동물 정보를 알아보려 합니다. 보호소에 들어올 당시에는 중성화되지 않았지만,
보호소를 나갈 당시에는 중성화된 동물의 아이디와 생물 종, 이름을 조회하는 아이디 순으로 조회하는 SQL 문을 작성해주세요.</p></blockquote><p>보호소에 들어올 당시에 대한 테이블 <code>ANIMAL_INS</code> 에서 특정 조건만 선택하고,
보호소를 나갈 당시에 대한 테이블 <code>ANIMAL_OUTS</code> 에서 특정 조건만 선택해서,
두 테이블을 <code>INNER JOIN</code> 하여 두 조건을 만족하는 경우만 선택하는 문제입니다.</p><p><code>ANIMAL_INS</code> 테이블에서는 중성화되지 않은 조건인, 성별 및 중성화 여부(<code>SEX_UPON_INTAKE</code>)에
"Intact" 단어가 포함된 경우를 선택하면 됩니다.
중성화 여부를 나타내는 단어는 앞에 있기 때문에 <code>LIKE 'Intact%'</code> 조건식을 사용했습니다.</p><p><code>ANIMAL_OUTS</code> 테이블에서는 중성화된 조건인, 성별 및 중성화 여부(<code>SEX_UPON_INTAKE</code>)에
"Spayed" 또는 "Neutered" 단어가 포함된 경우를 선택하면 됩니다.
너무 길게 쓰는건 좋아하지 않아서 정규표현식을 활용하여 <code>REGEXP '^Spayed|Neutered'</code> 로 표현했습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>INS</span><span class=p>.</span><span class=n>ANIMAL_ID</span><span class=p>,</span><span class=w> </span><span class=n>INS</span><span class=p>.</span><span class=n>ANIMAL_TYPE</span><span class=p>,</span><span class=w> </span><span class=n>INS</span><span class=p>.</span><span class=n>NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>ANIMAL_INS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>INS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>ANIMAL_OUTS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>OUTS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>INS</span><span class=p>.</span><span class=n>ANIMAL_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>OUTS</span><span class=p>.</span><span class=n>ANIMAL_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>INS</span><span class=p>.</span><span class=n>SEX_UPON_INTAKE</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;Intact%&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>OUTS</span><span class=p>.</span><span class=n>SEX_UPON_OUTCOME</span><span class=w> </span><span class=n>REGEXP</span><span class=w> </span><span class=s1>&#39;^Spayed|Neutered&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ANIMAL_ID</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=입양-시각-구하기2><a href=https://school.programmers.co.kr/learn/courses/30/lessons/59413 target=_blank rel="noopener noreferrer">입양 시각 구하기(2)</a>
<a class=anchor href=#%ec%9e%85%ec%96%91-%ec%8b%9c%ea%b0%81-%ea%b5%ac%ed%95%98%ea%b8%b02>#</a></h3><blockquote class=sc-hint><p><code>ANIMAL_OUTS</code> 테이블은 동물 보호소에서 입양 보낸 동물의 정보를 담은 테이블입니다.</p><p>보호소에서는 몇 시에 입양이 가장 활발하게 일어나는지 알아보려 합니다. 0시부터 23시까지,
각 시간대별로 입양이 몇 건이나 발생했는지 조회하는 SQL문을 작성해주세요. 이때 결과는 시간대 순으로 정렬해야 합니다.</p></blockquote><p>입양일(<code>DATETIME</code>)에서 시간만 추출하고, 추출한 값을 기준으로 COUNT 집계하는 문제입니다.</p><p>주의할 점은, 0시부터 23시까지 모든 행이 존재해야 합니다. <code>ANIMAL_OUTS</code> 테이블에
모든 시간대가 있지 않기 때문에 0시부터 23시까지 값을 가지는 테이블을 만들어야 합니다.</p><p>잘 안써본 구문이라 찾아봤는데 <code>RECURSIVE</code> 라는 재귀적 쿼리를 활용하면 간단하게 해결될 것 같았습니다.
재귀적 쿼리를 사용한 <code>HOURS</code> 임시 테이블을 생성하고, 여기에 <code>ANIMAL_OUTS</code> 테이블을 COUNT 집계한
<code>COUNTS</code> 임시 테이블을 <code>LEFT JOIN</code> 으로 붙여서 모든 시간대를 표시했습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>HOURS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HOUR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>HOUR</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>HOURS</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>HOUR</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>23</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>COUNTS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>HOUR</span><span class=p>(</span><span class=n>DATETIME</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HOUR</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>ANIMAL_ID</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ANIMAL_OUTS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>HOUR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>HR</span><span class=p>.</span><span class=n>HOUR</span><span class=p>,</span><span class=w> </span><span class=n>COALESCE</span><span class=p>(</span><span class=n>CNT</span><span class=p>.</span><span class=k>COUNT</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>HOURS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>COUNTS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>CNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>HR</span><span class=p>.</span><span class=n>HOUR</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CNT</span><span class=p>.</span><span class=n>HOUR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>HOUR</span><span class=p>;</span></span></span></code></pre></div></div><h2 id=식품-테이블>식품 테이블
<a class=anchor href=#%ec%8b%9d%ed%92%88-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=우유와-요거트가-담긴-장바구니><a href=https://school.programmers.co.kr/learn/courses/30/lessons/62284 target=_blank rel="noopener noreferrer">우유와 요거트가 담긴 장바구니</a>
<a class=anchor href=#%ec%9a%b0%ec%9c%a0%ec%99%80-%ec%9a%94%ea%b1%b0%ed%8a%b8%ea%b0%80-%eb%8b%b4%ea%b8%b4-%ec%9e%a5%eb%b0%94%ea%b5%ac%eb%8b%88>#</a></h3><blockquote class=sc-hint><p><code>CART_PRODUCTS</code> 테이블은 장바구니에 담긴 상품 정보를 담은 테이블입니다.</p><p>데이터 분석 팀에서는 우유(Milk)와 요거트(Yogurt)를 동시에 구입한 장바구니가 있는지 알아보려 합니다.
우유와 요거트를 동시에 구입한 장바구니의 아이디를 조회하는 SQL 문을 작성해주세요.
이때 결과는 장바구니의 아이디 순으로 나와야 합니다.</p></blockquote><p>장바구니의 아이디(<code>CART_ID</code>) 그룹으로 집계하면서, 상품 종류(<code>NAME</code>) 에
"Milk"가 있는 경우와 "Yogurt"가 있는 경우를 모두 만족하는 아이디만 선택하는 문제입니다.</p><p>자주 쓰는 Python에서는 Boolean 타입의 <code>True</code> / <code>False</code> 를 각각 정수 1과 0으로 인식할 수 있는데,
SQL도 그렇지 않을까 싶어서 SUM 집계해봤습니다.
두 가지 조건에 대해 SUM 집계 결과가 1 이상인 경우만 선택해서 아이디만 조회했습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>COUNTS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>CART_ID</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;Milk&#34;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>MILK_COUNT</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;Yogurt&#34;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>YOG_COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>CART_PRODUCTS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>CART_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>CART_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>COUNTS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>MILK_COUNT</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>YOG_COUNT</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>CART_ID</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=식품분류별-가장-비싼-식품의-정보-조회하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131116 target=_blank rel="noopener noreferrer">식품분류별 가장 비싼 식품의 정보 조회하기</a>
<a class=anchor href=#%ec%8b%9d%ed%92%88%eb%b6%84%eb%a5%98%eb%b3%84-%ea%b0%80%ec%9e%a5-%eb%b9%84%ec%8b%bc-%ec%8b%9d%ed%92%88%ec%9d%98-%ec%a0%95%eb%b3%b4-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>FOOD_PRODUCT</code> 테이블은 식품의 정보를 담은 테이블입니다.</p><p><code>FOOD_PRODUCT</code> 테이블에서 식품분류별로 가격이 제일 비싼 식품의 분류, 가격,
이름을 조회하는 SQL문을 작성해주세요. 이때 식품분류가 '과자', '국', '김치', '식용유'인 경우만
출력시켜 주시고 결과는 식품 가격을 기준으로 내림차순 정렬해주세요.</p></blockquote><p>식품분류(<code>CATEGORY</code>) 그룹에서 가격(<code>PRICE</code>)이 가장 큰 항목만 선택하는 문제입니다.</p><p>가격(<code>PRICE</code>)이 MAX 집계 결과와 동일한 항목만 선택하는 경우도 있지만, 더 간단하게 WINDOW 함수를 사용했습니다.
식품분류(<code>CATEGORY</code>) 파티션에 대해 가격(<code>PRICE</code>)을 내림차순으로 정렬한
순번(<code>ROW_NUMBER</code>)이 1인 경우만 선택하면 동일한 결과를 조회할 수 있습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>HIGHEST</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>CATEGORY</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>PRICE</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SEQ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>FOOD_PRODUCT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>CATEGORY</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s2>&#34;과자&#34;</span><span class=p>,</span><span class=s2>&#34;국&#34;</span><span class=p>,</span><span class=s2>&#34;김치&#34;</span><span class=p>,</span><span class=s2>&#34;식용유&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>CATEGORY</span><span class=p>,</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>PRICE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>MAX_PRICE</span><span class=p>,</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>PRODUCT_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>FOOD_PRODUCT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PRD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>HIGHEST</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SEQ</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HGT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>PRODUCT_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>HGT</span><span class=p>.</span><span class=n>PRODUCT_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>MAX_PRICE</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=5월-식품들의-총매출-조회하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131117 target=_blank rel="noopener noreferrer">5월 식품들의 총매출 조회하기</a>
<a class=anchor href=#5%ec%9b%94-%ec%8b%9d%ed%92%88%eb%93%a4%ec%9d%98-%ec%b4%9d%eb%a7%a4%ec%b6%9c-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>FOOD_PRODUCT</code> 테이블은 식품의 정보를 담은 테이블입니다.
<code>FOOD_ORDER</code> 테이블은 식품의 주문 정보를 담은 테이블입니다.</p><p><code>FOOD_PRODUCT</code> 와 <code>FOOD_ORDER</code> 테이블에서 생산일자가 2022년 5월인 식품들의
식품 ID, 식품 이름, 총매출을 조회하는 SQL문을 작성해주세요. 이때 결과는 총매출을 기준으로
내림차순 정렬해주시고 총매출이 같다면 식품 ID를 기준으로 오름차순 정렬해주세요.</p></blockquote><p>식품 ID(<code>PRODUCT_ID</code>) 그룹에 대해 총매출(<code>SUM(AMOUNT * PRICE)</code>)을 계산하는 문제입니다.</p><p><code>JOIN</code> 을 먼저해서 매출(<code>AMOUNT * PRICE</code>)을 계산하고 SUM 집계하는 경우도 가능한데,
개인적으로는 <code>GROUP BY</code> 시에 식품 이름(<code>PRODUCT_NAME</code>)과 같은 긴 문자열을 포함하는 것을 선호하지 않습니다.</p><p>입고일(<code>PRODUCE_DATE</code>)에 따라 가격(<code>PRICE</code>)이 바뀌는 것도 아니기 때문에 <code>JOIN</code> 과 <code>GROUP BY</code> 의
순서를 신경쓸 필요도 없습니다. 물론, <code>FOOD_PRODUCT</code> 테이블에서 식품 ID(<code>PRODUCT_ID</code>)에 중복이 없음을 전제로 합니다.</p><p>따라서, 식품 ID(<code>PRODUCT_ID</code>)에 대해서 먼저 <code>GROUP BY</code> 하여 총주문량(<code>SUM(AMOUNT)</code>)을 계산하고,
가격(<code>PRICE</code>)을 나중에 곱해 총매출(<code>SUM(AMOUNT) * PRICE</code>)을 만들었습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>AMOUNTS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>AMOUNT</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>TOTAL_AMOUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>FOOD_ORDER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>PRODUCE_DATE</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2022-05-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2022-05-31&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>AMT</span><span class=p>.</span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>PRODUCT_NAME</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=n>AMT</span><span class=p>.</span><span class=n>TOTAL_AMOUNT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>PRICE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>TOTAL_SALES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>AMOUNTS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>AMT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>FOOD_PRODUCT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PRD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>AMT</span><span class=p>.</span><span class=n>PRODUCT_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PRD</span><span class=p>.</span><span class=n>PRODUCT_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>TOTAL_SALES</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=w> </span><span class=k>ASC</span><span class=p>;</span></span></span></code></pre></div></div><h2 id=식당-테이블>식당 테이블
<a class=anchor href=#%ec%8b%9d%eb%8b%b9-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=서울에-위치한-식당-목록-출력하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131118 target=_blank rel="noopener noreferrer">서울에 위치한 식당 목록 출력하기</a>
<a class=anchor href=#%ec%84%9c%ec%9a%b8%ec%97%90-%ec%9c%84%ec%b9%98%ed%95%9c-%ec%8b%9d%eb%8b%b9-%eb%aa%a9%eb%a1%9d-%ec%b6%9c%eb%a0%a5%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>REST_INFO</code> 테이블은 식당의 정보를 담은 테이블입니다.
<code>REST_REVIEW</code> 테이블은 식당의 리뷰 정보를 담은 테이블입니다.</p><p><code>REST_INFO</code> 와 <code>REST_REVIEW</code> 테이블에서 서울에 위치한 식당들의
식당 ID, 식당 이름, 음식 종류, 즐겨찾기수, 주소, 리뷰 평균 점수를 조회하는 SQL문을 작성해주세요.
이때 리뷰 평균점수는 소수점 세 번째 자리에서 반올림 해주시고 결과는 평균점수를 기준으로 내림차순 정렬해주시고,
평균점수가 같다면 즐겨찾기수를 기준으로 내림차순 정렬해주세요.</p></blockquote><p><code>REST_REVIEW</code> 테이블에서 식당 ID(<code>REST_ID</code>) 그룹에 대해 리뷰 평균 점수(<code>AVG(REVIEW_SCORE)</code>)를 계산하고,
<code>REST_INFO</code> 테이블에 계산 결과를 결합하는 문제입니다.</p><p><code>REST_INFO</code> 테이블을 조회하면 서울에 있는 식당은 전부 주소(<code>ADDRESS</code>)가 "서울"로 시작합니다.
정렬 기준만 맞춰서 조회하면 정답을 도출할 수 있습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>REVIEWS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>REST_ID</span><span class=p>,</span><span class=w> </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>REVIEW_SCORE</span><span class=p>),</span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SCORE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>REST_REVIEW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>REST_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>REST_ID</span><span class=p>,</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>REST_NAME</span><span class=p>,</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>FOOD_TYPE</span><span class=p>,</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>FAVORITES</span><span class=p>,</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>ADDRESS</span><span class=p>,</span><span class=w> </span><span class=n>RVW</span><span class=p>.</span><span class=n>SCORE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>REST_INFO</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>INFO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>REVIEWS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>RVW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>REST_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RVW</span><span class=p>.</span><span class=n>REST_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>INFO</span><span class=p>.</span><span class=n>ADDRESS</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s2>&#34;서울%&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>FAVORITES</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=그룹별-조건에-맞는-식당-목록-출력하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131124 target=_blank rel="noopener noreferrer">그룹별 조건에 맞는 식당 목록 출력하기</a>
<a class=anchor href=#%ea%b7%b8%eb%a3%b9%eb%b3%84-%ec%a1%b0%ea%b1%b4%ec%97%90-%eb%a7%9e%eb%8a%94-%ec%8b%9d%eb%8b%b9-%eb%aa%a9%eb%a1%9d-%ec%b6%9c%eb%a0%a5%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>MEMBER_PROFILE</code> 테이블은 고객의 정보를 담은 테이블입니다.
<code>REST_REVIEW</code> 테이블은 식당의 리뷰 정보를 담은 테이블입니다.</p><p><code>MEMBER_PROFILE</code> 와 <code>REST_REVIEW</code> 테이블에서 리뷰를 가장 많이 작성한 회원의 리뷰들을 조회하는 SQL문을 작성해주세요.
회원 이름, 리뷰 텍스트, 리뷰 작성일이 출력되도록 작성해주시고, 결과는 리뷰 작성일을 기준으로
오름차순, 리뷰 작성일이 같다면 리뷰 텍스트를 기준으로 오름차순 정렬해주세요.</p></blockquote><p><code>REST_REVIEW</code> 테이블에서 리뷰 수(<code>COUNT(REVIEW_ID)</code>)가 가장 큰 회원 ID(<code>MEMBER_ID</code>)에 대한 리뷰 목록을 조회하는 문제입니다.</p><p>회원 ID(<code>MEMBER_ID</code>) 그룹별 리뷰 수(<code>COUNT(REVIEW_ID)</code>)를 계산하고,
내림차순 정렬하여 첫 번째 항목만 조회하여 리뷰를 가장 많이 작성한 회원을 구합니다.</p><p>해당 회원 ID(<code>MEMBER_ID</code>)에 대한 <code>REST_REVIEW</code> 항목을 모두 조회하면서,
<code>MEMBER_PROFILE</code> 테이블을 결합해 회원 이름(<code>MEMBER_NAME</code>)을 같이 표시합니다.
DATE 타입의 리뷰 작성일(<code>REVIEW_DATE</code>)은 그대로 출력하면 안되고 <code>%Y-%m-%d</code> 날짜 포맷팅을 해야합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>BEST_MEMBER</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>MEMBER_ID</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>REVIEW_ID</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>REVIEW_COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>REST_REVIEW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>MEMBER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>REVIEW_COUNT</span><span class=w> </span><span class=k>DESC</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>MEM</span><span class=p>.</span><span class=n>MEMBER_NAME</span><span class=p>,</span><span class=w> </span><span class=n>RVW</span><span class=p>.</span><span class=n>REVIEW_TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>DATE_FORMAT</span><span class=p>(</span><span class=n>RVW</span><span class=p>.</span><span class=n>REVIEW_DATE</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y-%m-%d&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>REVIEW_DATE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>REST_REVIEW</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>RVW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>BEST_MEMBER</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>BST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>RVW</span><span class=p>.</span><span class=n>MEMBER_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BST</span><span class=p>.</span><span class=n>MEMBER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>MEMBER_PROFILE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>MEM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>RVW</span><span class=p>.</span><span class=n>MEMBER_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MEM</span><span class=p>.</span><span class=n>MEMBER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>REVIEW_DATE</span><span class=p>;</span></span></span></code></pre></div></div><h2 id=쇼핑몰-테이블>쇼핑몰 테이블
<a class=anchor href=#%ec%87%bc%ed%95%91%eb%aa%b0-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=년-월-성별-별-상품-구매-회원-수-구하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131532 target=_blank rel="noopener noreferrer">년, 월, 성별 별 상품 구매 회원 수 구하기</a>
<a class=anchor href=#%eb%85%84-%ec%9b%94-%ec%84%b1%eb%b3%84-%eb%b3%84-%ec%83%81%ed%92%88-%ea%b5%ac%eb%a7%a4-%ed%9a%8c%ec%9b%90-%ec%88%98-%ea%b5%ac%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>USER_INFO</code> 테이블은 의류 쇼핑몰에 가입한 회원 정보를 담은 테이블입니다.
<code>ONLINE_SALE</code> 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.</p><p><code>USER_INFO</code> 테이블과 <code>ONLINE_SALE</code> 테이블에서 년, 월, 성별 별로 상품을 구매한 회원수를
집계하는 SQL문을 작성해주세요. 결과는 년, 월, 성별을 기준으로 오름차순 정렬해주세요.
이때, 성별 정보가 없는 경우 결과에서 제외해주세요.</p></blockquote><p>두 테이블을 <code>INNER JOIN</code> 하면서 성별(<code>GENDER</code>)이 있는(<code>IS NOT NULL</code>) 경우만 선택합니다.</p><p>판매일(<code>SALES_DATE</code>)에서 각각 연도(<code>YEAR</code>), 월(<code>MONTH</code>)을 추출하고,
성별(<code>GENDER</code>)과 함께 세 가지 기준에 대해 <code>GROUP BY</code> 합니다.
그룹 내에서 중복 없는 회원 ID(<code>DISTINCT USER_ID</code>)를 COUNT 집계해 회원수를 계산합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>YEAR</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>MONTH</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>MONTH</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>USR</span><span class=p>.</span><span class=n>GENDER</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>USER_ID</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>USERS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>ONLINE_SALE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SALES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>USER_INFO</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>USR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>USER_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>USR</span><span class=p>.</span><span class=n>USER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>USR</span><span class=p>.</span><span class=n>GENDER</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w> </span><span class=k>MONTH</span><span class=p>,</span><span class=w> </span><span class=n>GENDER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w> </span><span class=k>MONTH</span><span class=p>,</span><span class=w> </span><span class=n>GENDER</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=상품을-구매한-회원-비율-구하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131534 target=_blank rel="noopener noreferrer">상품을 구매한 회원 비율 구하기</a>
<a class=anchor href=#%ec%83%81%ed%92%88%ec%9d%84-%ea%b5%ac%eb%a7%a4%ed%95%9c-%ed%9a%8c%ec%9b%90-%eb%b9%84%ec%9c%a8-%ea%b5%ac%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>USER_INFO</code> 테이블은 의류 쇼핑몰에 가입한 회원 정보를 담은 테이블입니다.
<code>ONLINE_SALE</code> 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.</p><p><code>USER_INFO</code> 테이블과 <code>ONLINE_SALE</code> 테이블에서 2021년에 가입한 전체 회원들 중 상품을 구매한 회원수와
상품을 구매한 회원의 비율(=2021년에 가입한 회원 중 상품을 구매한 회원수 / 2021년에 가입한 전체 회원 수)을
년, 월 별로 출력하는 SQL문을 작성해주세요. 상품을 구매한 회원의 비율은 소수점 두번째자리에서 반올림하고,
전체 결과는 년을 기준으로 오름차순 정렬해주시고 년이 같다면 월을 기준으로 오름차순 정렬해주세요.</p></blockquote><p>2021년에 가입한 회원수와, 그중에서 상품을 구매한 회원수를 집계해 그 비율을 계산하는 문제입니다.</p><p>우선, 대상을 2021년에 가입한 회원으로 좁히기 위해 <code>USER_INFO</code> 에서 가입일(<code>JOINED</code>)의 연도가
2021인 항목만 선택한 <code>TARGET_USERS</code> 임시 테이블 결과를 <code>ONLINE_SALE</code> 에 <code>INNER JOIN</code> 으로 연결합니다.</p><p>가입일(<code>JOINED</code>)에서 연도(<code>YEAR</code>) 와 월(<code>MONTH</code>)을 추출하고, 두 가지 기준에 대해 <code>GROUP BY</code> 합니다.
그룹 내에서 중복 없는 회원 ID(<code>DISTINCT USER_ID</code>)를 COUNT 집계해 회원수를 계산하는데,
이때 판매량(<code>SALES_AMOUNT</code>)이 1 이상인, 즉 상품을 구매한 회원 ID만 고려합니다.
조건에 맞지 않는 회원 ID는 <code>NULL</code> 로 바꿔서 COUNT 집계에서 제외했습니다.</p><p>이렇게 계산한 <code>PURCHASED_USERS</code> 값을 분자로, 회원 ID(<code>USER_ID</code>)를 COUNT 집계한 값을
분모로 하여 상품을 구매한 회원의 비율(<code>PURCHASED_RATIO</code>)을 계산합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>TARGET_USERS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>USER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>USER_INFO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>YEAR</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>JOINED</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2021</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>PURCHASED</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>YEAR</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>MONTH</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>MONTH</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=k>IF</span><span class=p>(</span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES_AMOUNT</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>USERS</span><span class=p>.</span><span class=n>USER_ID</span><span class=p>,</span><span class=w> </span><span class=k>NULL</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PURCHASED_USERS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ONLINE_SALE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SALES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>TARGET_USERS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>USERS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>USER_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>USERS</span><span class=p>.</span><span class=n>USER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w> </span><span class=k>MONTH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w> </span><span class=k>MONTH</span><span class=p>,</span><span class=w> </span><span class=n>PURCHASED_USERS</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=n>PURCHASED_USERS</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>USER_ID</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>TARGET_USERS</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PUCHASED_RATIO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>PURCHASED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>YEAR</span><span class=p>,</span><span class=w> </span><span class=k>MONTH</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=오프라인온라인-판매-데이터-통합하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/131537 target=_blank rel="noopener noreferrer">오프라인/온라인 판매 데이터 통합하기</a>
<a class=anchor href=#%ec%98%a4%ed%94%84%eb%9d%bc%ec%9d%b8%ec%98%a8%eb%9d%bc%ec%9d%b8-%ed%8c%90%eb%a7%a4-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ed%86%b5%ed%95%a9%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>ONLINE_SALE</code> 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.
<code>ONLINE_SALE</code> 테이블은 온라인 상품 판매 정보를 담은 테이블입니다.</p><p><code>ONLINE_SALE</code> 테이블과 <code>OFFLINE_SALE</code> 테이블에서 2022년 3월의 오프라인/온라인
상품 판매 데이터의 판매 날짜, 상품ID, 유저ID, 판매량을 출력하는 SQL문을 작성해주세요.
<code>OFFLINE_SALE</code> 테이블의 판매 데이터의 <code>USER_ID</code> 값은 NULL 로 표시해주세요.
결과는 판매일을 기준으로 오름차순 정렬해주시고 판매일이 같다면 상품 ID를 기준으로
오름차순, 상품ID까지 같다면 유저 ID를 기준으로 오름차순 정렬해주세요.</p></blockquote><p>두 테이블을 결과를 세로로 결합하고 정렬하는 문제입니다.</p><p><code>ONLINE_SALE</code> 테이블은 판매일(<code>SALES_DATE</code>), 상품 ID(<code>PRODUCT_ID</code>), 회원 ID(<code>USER_ID</code>)
그룹별로 판매량(<code>SALES_AMOUNT</code>)을 SUM 집계했습니다. <code>GROUP BY</code> 하라는 지문이 없어 안해도 되었던 것 같은데
개인적으로 판매 데이터를 보면 버릇처럼 <code>GROUP BY</code> 하게 됩니다.</p><p><code>OFFLINE_SALE</code> 테이블은 회원 ID(<code>USER_ID</code>)가 없지만, <code>UNION ALL</code> 연산을 위해 <code>ONLINE_SALE</code> 테이블과
구성을 맞춰줄 목적으로 <code>NULL</code> 값을 가지는 <code>USER_ID</code> 열을 추가합니다.</p><p>DATE 타입의 판매일(<code>REVIEW_DATE</code>)은 그대로 출력하면 안되고 <code>%Y-%m-%d</code> 날짜 포맷팅을 해야합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>DATE_FORMAT</span><span class=p>(</span><span class=n>TOTAL</span><span class=p>.</span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y-%m-%d&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>TOTAL</span><span class=p>.</span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>TOTAL</span><span class=p>.</span><span class=n>USER_ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>TOTAL</span><span class=p>.</span><span class=n>SALES_AMOUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w> </span><span class=n>USER_ID</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>SALES_AMOUNT</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SALES_AMOUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ONLINE_SALE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>SALES_DATE</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2022-03-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2022-03-31&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w> </span><span class=n>USER_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>USER_ID</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>SALES_AMOUNT</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SALES_AMOUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>OFFLINE_SALE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>SALES_DATE</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2022-03-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2022-03-31&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>TOTAL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>SALES_DATE</span><span class=p>,</span><span class=w> </span><span class=n>PRODUCT_ID</span><span class=p>,</span><span class=w> </span><span class=n>USER_ID</span><span class=p>;</span></span></span></code></pre></div></div><h2 id=진료-테이블>진료 테이블
<a class=anchor href=#%ec%a7%84%eb%a3%8c-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=취소되지-않은-진료-예약-조회하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/132204 target=_blank rel="noopener noreferrer">취소되지 않은 진료 예약 조회하기</a>
<a class=anchor href=#%ec%b7%a8%ec%86%8c%eb%90%98%ec%a7%80-%ec%95%8a%ec%9d%80-%ec%a7%84%eb%a3%8c-%ec%98%88%ec%95%bd-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>PATIENT</code> 테이블은 환자 정보를 담은 테이블입니다.
<code>DOCTOR</code> 테이블은 의사 정보를 담은 테이블입니다.
<code>APPOINTMENT</code> 테이블은 진료 예약목록을 담은 테이블입니다.</p><p><code>PATIENT</code>, <code>DOCTOR</code> 그리고 <code>APPOINTMENT</code> 테이블에서 2022년 4월 13일 취소되지 않은 흉부외과(CS)
진료 예약 내역을 조회하는 SQL문을 작성해주세요. 진료예약번호, 환자이름, 환자번호, 진료과코드, 의사이름, 진료예약일시 항목이
출력되도록 작성해주세요. 결과는 진료예약일시를 기준으로 오름차순 정렬해주세요.</p></blockquote><p>세 개의 테이블에서 조건에 맞는 항목들만 선택해 결합하는 문제입니다.</p><p><code>APPOINTMENT</code> 테이블에서는 진료 예약일시(<code>APNT_YMD</code>)가 '2022-04-13' 과 동일하고
예약취소여부(<code>APNT_CNCL_YN</code>)가 'N'에 해당하는 경우만 선택합니다.</p><p><code>DOCTOR</code> 테이블에서는 진료과코드(<code>MCDP_CD</code>)가 'CS'에 해당하는 경우만 선택합니다.</p><p><code>PATIENT</code> 테이블은 환자이름(<code>PT_NAME</code>)을 가져오기 위한 목적이며 따로 조건은 없습니다.</p><p>세 개의 테이블을 <code>INNER JOIN</code> 하여 조건을 결합하고 필요한 항목들을 출력합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>APP</span><span class=p>.</span><span class=n>APNT_NO</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>PAT</span><span class=p>.</span><span class=n>PT_NAME</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>APP</span><span class=p>.</span><span class=n>PT_NO</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>APP</span><span class=p>.</span><span class=n>MCDP_CD</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>DOC</span><span class=p>.</span><span class=n>DR_NAME</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>APP</span><span class=p>.</span><span class=n>APNT_YMD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>APPOINTMENT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>APP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>DOCTOR</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DOC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>APP</span><span class=p>.</span><span class=n>MDDR_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DOC</span><span class=p>.</span><span class=n>DR_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>PATIENT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PAT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>APP</span><span class=p>.</span><span class=n>PT_NO</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PAT</span><span class=p>.</span><span class=n>PT_NO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>DATE_FORMAT</span><span class=p>(</span><span class=n>APP</span><span class=p>.</span><span class=n>APNT_YMD</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y-%m-%d&#39;</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;2022-04-13&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>APP</span><span class=p>.</span><span class=n>APNT_CNCL_YN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;N&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>DOC</span><span class=p>.</span><span class=n>MCDP_CD</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CS&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>APNT_YMD</span></span></span></code></pre></div></div><h2 id=판매-테이블>판매 테이블
<a class=anchor href=#%ed%8c%90%eb%a7%a4-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=주문량이-많은-아이스크림들-조회하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/133027 target=_blank rel="noopener noreferrer">주문량이 많은 아이스크림들 조회하기</a>
<a class=anchor href=#%ec%a3%bc%eb%ac%b8%eb%9f%89%ec%9d%b4-%eb%a7%8e%ec%9d%80-%ec%95%84%ec%9d%b4%ec%8a%a4%ed%81%ac%eb%a6%bc%eb%93%a4-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>FIRST_HALF</code> 테이블은 아이스크림 가게의 상반기 주문 정보를 담은 테이블입니다.
<code>JULY</code> 테이블은 7월의 아이스크림 주문 정보를 담은 테이블입니다.</p><p>7월 아이스크림 총 주문량과 상반기의 아이스크림 총 주문량을 더한 값이
큰 순서대로 상위 3개의 맛을 조회하는 SQL 문을 작성해주세요.</p></blockquote><p>아이스크림 총주문량(<code>TOTAL_ORDER</code>)을 내림차순 정렬하여 상위 3개 항목만 조회하는 문제입니다.</p><p>구성이 동일한 <code>FIRST_HALF</code> 테이블과 <code>JULY</code> 테이블을 <code>UNION ALL</code> 결합하고
아이스크림 맛(<code>FLAVOR</code>) 그룹별로 아이스크림 총주문량(<code>TOTAL_ORDER</code>)을 SUM 집계합니다.</p><p>이때, 집계한 값을 출력할 필요는 없기 때문에 굳이 <code>SELECT</code> 하지는 않고 <code>ORDER BY</code> 구문에서
직접적으로 사용합니다. 집계한 값을 내림차순 정렬한 후 <code>LIMIT 3</code> 으로 상위 3개 항목만 조회합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>FLAVOR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>FIRST_HALF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>JULY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>TOTAL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FLAVOR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>TOTAL_ORDER</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>LIMIT</span><span class=w> </span><span class=mi>3</span></span></span></code></pre></div></div><h3 id=저자-별-카테고리-별-매출액-집계하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/144856 target=_blank rel="noopener noreferrer">저자 별 카테고리 별 매출액 집계하기</a>
<a class=anchor href=#%ec%a0%80%ec%9e%90-%eb%b3%84-%ec%b9%b4%ed%85%8c%ea%b3%a0%eb%a6%ac-%eb%b3%84-%eb%a7%a4%ec%b6%9c%ec%95%a1-%ec%a7%91%ea%b3%84%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>BOOK</code> 테이블은 각 도서의 정보를 담은 테이블입니다.
<code>AUTHOR</code> 테이블은 도서의 저자의 정보를 담은 테이블입니다.
<code>BOOK_SALES</code> 테이블은 각 도서의 날짜 별 판매량 정보를 담은 테이블입니다.</p><p><code>2022년 1월</code>의 도서 판매 데이터를 기준으로 저자 별, 카테고리 별
매출액(<code>TOTAL_SALES = 판매량 * 판매가</code>) 을 구하여, 저자 ID(<code>AUTHOR_ID</code>),
저자명(<code>AUTHOR_NAME</code>), 카테고리(<code>CATEGORY</code>), 매출액(<code>SALES</code>) 리스트를 출력하는 SQL문을 작성해주세요.
결과는 저자 ID를 오름차순으로, 저자 ID가 같다면 카테고리를 내림차순 정렬해주세요.</p></blockquote><p>세 개의 테이블을 결합하고 제시된 그룹별 매출액을 계산하는 문제입니다.</p><p><code>BOOK_SALES</code> 테이블에서 <code>BOOK_ID</code>, <code>AUTHOR_ID</code> 를 기준으로 각각 <code>BOOK</code>, <code>AUTHOR</code>
테이블과 <code>INNER JOIN</code> 합니다. <code>BOOK_SALES</code> 테이블의 판매량(<code>SALES</code>)과 <code>BOOK</code> 테이블의
판매가(<code>PRICE</code>)를 곱한 매출액을 SUM 집계하여 총매출액(<code>TOTAL_SALES</code>)을 계산합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>BK</span><span class=p>.</span><span class=n>AUTHOR_ID</span><span class=p>,</span><span class=w> </span><span class=n>AU</span><span class=p>.</span><span class=n>AUTHOR_NAME</span><span class=p>,</span><span class=w> </span><span class=n>BK</span><span class=p>.</span><span class=n>CATEGORY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SUM</span><span class=p>(</span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>BK</span><span class=p>.</span><span class=n>PRICE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>TOTAL_SALES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>BOOK_SALES</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SALES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>BOOK</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>BK</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>BOOK_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BK</span><span class=p>.</span><span class=n>BOOK_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>AUTHOR</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>AU</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>BK</span><span class=p>.</span><span class=n>AUTHOR_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>AU</span><span class=p>.</span><span class=n>AUTHOR_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>SALES</span><span class=p>.</span><span class=n>SALES_DATE</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2022-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2022-01-31&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>AUTHOR_ID</span><span class=p>,</span><span class=w> </span><span class=n>AUTHOR_NAME</span><span class=p>,</span><span class=w> </span><span class=n>CATEGORY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>AUTHOR_ID</span><span class=p>,</span><span class=w> </span><span class=n>CATEGORY</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span></span></span></code></pre></div></div><h2 id=자동차-대여-테이블>자동차 대여 테이블
<a class=anchor href=#%ec%9e%90%eb%8f%99%ec%b0%a8-%eb%8c%80%ec%97%ac-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=자동차-대여-기록-별-대여-금액-구하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/151141 target=_blank rel="noopener noreferrer">자동차 대여 기록 별 대여 금액 구하기</a>
<a class=anchor href=#%ec%9e%90%eb%8f%99%ec%b0%a8-%eb%8c%80%ec%97%ac-%ea%b8%b0%eb%a1%9d-%eb%b3%84-%eb%8c%80%ec%97%ac-%ea%b8%88%ec%95%a1-%ea%b5%ac%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>CAR_RENTAL_COMPANY_CAR</code> 테이블은 대여 중인 자동차들의 정보를 담은 테이블입니다.
<code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블은 자동차 대여 기록 정보를 담은 테이블입니다.
<code>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</code> 테이블은 자동차 종류 별 대여 기간 종류 별 할인 정책 정보를 담은 테이블 입니다.</p><p><code>CAR_RENTAL_COMPANY_CAR</code> 테이블과 <code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블과
<code>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</code> 테이블에서 자동차 종류가 '트럭'인 자동차의 대여 기록에 대해서
대여 기록 별로 대여 금액(컬럼명: <code>FEE</code>)을 구하여 대여 기록 ID와 대여 금액 리스트를 출력하는 SQL문을 작성해주세요.
결과는 대여 금액을 기준으로 내림차순 정렬하고, 대여 금액이 같은 경우 대여 기록 ID를 기준으로 내림차순 정렬해주세요.</p></blockquote><p>세 개의 테이블을 결합하는데, 우선 대여 시작일(<code>START_DATE</code>)과 대여 종료일(<code>END_DATE</code>) 기간에 대한
날짜수를 기준으로 할인율 적용 기준을 분류합니다. 할인율 적용 기준을 통해 할인율(<code>DISCOUNT_RATE</code>)
수치를 도출하여 대여 금액(<code>FEE</code>)에 할인 적용을 하는 문제입니다.</p><p>일수(<code>DAYS</code>)를 계산하는 방법으로 <code>DATEDIFF</code> 함수를 사용합니다. 시작일과 종료일도 기간에 포함되기 때문에
함수의 결과에 <code>+1</code> 을 더합니다. 일수(<code>DAYS</code>)에 대해 CASE 조건문을 통해 대여 기간 종류(<code>DURATION_TYPE</code>)에
해당하는 4가지 분류로 구분합니다. 대여 기간 종류(<code>DURATION_TYPE</code>)는 그대로 <code>LEFT JOIN</code> 의 기준으로써,
<code>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</code> 테이블로부터 할인율(<code>DISCOUNT_RATE</code>)을 도출하는데 사용됩니다.</p><p>대여 금액(<code>FEE</code>)은 일일 대여 요금(<code>DAILY_FEE</code>)에 앞에서 구한 일수(<code>DAYS</code>)와
할인율(<code>DISCOUNT_RATE</code>)을 곱한 결과입니다. 이때, 정수 타입인 할인율(<code>DISCOUNT_RATE</code>)은
그대로 사용하지 않고, <code>1.0 - (할인율 / 100)</code> 계산식에 넣어 배율로 변환합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>HISTORY</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>DATEDIFF</span><span class=p>(</span><span class=n>END_DATE</span><span class=p>,</span><span class=w> </span><span class=n>START_DATE</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DAYS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>CAR_RENTAL_COMPANY_RENTAL_HISTORY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>HIST</span><span class=p>.</span><span class=n>HISTORY_ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>CAR</span><span class=p>.</span><span class=n>DAILY_FEE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>HIST</span><span class=p>.</span><span class=n>DAYS</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>IFNULL</span><span class=p>(</span><span class=n>DIS</span><span class=p>.</span><span class=n>DISCOUNT_RATE</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>100</span><span class=p>)))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FEE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>HISTORY</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HIST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>CAR_RENTAL_COMPANY_CAR</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>CAR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>HIST</span><span class=p>.</span><span class=n>CAR_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DIS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>DIS</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>AND</span><span class=w> </span><span class=n>DIS</span><span class=p>.</span><span class=n>DURATION_TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>HIST</span><span class=p>.</span><span class=n>DAYS</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;90일 이상&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>HIST</span><span class=p>.</span><span class=n>DAYS</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;30일 이상&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>HIST</span><span class=p>.</span><span class=n>DAYS</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;7일 이상&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;7일 미만&#39;</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;트럭&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FEE</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>HISTORY_ID</span><span class=w> </span><span class=k>DESC</span></span></span></code></pre></div></div><h3 id=특정-기간동안-대여-가능한-자동차들의-대여비용-구하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/157339 target=_blank rel="noopener noreferrer">특정 기간동안 대여 가능한 자동차들의 대여비용 구하기</a>
<a class=anchor href=#%ed%8a%b9%ec%a0%95-%ea%b8%b0%ea%b0%84%eb%8f%99%ec%95%88-%eb%8c%80%ec%97%ac-%ea%b0%80%eb%8a%a5%ed%95%9c-%ec%9e%90%eb%8f%99%ec%b0%a8%eb%93%a4%ec%9d%98-%eb%8c%80%ec%97%ac%eb%b9%84%ec%9a%a9-%ea%b5%ac%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>CAR_RENTAL_COMPANY_CAR</code> 테이블은 대여 중인 자동차들의 정보를 담은 테이블입니다.
<code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블은 자동차 대여 기록 정보를 담은 테이블입니다.
<code>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</code> 테이블은 자동차 종류 별 대여 기간 종류 별 할인 정책 정보를 담은 테이블 입니다.</p><p><code>CAR_RENTAL_COMPANY_CAR</code> 테이블과 <code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블과
<code>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</code> 테이블에서 자동차 종류가 '세단' 또는 'SUV' 인 자동차 중
2022년 11월 1일부터 2022년 11월 30일까지 대여 가능하고 30일간의 대여 금액이 50만원 이상 200만원 미만인
자동차에 대해서 자동차 ID, 자동차 종류, 대여 금액(컬럼명: <code>FEE</code>) 리스트를 출력하는 SQL문을 작성해주세요.
결과는 대여 금액을 기준으로 내림차순 정렬하고, 대여 금액이 같은 경우 자동차 종류를 기준으로 오름차순 정렬,
자동차 종류까지 같은 경우 자동차 ID를 기준으로 내림차순 정렬해주세요.</p></blockquote><p>앞선 문제와 테이블 및 대여 금액(<code>FEE</code>) 계산 방법이 동일한데, 세부적인 조건이 늘어났습니다.</p><p>첫 번째 조건인 자동차 종류를 선택하는 것은 <code>CAR_RENTAL_COMPANY_CAR</code> 테이블에서
WHERE 절을 통해 자동차 종류(<code>CAR_TYPE</code>)가 '세단' 또는 'SUV'인 것만 선택하면 됩니다.</p><p>두 번째 조건인 2022년 11월 1일부터 2022년 11월 30일까지 대여 가능한 경우는
<code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블에서 대여 시작일(<code>START_DATE</code>)과 대여 종료일(<code>END_DATE</code>)이
해당 기간에 걸치는 경우를 파악하고 대상 자동차 ID(<code>CAR_ID</code>)를 WHERE 절의 AND 조건으로 추가해 제외합니다.</p><p>세 번째 조건은 대여 금액(<code>FEE</code>)을 계산한 후, WHERE 절을 통해 50만원 이상 200만원 미만인 경우를 선택합니다.
<code>FEE >= (50 * 10000) AND FEE &lt; (200 * 10000)</code> 조건을 적용할 수도 있지만,
상대적으로 길이가 짧은 <code>BETWEEN</code> 절로 표현했습니다. 대여 금액(<code>FEE</code>)은 소수점까지 떨어지지는
않기 때문에 <code>-1</code> 하여 미만(<code>&lt;</code>)과 동일하게 표현할 수 있습니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>HISTORY</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>DATEDIFF</span><span class=p>(</span><span class=n>END_DATE</span><span class=p>,</span><span class=w> </span><span class=n>START_DATE</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DAYS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>CAR_RENTAL_COMPANY_RENTAL_HISTORY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>DISCOUNT_PLAN</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>CAR_TYPE</span><span class=p>,</span><span class=w> </span><span class=n>DURATION_TYPE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>DISCOUNT_RATE</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>100</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DISCOUNT_RATE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>CAR_RENTAL_COMPANY_DISCOUNT_PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>CAR_IN_USE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>CAR_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>HISTORY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>START_DATE</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2022-11-30&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>END_DATE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2022-11-01&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>CAR</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_ID</span><span class=p>,</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>ROUND</span><span class=p>(</span><span class=n>CAR</span><span class=p>.</span><span class=n>DAILY_FEE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>IFNULL</span><span class=p>(</span><span class=n>DIS</span><span class=p>.</span><span class=n>DISCOUNT_RATE</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FEE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>CAR_RENTAL_COMPANY_CAR</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>CAR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>DISCOUNT_PLAN</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DIS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DIS</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>AND</span><span class=w> </span><span class=n>DIS</span><span class=p>.</span><span class=n>DURATION_TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;30일 이상&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_TYPE</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;세단&#39;</span><span class=p>,</span><span class=s1>&#39;SUV&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>CAR</span><span class=p>.</span><span class=n>CAR_ID</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>CAR_ID</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>CAR_IN_USE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>CAR_ID</span><span class=p>,</span><span class=w> </span><span class=n>CAR_TYPE</span><span class=p>,</span><span class=w> </span><span class=n>FEE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>CAR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>FEE</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=p>(</span><span class=mi>50</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>10000</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=mi>200</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>10000</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FEE</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>CAR_TYPE</span><span class=w> </span><span class=k>ASC</span><span class=p>,</span><span class=w> </span><span class=n>CAR_ID</span><span class=w> </span><span class=k>DESC</span></span></span></code></pre></div></div><h2 id=개발자-스킬-테이블>개발자 스킬 테이블
<a class=anchor href=#%ea%b0%9c%eb%b0%9c%ec%9e%90-%ec%8a%a4%ed%82%ac-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=frontend-개발자-찾기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/276035 target=_blank rel="noopener noreferrer">FrontEnd 개발자 찾기</a>
<a class=anchor href=#frontend-%ea%b0%9c%eb%b0%9c%ec%9e%90-%ec%b0%be%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>SKILLCODES</code> 테이블은 개발자들이 사용하는 프로그래밍 언어에 대한 정보를 담은 테이블입니다.
<code>DEVELOPERS</code> 테이블은 개발자들의 프로그래밍 스킬 정보를 담은 테이블입니다.</p><p><code>DEVELOPERS</code> 테이블에서 Front End 스킬을 가진 개발자의 정보를 조회하려 합니다.
조건에 맞는 개발자의 ID, 이메일, 이름, 성을 조회하는 SQL 문을 작성해 주세요.
결과는 ID를 기준으로 오름차순 정렬해 주세요.</p></blockquote><p>두 개의 테이블에서 정수 타입인 스킬 코드 열을 비트 연산하여 공통된 경우를 <code>JOIN</code> 하는 문제입니다.</p><p><code>SKILLCODES</code> 테이블에서 스킬의 범주(<code>CATEGORY</code>)가 'Front End'에 해당하는 항목만 선택합니다.
해당 테이블의 스킬의 코드(<code>CODE</code>)는 2진수로 표현했을 때 각 비트마다 하나의 스킬에 대응됩니다.</p><p><code>DEVELOPERS</code> 테이블에도 마찬가지로 개발자에 대한 스킬 코드(<code>SKILL_CODE</code>)가 있습니다.
두 개 테이블의 스킬 코드를 <code>&</code> 연산자를 활용해 비트 연산하면 공통된 비트만 얻을 수 있습니다.
이것이 <code>SKILLCODES</code> 테이블의 스킬의 코드(<code>CODE</code>)와 같다면 해당 스킬을 보유하고 있다고 판단할 수 있습니다.</p><p>'Front End' 스킬을 가진 개발자의 ID(<code>ID</code>)만 따로 추출하고,
<code>DEVELOPERS</code> 테이블에서 해당 <code>ID</code> 에 해당하는 항목들만 선택하여 조회합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>TARGET</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>DEV</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>DEVELOPERS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DEV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>SKILLCODES</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SKL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=p>(</span><span class=n>DEV</span><span class=p>.</span><span class=n>SKILL_CODE</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>CODE</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>CODE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>CATEGORY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Front End&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>ID</span><span class=p>,</span><span class=w> </span><span class=n>EMAIL</span><span class=p>,</span><span class=w> </span><span class=n>FIRST_NAME</span><span class=p>,</span><span class=w> </span><span class=n>LAST_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>DEVELOPERS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>ID</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>ID</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>TARGET</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ID</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=언어별-개발자-분류하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/276036 target=_blank rel="noopener noreferrer">언어별 개발자 분류하기</a>
<a class=anchor href=#%ec%96%b8%ec%96%b4%eb%b3%84-%ea%b0%9c%eb%b0%9c%ec%9e%90-%eb%b6%84%eb%a5%98%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>SKILLCODES</code> 테이블은 개발자들이 사용하는 프로그래밍 언어에 대한 정보를 담은 테이블입니다.
<code>DEVELOPERS</code> 테이블은 개발자들의 프로그래밍 스킬 정보를 담은 테이블입니다.</p><p><code>DEVELOPERS</code> 테이블에서 GRADE별 개발자의 정보를 조회하려 합니다. GRADE는 다음과 같이 정해집니다.</p><ul><li>A : Front End 스킬과 Python 스킬을 함께 가지고 있는 개발자</li><li>B : C# 스킬을 가진 개발자</li><li>C : 그 외의 Front End 개발자</li></ul><p>GRADE가 존재하는 개발자의 GRADE, ID, EMAIL을 조회하는 SQL 문을 작성해 주세요.
결과는 GRADE와 ID를 기준으로 오름차순 정렬해 주세요.</p></blockquote><p>앞선 문제와, 테이블 및 스킬 코드를 비트 연산하여 개발자가 스킬을 가졌는지 판단하는 방법이 동일한데,
세부적인 조건이 늘어났습니다.</p><p>CASE 조건문을 통해 'A', 'B', 'C' 세 가지 등급으로 개발자를 나누는데,
CASE 안에서 직접적으로 조건을 표현하면 길어질 수도 있습니다.
또한, 'Front End' 스킬을 보유한 경우에 대해서는 'A', 'C' 두 가지 등급에서 참조하기 때문에 중복 선언도 피하고 싶습니다.</p><p>따라서, 원하는 스킬을 보유한 경우를 <code>HAS_SKILLS</code> 라는 임시 테이블로 구성하고,
해당 테이블을 <code>DEVELOPERS</code> 테이블에 <code>INNER JOIN</code> 하여 미리 계산한 조건에 대한
Boolean 값을 CASE 안에서 가져다 사용합니다. 조건에 해당되지 않는 나머지 개발자에 대한 등급은
<code>NULL</code> 로 분류하고, 등급이 <code>NULL</code> 인 경우만 제외하여 조회합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>HAS_SKILLS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>DEV</span><span class=p>.</span><span class=n>ID</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=k>SUM</span><span class=p>(</span><span class=n>SKL</span><span class=p>.</span><span class=n>CATEGORY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Front End&#39;</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HAS_FRONT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=k>SUM</span><span class=p>(</span><span class=n>SKL</span><span class=p>.</span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Python&#39;</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HAS_PYTHON</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=k>SUM</span><span class=p>(</span><span class=n>SKL</span><span class=p>.</span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;C#&#39;</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>HAS_CSHARP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>DEVELOPERS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DEV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>SKILLCODES</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SKL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=p>(</span><span class=n>DEV</span><span class=p>.</span><span class=n>SKILL_CODE</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>CODE</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>CODE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>WITH_GRADE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>HAS_FRONT</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>HAS_PYTHON</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;A&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>WHEN</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>HAS_CSHARP</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;B&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>WHEN</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>HAS_FRONT</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;C&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>GRADE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>DEV</span><span class=p>.</span><span class=n>ID</span><span class=p>,</span><span class=w> </span><span class=n>DEV</span><span class=p>.</span><span class=n>EMAIL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>DEVELOPERS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DEV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>HAS_SKILLS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SKL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ON</span><span class=w> </span><span class=n>DEV</span><span class=p>.</span><span class=n>ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SKL</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>WITH_GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>GRADE</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>GRADE</span><span class=p>,</span><span class=w> </span><span class=n>ID</span><span class=p>;</span></span></span></code></pre></div></div><h2 id=인사-테이블>인사 테이블
<a class=anchor href=#%ec%9d%b8%ec%82%ac-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=연간-평가점수에-해당하는-평가-등급-및-성과금-조회하기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/284528 target=_blank rel="noopener noreferrer">연간 평가점수에 해당하는 평가 등급 및 성과금 조회하기</a>
<a class=anchor href=#%ec%97%b0%ea%b0%84-%ed%8f%89%ea%b0%80%ec%a0%90%ec%88%98%ec%97%90-%ed%95%b4%eb%8b%b9%ed%95%98%eb%8a%94-%ed%8f%89%ea%b0%80-%eb%93%b1%ea%b8%89-%eb%b0%8f-%ec%84%b1%ea%b3%bc%ea%b8%88-%ec%a1%b0%ed%9a%8c%ed%95%98%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>HR_DEPARTMENT</code> 테이블은 회사의 부서 정보를 담은 테이블입니다.
<code>HR_EMPLOYEES</code> 테이블은 회사의 사원 정보를 담은 테이블입니다.
<code>HR_GRADE</code> 테이블은 2022년 사원의 평가 정보를 담은 테이블입니다.</p><p><code>HR_DEPARTMENT</code>, <code>HR_EMPLOYEES</code>, <code>HR_GRADE</code> 테이블을 이용해 사원별 성과금 정보를 조회하려합니다.
평가 점수별 등급과 등급에 따른 성과금 정보가 아래와 같을 때, 사번, 성명, 평가 등급, 성과금을 조회하는 SQL문을 작성해주세요.</p><p>평가등급의 컬럼명은 <code>GRADE</code> 로, 성과금의 컬럼명은 <code>BONUS</code> 로 해주세요.
결과는 사번 기준으로 오름차순 정렬해주세요.</p></blockquote><p><code>HR_GRADE</code> 테이블의 평가 점수(<code>SCORE</code>)를 기준으로 평가등급(<code>GRADE</code>)과 성과금(<code>BONUS</code>)을 도출하는 문제입니다.</p><p>사원 평가는 반기마다 발생하는데 2022년 내에 두 차례 발생했기 때문에, 사번(<code>EMP_NO</code>) 그룹별로
평가 점수(<code>SCORE</code>)를 AVG 집계합니다. 평균 평가 점수(<code>AVG(SCORE)</code>)를
CASE 조건문에 넣어 평가등급(<code>GRADE</code>)과 성과금(<code>BONUS</code>)을 분류합니다.</p><p>분류한 성과금은 연봉에 대한 배율이기 때문에, 최종 답안을 낼 때는 <code>HR_EMPLOYEES</code> 테이블의
연봉(<code>SAL</code>)에 배율을 곱해서 실제 성과금(<code>BONUS</code>)을 계산합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>EMP_NO</span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>SCORE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SCORE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>HR_GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>EMP_NO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>GRADE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>EMP_NO</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>96</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;S&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;A&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>80</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;B&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;C&#39;</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>GRADE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>96</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>15</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>SCORE</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>80</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>BONUS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>SCORE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>EMP</span><span class=p>.</span><span class=n>EMP_NO</span><span class=p>,</span><span class=w> </span><span class=n>EMP</span><span class=p>.</span><span class=n>EMP_NAME</span><span class=p>,</span><span class=w> </span><span class=n>GRD</span><span class=p>.</span><span class=n>GRADE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>EMP</span><span class=p>.</span><span class=n>SAL</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>GRD</span><span class=p>.</span><span class=n>BONUS</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>BONUS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>HR_EMPLOYEES</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>EMP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>GRADE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>GRD</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>EMP</span><span class=p>.</span><span class=n>EMP_NO</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>GRD</span><span class=p>.</span><span class=n>EMP_NO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>EMP_NO</span></span></span></code></pre></div></div><h2 id=대장균-개체-테이블>대장균 개체 테이블
<a class=anchor href=#%eb%8c%80%ec%9e%a5%ea%b7%a0-%ea%b0%9c%ec%b2%b4-%ed%85%8c%ec%9d%b4%eb%b8%94>#</a></h2><h3 id=특정-세대의-대장균-찾기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/301650 target=_blank rel="noopener noreferrer">특정 세대의 대장균 찾기</a>
<a class=anchor href=#%ed%8a%b9%ec%a0%95-%ec%84%b8%eb%8c%80%ec%9d%98-%eb%8c%80%ec%9e%a5%ea%b7%a0-%ec%b0%be%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>ECOLI_DATA</code> 테이블은 실험실에서 배양한 대장균들의 정보를 담은 테이블입니다.</p><p>3세대의 대장균의 ID(<code>ID</code>) 를 출력하는 SQL 문을 작성해주세요. 이때 결과는 대장균의 ID 에 대해 오름차순 정렬해주세요.</p></blockquote><p>세대별로 <code>JOIN</code> 연산을 중첩해서 사용하여 3세대 대장균의 ID(<code>ID</code>)를 도출하는 문제입니다.</p><p>1세대 대장균(<code>GEN1</code>)은 부모 개체의 ID(<code>PARENT_ID</code>)가 <code>NULL</code> 인 경우입니다.</p><p>2세대 대장균(<code>GEN2</code>)은 1세대(<code>GEN1</code>) 대장균 개체의 ID(<code>ID</code>)가 부모 개체의
ID(<code>PARENT_ID</code>)인 경우입니다. 두 항목을 <code>INNER JOIN</code> 하여 공통된 경우만 2세대로 판단합니다.</p><p>3세대 대장균은 2세대 대장균(<code>GEN2</code>)을 구한 것과 동일한 방식으로 <code>INNER JOIN</code> 연산합니다. 해당하는 3세대 대장균의 ID(<code>ID</code>)를 출력합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>GEN1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ECOLI_DATA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>PARENT_ID</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>GEN2</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>ECOLI</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ECOLI_DATA</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ECOLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>GEN1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PARENT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>ECOLI</span><span class=p>.</span><span class=n>PARENT_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PARENT</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>ECOLI</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>ECOLI_DATA</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ECOLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>GEN2</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PARENT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>ECOLI</span><span class=p>.</span><span class=n>PARENT_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PARENT</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ID</span><span class=p>;</span></span></span></code></pre></div></div><h3 id=멸종위기의-대장균-찾기><a href=https://school.programmers.co.kr/learn/courses/30/lessons/301651 target=_blank rel="noopener noreferrer">멸종위기의 대장균 찾기</a>
<a class=anchor href=#%eb%a9%b8%ec%a2%85%ec%9c%84%ea%b8%b0%ec%9d%98-%eb%8c%80%ec%9e%a5%ea%b7%a0-%ec%b0%be%ea%b8%b0>#</a></h3><blockquote class=sc-hint><p><code>ECOLI_DATA</code> 테이블은 실험실에서 배양한 대장균들의 정보를 담은 테이블입니다.</p><p>각 세대별 자식이 없는 개체의 수(<code>COUNT</code>)와 세대(<code>GENERATION</code>)를 출력하는 SQL문을 작성해주세요.
이때 결과는 세대에 대해 오름차순 정렬해주세요. 단, 모든 세대에는 자식이 없는 개체가 적어도 1개체는 존재합니다.</p></blockquote><p>재귀 쿼리를 사용해 이전 세대의 대장균 ID(<code>ID</code>)와 <code>ECOLI_DATA</code> 테이블의 부모 개체 ID(<code>PARENT_ID</code>)가
동일한 경우를 반복해서 탐색합니다. 다음 세대가 없을 때까지 조회한 모든 결과를 결합하고,
대장균의 ID(<code>ID</code>)가 어떠한 부모 개체의 ID(<code>PARENT_ID</code>)에도 포함되지 않는 경우만 선택하여,
세대(<code>GENERATION</code>)별 개체의 수(<code>COUNT</code>)를 집계하는 문제입니다.</p><p>앞선 문제처럼 n세대까지 <code>JOIN</code> 연산을 중첩하려다가 도저히 아닌 것 같아서 찾아봤는데,
재귀 쿼리를 사용하여 해결할 수 있는 문제였습니다. 평소에 재귀 쿼리를 사용해보지 않아
<code>GEN_DATA</code> 를 도출하는 과정은 검색 결과를 참고했습니다.</p><p><code>GEN_DATA</code> 에서 자식이 없는 개체만 선택하고 <code>GENERATION</code> 그룹별로 COUNT 집계한 결과를 조회합니다.</p><div class=sc-codeblock data-lang=sql><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">sql</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>GEN_DATA</span><span class=w> </span><span class=k>AS</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>ID</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>GENERATION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ECOLI_DATA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>PARENT_ID</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>ECOLI</span><span class=p>.</span><span class=n>ID</span><span class=p>,</span><span class=w> </span><span class=n>PARENT</span><span class=p>.</span><span class=n>GENERATION</span><span class=o>+</span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>GENERATION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>ECOLI_DATA</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ECOLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>GEN_DATA</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PARENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>ECOLI</span><span class=p>.</span><span class=n>PARENT_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PARENT</span><span class=p>.</span><span class=n>ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>PARENT</span><span class=p>.</span><span class=n>GENERATION</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>COUNT</span><span class=p>,</span><span class=w> </span><span class=n>PARENT</span><span class=p>.</span><span class=n>GENERATION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>GEN_DATA</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PARENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>PARENT</span><span class=p>.</span><span class=n>ID</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>PARENT_ID</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>ECOLI_DATA</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>PARENT_ID</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>GENERATION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>GENERATION</span><span class=p>;</span></span></span></code></pre></div></div></article><footer class=site-footer><div class=tags-wrap><a href="/search/?tags=%ed%94%84%eb%a1%9c%ea%b7%b8%eb%9e%98%eb%a8%b8%ec%8a%a4" class=tag>#프로그래머스</a>
<a href="/search/?tags=%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98" class=tag>#알고리즘</a>
<a href="/search/?tags=%ec%bd%94%eb%94%a9%ed%85%8c%ec%8a%a4%ed%8a%b8" class=tag>#코딩테스트</a>
<a href="/search/?tags=SQL" class=tag>#SQL</a>
<a href="/search/?tags=JOIN" class=tag>#JOIN</a>
<a href="/search/?tags=GROUP%20BY" class=tag>#GROUP BY</a>
<a href="/search/?tags=SELECT" class=tag>#SELECT</a>
<a href="/search/?tags=%ed%94%84%eb%a1%9c%ea%b7%b8%eb%9e%98%eb%a8%b8%ec%8a%a4%20Lv4" class=tag>#프로그래머스 Lv4</a>
<a href="/search/?tags=%ed%94%84%eb%a1%9c%ea%b7%b8%eb%9e%98%eb%a8%b8%ec%8a%a4%20Lv5" class=tag>#프로그래머스 Lv5</a>
<a href="/search/?tags=%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%20%eb%ac%b8%ec%a0%9c%ed%92%80%ec%9d%b4" class=tag>#알고리즘 문제풀이</a></div><div class=prev-next-wrap><a href=/blog/big-o-list/ class=prev-link><span class=prev-next-label><i class="fa-solid fa-backward"></i>
<span data-i18n-id=post.prev.link data-i18n-text>이전</span>
</span><span class=prev-next-title>Big-O 시간복잡도 정리 | List, Set, Dictionary, Sort, Search</span>
</a><a href=/blog/spark-study-5/ class=next-link><span class=prev-next-label><span data-i18n-id=post.next.link data-i18n-text>다음</span>
<i class="fa-solid fa-forward"></i>
</span><span class=prev-next-title>Apache Spark - 스파크 SQL과 테이블/뷰 관리</span></a></div><div class=comments-wrap><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://minyeamer.github.io/blog/programmers-sql-4-5/",this.page.identifier="https://minyeamer.github.io/blog/programmers-sql-4-5/"};window.relocateDisqus=()=>{let e=0;const t=20,n=setInterval(()=>{e++;const s=document.getElementById(atob(atob("WkdsemNYVnpYM1JvY21WaFpBPT0=")));var o=!1;if(s){const e=s.querySelector(atob(atob("VzNOeVl5bzlKMkZrY3lkZA==")));e&&(s.appendChild(e),o=!0)}(o||e>t)&&clearInterval(n)},1e3)},function(){var e=document,t=e.createElement("script");t.src="https://minyeamer.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}(),window.relocateDisqus();function reloadDisqus(){window.DISQUS&&(DISQUS.reset({reload:!0,config:function(){this.page.url="https://minyeamer.github.io/blog/programmers-sql-4-5/",this.page.identifier="https://minyeamer.github.io/blog/programmers-sql-4-5/"}}),window.relocateDisqus())}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class="copyright-wrap flex justify-center"><small>Minystory - <a href=https://creativecommons.org/licenses/by/4.0/legalcode target=_blank rel="noopener noreferrer">© CC BY 4.0</a></small></div></footer><label for=menu-control class="hidden site-menu-overlay"></label></div><aside class=site-toc aria-label=목차 data-i18n-id=toc.aside.tooltip data-i18n-attrs=aira-label><div class=toc-content><nav id=TableOfContents><ul><li><a href=#모든-문제>모든 문제</a></li><li><a href=#동물-입양-테이블>동물 입양 테이블</a><ul><li><a href=#보호소에서-중성화한-동물>보호소에서 중성화한 동물</a></li><li><a href=#입양-시각-구하기2>입양 시각 구하기(2)</a></li></ul></li><li><a href=#식품-테이블>식품 테이블</a><ul><li><a href=#우유와-요거트가-담긴-장바구니>우유와 요거트가 담긴 장바구니</a></li><li><a href=#식품분류별-가장-비싼-식품의-정보-조회하기>식품분류별 가장 비싼 식품의 정보 조회하기</a></li><li><a href=#5월-식품들의-총매출-조회하기>5월 식품들의 총매출 조회하기</a></li></ul></li><li><a href=#식당-테이블>식당 테이블</a><ul><li><a href=#서울에-위치한-식당-목록-출력하기>서울에 위치한 식당 목록 출력하기</a></li><li><a href=#그룹별-조건에-맞는-식당-목록-출력하기>그룹별 조건에 맞는 식당 목록 출력하기</a></li></ul></li><li><a href=#쇼핑몰-테이블>쇼핑몰 테이블</a><ul><li><a href=#년-월-성별-별-상품-구매-회원-수-구하기>년, 월, 성별 별 상품 구매 회원 수 구하기</a></li><li><a href=#상품을-구매한-회원-비율-구하기>상품을 구매한 회원 비율 구하기</a></li><li><a href=#오프라인온라인-판매-데이터-통합하기>오프라인/온라인 판매 데이터 통합하기</a></li></ul></li><li><a href=#진료-테이블>진료 테이블</a><ul><li><a href=#취소되지-않은-진료-예약-조회하기>취소되지 않은 진료 예약 조회하기</a></li></ul></li><li><a href=#판매-테이블>판매 테이블</a><ul><li><a href=#주문량이-많은-아이스크림들-조회하기>주문량이 많은 아이스크림들 조회하기</a></li><li><a href=#저자-별-카테고리-별-매출액-집계하기>저자 별 카테고리 별 매출액 집계하기</a></li></ul></li><li><a href=#자동차-대여-테이블>자동차 대여 테이블</a><ul><li><a href=#자동차-대여-기록-별-대여-금액-구하기>자동차 대여 기록 별 대여 금액 구하기</a></li><li><a href=#특정-기간동안-대여-가능한-자동차들의-대여비용-구하기>특정 기간동안 대여 가능한 자동차들의 대여비용 구하기</a></li></ul></li><li><a href=#개발자-스킬-테이블>개발자 스킬 테이블</a><ul><li><a href=#frontend-개발자-찾기>FrontEnd 개발자 찾기</a></li><li><a href=#언어별-개발자-분류하기>언어별 개발자 분류하기</a></li></ul></li><li><a href=#인사-테이블>인사 테이블</a><ul><li><a href=#연간-평가점수에-해당하는-평가-등급-및-성과금-조회하기>연간 평가점수에 해당하는 평가 등급 및 성과금 조회하기</a></li></ul></li><li><a href=#대장균-개체-테이블>대장균 개체 테이블</a><ul><li><a href=#특정-세대의-대장균-찾기>특정 세대의 대장균 찾기</a></li><li><a href=#멸종위기의-대장균-찾기>멸종위기의 대장균 찾기</a></li></ul></li></ul></nav></div><div class=hidden id=toc-config data-start=2 data-end=3></div></aside><div class=site-toolbar role=toolbar aria-label="툴바'" data-i18n-id=toolbar.wrap.tooltip data-i18n-attrs=aira-label><input type=checkbox id=toolbar-toggle class="hidden toggle"><div class=toolbar-items><div class="toolbar-button i18n-button"><i class="fa-solid fa-globe"></i>
<select class=i18n-selector id=i18n-selector aria-label="i18n `toolbar.i18n.tooltip` | default `Select language`" title="i18n `toolbar.i18n.tooltip` | default `Select language`" data-i18n-id=toolbar.i18n.tooltip data-i18n-attrs=aria-label,title><option value=ko>한국어</option><option value=en>English</option><option value=ja>日本語</option><option value=zh>中文</option><option value=es>Español</option><option value=fr>Français</option><option value=de>Deutsch</option><option value=it>Italiano</option><option value=pt>Português</option><option value=ru>Русский</option><option value=am>አማርኛ</option><option value=bg>Български</option><option value=bn>বাংলা</option><option value=cn>简体中文</option><option value=cs>Čeština</option><option value=fa>فارسی</option><option value=he>עברית</option><option value=nb>Norsk</option><option value=nl>Nederlands</option><option value=oc>Occitan</option><option value=pl>Polski</option><option value=pt-BR>Português (BR)</option><option value=sv>Svenska</option><option value=sw>Kiswahili</option><option value=tr>Türkçe</option><option value=uk>Українська</option><option value=zh-TW>繁體中文</option></select></div><button class=toolbar-button onclick='window.scrollTo({top:0,behavior:"smooth"})' aria-label="i18n `toolbar.top.tooltip` | default `Go to top`" title="i18n `toolbar.top.tooltip` | default `Go to top`" data-i18n-id=toolbar.top.tooltip data-i18n-attrs=aria-label,title>
<i class="fa fa-chevron-up"></i>
</button>
<button class=toolbar-button onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' aria-label="i18n `toolbar.bottom.tooltip` | default `Go to bottom`" title="i18n `toolbar.bottom.tooltip` | default `Go to bottom`" data-i18n-id=toolbar.bottom.tooltip data-i18n-attrs=aria-label,title>
<i class="fa fa-chevron-down"></i>
</button>
<button class=toolbar-button onclick=history.back() aria-label="i18n `toolbar.back.tooltip` | default `Go back`" title="i18n `toolbar.back.tooltip` | default `Go back`" data-i18n-id=toolbar.back.tooltip data-i18n-attrs=aria-label,title>
<i class="fa-solid fa-arrow-left"></i></button></div><label for=toolbar-toggle class="toolbar-button toolbar-toggle-label"><i class="fa-solid fa-plus icon-expand"></i>
<i class="fa-solid fa-xmark icon-collapse"></i></label></div></main></body></html>