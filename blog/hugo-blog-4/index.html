<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><meta name=author content><meta name=keywords content="Hugo,Fusejs,검색 인덱스,검색 페이지,Hugo 검색,휴고 테마,EventListener,window,DocumentFragment,JavaScript,Blog,Hugo Book"><meta name=description content="Hugo Book 테마에서 Fuse.js 기반 검색 인덱스를 분석하고 검색 UI를 개선하는 과정을 소개합니다. 검색 페이지를 구현하면서 검색 성능을 최적화하고 템플릿 일관성을 보장 …"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><link rel=icon href=https://minyeamer.github.io/images/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://minyeamer.github.io/images/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://minyeamer.github.io/images/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><link rel=mask-icon href=https://minyeamer.github.io/images/favicons/apple-touch-icon.png><meta name=google-site-verification content="u1tWcHmHUZWfFT1cHaku6sqU-bK40N3WLR-C-4VUWN0"><meta name=naver-site-verification content="6eaf8e9da1a6104780f056f1a7797fe5a3a5a0da"><meta property="og:title" content="Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기"><meta property="og:description" content="Hugo Book 테마에서 Fuse.js 기반 검색 인덱스를 분석하고 검색 UI를 개선하는 과정을 소개합니다. 검색 페이지를 구현하면서 검색 성능을 최적화하고 템플릿 일관성을 보장 …"><meta property="og:type" content="article"><meta property="og:url" content="https://minyeamer.github.io/blog/hugo-blog-4/"><meta property="og:image" content="https://dl.dropboxusercontent.com/scl/fi/hp31764bfpm55wanzj5le/hugo-00-logo.webp?rlkey=rkezagmfupugt717a5fx2xqs2&amp;raw=1"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-14T12:40:13+09:00"><meta property="article:modified_time" content="2025-12-14T12:40:13+09:00"><meta property="og:see_also" content="https://minyeamer.github.io/blog/hugo-blog-5/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/hugo-blog-3/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/hugo-blog-2/"><meta property="og:see_also" content="https://minyeamer.github.io/blog/hugo-blog-1/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dl.dropboxusercontent.com/scl/fi/hp31764bfpm55wanzj5le/hugo-00-logo.webp?rlkey=rkezagmfupugt717a5fx2xqs2&amp;raw=1"><meta name=twitter:title content="Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기"><meta name=twitter:description content="Hugo Book 테마에서 Fuse.js 기반 검색 인덱스를 분석하고 검색 UI를 개선하는 과정을 소개합니다. 검색 페이지를 구현하면서 검색 성능을 최적화하고 템플릿 일관성을 보장 …"><meta name=twitter:site content="@https://x.com/minyeamer"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minyeamer.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기","item":"https://minyeamer.github.io/blog/hugo-blog-4/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기","name":"Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기","description":"Hugo Book 테마에서 Fuse.js 기반 검색 인덱스를 분석하고 검색 UI를 개선하는 과정을 소개합니다. 검색 페이지를 구현하면서 검색 성능을 최적화하고 템플릿 일관성을 보장하기 위한 방식을 알아봅니다.\n","keywords":["Hugo, Fusejs, 검색 인덱스, 검색 페이지, Hugo 검색, 휴고 테마, EventListener, window, DocumentFragment, JavaScript, Blog, Hugo Book"],"articleBody":" Hugo 블로그 만들기 1. Hugo 블로그 만들기 - Git Submodule로 구성하고 배포하기 2. Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선 3. Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현 4. Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기 5. Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터) 숨기기 목록 보기 4/5 AI 요약 \u0026 가이드\nHugo Book 테마의 검색 기능을 완전히 해부하고, Fuse.js 기반 인덱싱부터 검색 페이지 구현까지 실전 노하우를 공유합니다. 검색창 UI 개선, window 전역 객체를 활용한 모듈 분리, DocumentFragment 를 통한 DOM 조작 최적화까지 단계별로 안내합니다.\n검색 구조 분석: 템플릿 → 자바스크립트 → 검색 코퍼스로 이어지는 Book 테마 검색 흐름 완벽 분석 검색창 UI/UX 개선: 아이콘 추가, 결과 위치 고정, 더보기 링크로 사용자 편의성 극대화 파일 구조 최적화: window 전역 객체로 검색 데이터 및 초기화 함수를 공유하는 효율적인 JS 파일 구조 설계 검색 페이지 완성: 템플릿 일관성을 지키며 DocumentFragment 로 검색 결과를 효율적으로 렌더링 앞선 게시글에서 Book 테마의 태그와 카테고리 페이지를 구성하기 위한 Taxonomies 기능에 대해 알아보았습니다.\n앞에서의 과정을 거쳤다면 태그와 카테고리 페이지가 블로그에 추가되고, 여기서 공통적으로 사용되는 게시글 항목 및 페이지네이션 템플릿을 만들었을 것입니다.\n이번 게시글에서는 Hugo Book 테마에서 구현된 검색 프로세스를 분석하고 실제로 검색 페이지를 구현하면서 검색 성능을 최적화하고 템플릿 일관성을 보장하기 위한 방식을 알아보겠습니다.\nBook 테마 검색 프로세스 분석 #Hugo는 기본적으로 내장된 검색 기능을 지원하지 않습니다. 하지만, 아래 공식문서에 따르면 Pagefind, Lunr.js, Fuse.js 등의 오픈소스 검색 기능을 지원합니다.\nSearch tools See some of the open-source and commercial search options for your newly created Hugo website. gohugo.io 이런 기능에 익숙하지 않은 저와 같은 사람이 직접 문서를 찾아가며 검색 기능을 도입하려 했다면 꽤나 머리 아프고 오랜 시간이 걸렸을 수 있지만, 다행히 Book 테마는 검색 기능을 지원해줘서 중간중간 로그를 찍어보면서 검색 과정을 이해할 수 있었습니다.\n검색 템플릿 분석 #Book 테마의 검색창은 book-menu 영역에 있으므로 우선 layouts/_partials/docs/menu.html 템플릿을 찾아봤습니다.\nCopy html \u003cnav\u003e {{ partial \"docs/brand\" . }} {{ partial \"docs/search\" . }} \u003c/nav\u003edocs/brand 는 메인 레이아웃을 커스터마이징할 때 프로필 사진이나 소셜 링크를 구현했던 템플릿입니다. 검색창은 바로 밑에 있으므로, 그리고 템플릿 명칭 자체가 직관적으로 \"검색\"을 가리키므로 layouts/_partials/docs/search.html 템플릿의 내용을 확인해보았습니다.\nCopy html {{ if default true .Site.Params.BookSearch }} \u003cdiv class=\"book-search hidden\"\u003e \u003cinput id=\"book-search-input\" type=\"text\" placeholder=\"{{ i18n \"Search\" }}\" aria-label=\"{{ i18n \"Search\" }}\" maxlength=\"64\" data-hotkeys=\"s/\" /\u003e \u003cdiv class=\"book-search-spinner hidden\"\u003e\u003c/div\u003e \u003cul id=\"book-search-results\"\u003e\u003c/ul\u003e \u003c/div\u003e \u003cscript\u003edocument.querySelector(\".book-search\").classList.remove(\"hidden\")\u003c/script\u003e {{ end }}docs/search 템플릿의 내용 자체는 input 요소 하나만 있고 특별한건 없습니다. 설정 내 파라미터(params) 아래서 BookSearch 값을 할당하여 검색창을 활성화/비활성화할 수 있다는 것 정도만 알 수 있습니다.\n자바스크립트 분석 #그렇다면 검색 기능을 자바스크립트로 구현되어 있을 것이므로 템플릿과 별개의 assets/ 경로를 탐색하여 search.js 라는 직관적인 이름의 파일을 발견했습니다.\n파일이 한 페이지에 들어오지 않아 부분적으로 나눠서 알아보겠습니다.\nCopy js // assets/search.js 'use strict'; {{ $searchDataFile := printf \"%s.search-data.json\" .Language.Lang }} {{ $searchData := resources.Get \"search-data.json\" | resources.ExecuteAsTemplate $searchDataFile . | resources.Minify | resources.Fingerprint }} {{ $searchConfig := i18n \"bookSearchConfig\" | default \"{}\" }} (function () { const searchDataURL = '{{ partial \"docs/links/resource-precache\" $searchData }}'; // ... })();먼저, 스크립트의 시작 부분에는 $searchData 변수에 할당된 파일을 가져와 읽어오고 있습니다. 이 변수를 console.log() 에 넣어보면 /search-data.json 값이 출력됩니다.\n검색 코퍼스 분석 #아마 자바스크립트 파일과 동일한 경로에 있는 search-data.json 파일을 가리키는 것 같아서 내용을 확인해보았습니다.\nCopy json [ {{- $pages := where .Site.Pages \"Kind\" \"in\" (slice \"page\" \"section\") -}} {{- $pages = where $pages \"Params.bookSearchExclude\" \"!=\" true -}} {{/* Remove until we know why it does not work, see https://github.com/alex-shpak/hugo-book/issues/528 */}} {{/*- $pages = where $pages \"Content\" \"not in\" (slice nil \"\") -*/}} {{- $pages = where $pages \"Content\" \"!=\" \"\" -}} {{ range $index, $page := $pages }} {{ if gt $index 0}},{{end}} { \"id\": {{ $index }}, \"href\": \"{{ $page.RelPermalink }}\", \"title\": {{ (partial \"docs/title\" $page) | jsonify }}, \"section\": {{ (partial \"docs/title\" $page.Parent) | default $.Site.Title | jsonify }}, \"content\": {{ $page.Plain | jsonify }} } {{- end -}} ]익숙한 Go 템플릿을 사용하여 모든 페이지에 대해 id, href, title, section, content 로 구성된 객체의 배열을 만들어내는 것 같습니다. 이는 일종의 검색 인덱스라고 볼 수 있을 것 같은데, 게시글의 내용 전문을 포함하고 있어서 검색 코퍼스라고 부르는게 적절할지도 모르겠습니다.\n이하 내용에서 search-data.json 의 내용을 검색 코퍼스 라 부르겠습니다.\nHugo로 만들어지는 웹사이트는 정적 페이지로만 구성되므로, 검색 인덱스도 아마 public/ 경로를 찾아보면 관련된 파일이 있을 것입니다. 역시나 직관적으로 알 수 있는 JSON 파일 하나가 public 경로 아래에 있습니다.\nCopy bash public % tree -L 1 . ├── ... ├── en.search-data.min.eab6c7b9001273416ee00669c84e2e15e0c20a277354e60f930fbf616c3450cd.json ├── ...만약 Hugo 빌드를 여러 번 했다면 (동시에 이전 빌드에서 만들어진 파일을 지우지 않았다면) search-data.json 파일이 여러 개 만들어졌을건데, 어떤 파일을 봐야할지 모르겠다면 위 자바스크립트에서 searchDataURL 변수를 출력해보면 알 수 있습니다. (searchDataURL 변수를 선언하는 라인 아래에 console.log() 를 실행하면 빌드 직후에 콘솔에 출력됩니다.)\npublic/ 경로에서 보았던 en.search-data.min.eab6c7b9001273416ee00669c84e2e15e0c20a277354e60f930fbf616c3450cd.json 파일이 그대로 출력되었습니다.\n파일명이 왜 이렇게 되었는가는, 우선 $searchData 변수를 할당하는 라인에서 resources.Minify 기능으로 파일을 축소하면서 뒤에 .min 이 붙고, resources.Fingerprint 기능으로 파일명에 해시까지 추가되면서 이런 명칭으로 변환된 것입니다.\n브라우저에서 이 파일의 경로로 접속하면 아래와 같은 내용을 볼 수 있습니다.\n","wordCount":"4563","inLanguage":"ko","image":"https:\/\/dl.dropboxusercontent.com\/scl\/fi\/hp31764bfpm55wanzj5le\/hugo-00-logo.webp?rlkey=rkezagmfupugt717a5fx2xqs2\u0026raw=1","datePublished":"2025-12-14T12:40:13+09:00","dateModified":"2025-12-14T12:40:13+09:00","author":{"@type":"Person","name":"minyeamer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minyeamer.github.io/blog/hugo-blog-4/"},"publisher":{"@type":"Person","name":"Minystory","logo":{"@type":"ImageObject","url":"https://minyeamer.github.io/images/favicons/favicon.ico"}}}</script><script>(function(){const e=256+768*1.3;window.innerWidth>e&&localStorage.getItem("menu-expanded")==="false"&&document.documentElement.classList.add("menu-initial-collapsed")})()</script><title>Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기</title><link rel=icon href=/images/favicon.ico><link rel=manifest href=/data/manifest.json><link rel=canonical href=https://minyeamer.github.io/blog/hugo-blog-4/><link rel=stylesheet href=/main.min.5cef15459c75888e1b1985caa72c3b3683ebe3aad0d82d5eebb539a840899be7.css integrity="sha256-XO8VRZx1iI4bGYXKpyw7NoPr46rQ2C1e67U5qECJm+c=" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ8Z9RMBPJ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BJ8Z9RMBPJ")</script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css crossorigin=anonymous><script>(function(){const e=console.warn;console.warn=function(...n){const t=(new Error).stack||"";if(t.includes("highlight.min.js")||t.includes("highlightjs-line-numbers"))return;e.apply(console,n)}})()</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js crossorigin=anonymous></script><script>window.siteI18n=window.siteI18n||{},window.siteI18n.defaultLang="en"</script><script>window.siteI18n.dataUrl="/data/i18n.min.a69d97976d04e681499d74d71f0019de3d6ed9f29a55bc606a9459d1454b3b65.json"</script><script>window.siteI18n.initData=function(){return window.siteI18n.data?Promise.resolve(window.siteI18n.data):fetch(window.siteI18n.dataUrl).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(window.siteI18n.data=e,window.siteI18n.data))},window.siteI18n.getLanguage=function(e={}){const s="site-language",t=localStorage.getItem(s);if(t)return t;const n=(navigator.language||navigator.userLanguage).split("-")[0];return!e||e[n]?n:window.siteI18n.defaultLang},window.siteI18n.translate=function(e,t=""){if(window.siteI18n.data){const n=window.siteI18n.getLanguage(),t=window.siteI18n.data[n];if(t&&e in t)return t[e]}return t},void window.siteI18n.initData().catch(()=>{})</script><script defer src=/js/core/i18n.min.c076e5ad51c454cca138121312827bfde8c5526a930ce57cea2207f501fea0d7.js integrity="sha256-wHblrVHEVMyhOBITEoJ7/ejFUmqTDOV86iIH9QH+oNc=" crossorigin=anonymous></script><script defer src=/js/partials/scroll-progress.min.841ade7e507a5f6d59c4e7bf2fe2b2ca034070677ff7957eec55610a024dd776.js integrity="sha256-hBreflB6X21ZxOe/L+KyygNAcGd/95V+7FVhCgJN13Y=" crossorigin=anonymous></script><script defer src=/js/partials/menu-toggle.min.7ee0f34ad37a564fe94803318b77c9128244ae7747bf68a99f5c639cd14ee1bc.js integrity="sha256-fuDzStN6Vk/pSAMxi3fJEoJErndHv2ipn1xjnNFO4bw=" crossorigin=anonymous></script><script defer src=/js/partials/toc-toggle.min.245e40eb40fe121e595f13897569556fa17b72530600a710a00a5d636dbf140d.js integrity="sha256-JF5A60D+Eh5ZXxOJdWlVb6F7clMGAKcQoApdY22/FA0=" crossorigin=anonymous></script><script defer src=/js/core/set-theme.min.986446861d7c48b101b4a6f53724b7fc97d6efec2a87906c6630cb9e503897c4.js integrity="sha256-mGRGhh18SLEBtKb1NyS3/JfW7+wqh5BsZjDLnlA4l8Q=" crossorigin=anonymous></script><script defer src=/js/shortcodes/copy-code.min.e18ffc44cf6beb1757c467945bb2897b0e1cb2ee52f08b460ee3ee57f0db6d60.js integrity="sha256-4Y/8RM9r6xdXxGeUW7KJew4csu5S8ItGDuPuV/DbbWA=" crossorigin=anonymous></script><script defer src=/js/partials/toc-highlight.min.7917ead4ecb7378779bfbf3f988251ac76bd55ca7f12fd5919870777dbcd6095.js integrity="sha256-eRfq1Oy3N4d5v78/mIJRrHa9Vcp/Ev1ZGYcHd9vNYJU=" crossorigin=anonymous></script><script defer src=/js/partials/reading-time.min.9dae1dd14e75a79711e28a5864bf1fe636869815c32110f680ff8e1d61bfdf28.js integrity="sha256-na4d0U51p5cR4opYZL8f5jaGmBXDIRD2gP+OHWG/3yg=" crossorigin=anonymous></script><script defer src=/js/shortcodes/image-zoom.min.bb446c50cbec91f1b4fdfbb9f695d753ef4811f43de0a9411201c8466ffe204a.js integrity="sha256-u0RsUMvskfG0/fu59pXXU+9IEfQ94KlBEgHIRm/+IEo=" crossorigin=anonymous></script><script defer src=/js/shortcodes/data-table.min.d20aaf7f506ee989f91746098231f979e58b8435513de0d4f05eefb9c45743e7.js integrity="sha256-0gqvf1Bu6Yn5F0YJgjH5eeWLhDVRPeDU8F7vucRXQ+c=" crossorigin=anonymous></script><script>window.siteSearch=window.siteSearch||{}</script><script>window.siteSearch.contentUrl="/data/content.min.0d9c35258206161520526aeccdea6826417931b6c7dda3db171fe4099b3a26f1.json"</script><script>window.siteSearch.categoriesUrl="/data/categories.min.a110e9708cdf79e3dc8d271224586cc9deffc0232514190c37e24dc74470851c.json"</script><script>window.siteSearch.tagsUrl="/data/tags.min.d80e1fb9a5142d159b8e7e3b9adea10216e811adf810f15fbe9bd79b2b6c83d8.json"</script><script defer src=/fuse.min.js></script><script defer src=/js/search/init.min.ee793e2de351fef268c6642567b4af23bd3763c2cb74f767e7240807e394417d.js integrity="sha256-7nk+LeNR/vJoxmQlZ7SvI703Y8LLdPdn5yQIB+OUQX0=" crossorigin=anonymous></script><script defer src=/js/search/input.min.d9380107ad7925e0b0ba621d64e1648e8119523b6f8cff46cdf240117921a06b.js integrity="sha256-2TgBB615JeCwumIdZOFkjoEZUjtvjP9GzfJAEXkhoGs=" crossorigin=anonymous></script><script defer src=/js/search/list.min.19c27643078f3be0fb15443fbb4903ffe3234c85373d568e3de7478ac45b16e5.js integrity="sha256-GcJ2QwePO+D7FUQ/u0kD/+MjTIU3PVaOPedHisRbFuU=" crossorigin=anonymous></script></head><body class="site-kind-page site-type-posts site-layout-post" dir=ltr><div class=scroll-progress><div class=scroll-progress-bar></div></div><label class=image-overlay-wrap for=image-overlay-toggle><input class="hidden toggle" type=checkbox id=image-overlay-toggle><div class=image-overlay></div></label><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=menu-overlay></div><main class=container><aside class=site-menu aria-label=메뉴 data-i18n-id=menu.aside.tooltip data-i18n-attrs=aira-label><div class=menu-content><nav><div class=menu-profile><div class=profile-image-wrap><a href=https://minyeamer.github.io/><img src=/images/profile/menu.jpg alt=Profile class=profile-image decoding=async></a></div><h2 class=profile-title><a class="flex align-center" href=https://minyeamer.github.io/><span>Minystory</span></a></h2></div><div class=menu-links><a href=https://github.com/minyeamer target=_blank id=github-link title=GitHub><i class="fa-brands fa-github"></i>
</a><a href=/categories/ id=categories-link title=Categories><i class="fa-solid fa-folder"></i>
</a><a href=/tags/ id=tags-link title=Tags><i class="fa-solid fa-tags"></i>
</a><button class=dark-mode-toggle id=theme-toggle-button aria-label="Toggle color scheme">
<i class="fa-solid fa-circle-half-stroke"></i></button></div><div class=menu-search id=search-input data-hotkeys=s/ role=button tabindex=0 aria-label=검색 data-i18n-id=search.action.label data-i18n-attrs=aira-label><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=search-placeholder data-i18n-id=search.input.label data-i18n-text='{"`/`": "$code"}'><code>/</code> 를 눌러 검색하세요</span></div><div class=menu-categories><input type=checkbox class="hidden toggle" id=categories-control checked>
<label for=categories-control class="categories-label categories-toggle"><a href=/categories/ class=categories-root><i class="fa-solid fa-folder"></i>
<span data-i18n-id=categories.root.label data-i18n-text>전체
</span><span class=category-count>(41)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li><input type=checkbox class="hidden toggle" id=cat-algorithm>
<label for=cat-algorithm class="categories-label categories-toggle"><a href="/search/?category1=Algorithm"><i class="fa-solid fa-folder"></i>Algorithm<span class=category-count>(4)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Algorithm&category2=Graph"><i class="fa-solid fa-file"></i>Graph<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=Python"><i class="fa-solid fa-file"></i>Python<span class=category-count>(2)</span></a></li><li class=categories-label><a href="/search/?category1=Algorithm&category2=SQL"><i class="fa-solid fa-file"></i>SQL<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-cloud>
<label for=cat-cloud class="categories-label categories-toggle"><a href="/search/?category1=Cloud"><i class="fa-solid fa-folder"></i>Cloud<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Cloud&category2=Kubernetes"><i class="fa-solid fa-file"></i>Kubernetes<span class=category-count>(2)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-analysis>
<label for=cat-data-analysis class="categories-label categories-toggle"><a href="/search/?category1=Data%20Analysis"><i class="fa-solid fa-folder"></i>Data Analysis<span class=category-count>(3)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Analysis&category2=Dacon"><i class="fa-solid fa-file"></i>Dacon<span class=category-count>(3)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-data-engineering>
<label for=cat-data-engineering class="categories-label categories-toggle"><a href="/search/?category1=Data%20Engineering"><i class="fa-solid fa-folder"></i>Data Engineering<span class=category-count>(19)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Airflow"><i class="fa-solid fa-file"></i>Apache Airflow<span class=category-count>(7)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Apache%20Spark"><i class="fa-solid fa-file"></i>Apache Spark<span class=category-count>(8)</span></a></li><li class=categories-label><a href="/search/?category1=Data%20Engineering&category2=Crawling"><i class="fa-solid fa-file"></i>Crawling<span class=category-count>(4)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-frontend>
<label for=cat-frontend class="categories-label categories-toggle"><a href="/search/?category1=Frontend"><i class="fa-solid fa-folder"></i>Frontend<span class=category-count>(10)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Frontend&category2=Blog"><i class="fa-solid fa-file"></i>Blog<span class=category-count>(10)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-linux>
<label for=cat-linux class="categories-label categories-toggle"><a href="/search/?category1=Linux"><i class="fa-solid fa-folder"></i>Linux<span class=category-count>(1)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Linux&category2=Ubuntu"><i class="fa-solid fa-file"></i>Ubuntu<span class=category-count>(1)</span></a></li></ul></li><li><input type=checkbox class="hidden toggle" id=cat-project>
<label for=cat-project class="categories-label categories-toggle"><a href="/search/?category1=Project"><i class="fa-solid fa-folder"></i>Project<span class=category-count>(2)</span>
</a><i class="fa-solid fa-chevron-down categories-arrow"></i></label><ul><li class=categories-label><a href="/search/?category1=Project&category2=Open%20Source"><i class="fa-solid fa-file"></i>Open Source<span class=category-count>(1)</span></a></li><li class=categories-label><a href="/search/?category1=Project&category2=Tools"><i class="fa-solid fa-file"></i>Tools<span class=category-count>(1)</span></a></li></ul></li></ul></div><div class=recent-posts><div class=recent-post-label><i class="fa-solid fa-clock"></i>
<span data-i18n-id=menu.recent.posts data-i18n-text>최신글</span></div><ul class=recent-post-list><li class=recent-post-item><a href=/blog/hugo-seotax-1/ title="Hugo 서택스(SeoTax) 테마 제작기 - 동적 렌더링으로 확장된 검색"><div class=recent-post-title>Hugo 서택스(SeoTax) 테마 제작기 - 동적 렌더링으로 확장된 검색</div><div class=recent-post-date><time datetime=2026-01-25>2026.01.25</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-5/ title="Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)"><div class=recent-post-title>Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)</div><div class=recent-post-date><time datetime=2025-12-15>2025.12.15</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-4/ title="Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기"><div class=recent-post-title>Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기</div><div class=recent-post-date><time datetime=2025-12-14>2025.12.14</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-3/ title="Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현"><div class=recent-post-title>Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현</div><div class=recent-post-date><time datetime=2025-11-22>2025.11.22</time></div></a></li><li class=recent-post-item><a href=/blog/hugo-blog-2/ title="Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선"><div class=recent-post-title>Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선</div><div class=recent-post-date><time datetime=2025-11-04>2025.11.04</time></div></a></li></ul></div></nav><script>(function(){var e=document.querySelector("aside .menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=main-wrap><header class=site-header><div class="flex align-center justify-between"><label for=menu-control aria-label="메뉴 접기/펼치기" title="메뉴 접기/펼치기" data-i18n-id=menu.toggle.tooltip data-i18n-attrs=aria-label,title><i class="fa-solid fa-bars menu-icon" id=menu-icon></i></label><div class=mobile-search id=mobile-search-input role=button tabindex=0 aria-label=검색 data-i18n-id=search.action.label data-i18n-attrs=aria-label><i class="fa-solid fa-magnifying-glass search-icon"></i>
<span class=mobile-title>Minystory</span>
<i class=mobile-title-pad></i></div><label for=toc-control aria-label="목차 접기/펼치기" title="목차 접기/펼치기" data-i18n-id=toc.toggle.tooltip data-i18n-attrs=aria-label,title><i class="fa-solid fa-list menu-icon" id=toc-icon></i></label></div></header><article class="content-wrap markdown" id=content-wrap><header class=content-header><div class=content-category><a href="/search/?category1=Frontend&category2=Blog" class=content-category-link>Frontend/Blog</a></div><h1 class=content-title>Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기</h1><div class=content-datetime><time datetime=2025-12-14T12:40:13+09:00>2025. 12. 14. 12:40
</time><span id=reading-time></span></div></header><div class=content-cover-wrap><img src="https://dl.dropboxusercontent.com/scl/fi/w0zho4wlgq6m8db5mvn9k/hugo-00-cover.webp?rlkey=et2tlzgb0h6blgf8klzbqjxem&amp;raw=1" class=content-cover alt="Cover Image" decoding=async></div><div id=series-anchor></div><div class=sc-series><div class=series-bookmark><svg width="32" height="48" fill="currentColor" viewBox="0 0 32 48" class="series-corner-image"><path fill="currentColor" d="M32 0H0v48h.163l16-16L32 47.836V0z"/></svg></div><div class=series-header><h2 class=series-title>Hugo 블로그 만들기</h2></div><input type=checkbox id=series-toggle class=series-toggle-input hidden><div class=series-content><ol class=series-list><li class=series-item><span class=series-item-index>1.</span>
<a href=/blog/hugo-blog-1/#series-anchor>Hugo 블로그 만들기 - Git Submodule로 구성하고 배포하기</a></li><li class=series-item><span class=series-item-index>2.</span>
<a href=/blog/hugo-blog-2/#series-anchor>Hugo Book 테마 커스터마이징 - 메뉴/목차/헤더 레이아웃 개선</a></li><li class=series-item><span class=series-item-index>3.</span>
<a href=/blog/hugo-blog-3/#series-anchor>Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현</a></li><li class="series-item active"><span class=series-item-index>4.</span>
<a href=/blog/hugo-blog-4/#series-anchor>Hugo 검색 기능 구현 - Fuse.js로 검색 인덱스 최적화하기</a></li><li class=series-item><span class=series-item-index>5.</span>
<a href=/blog/hugo-blog-5/#series-anchor>Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)</a></li></ol></div><div class=series-footer><label for=series-toggle class=series-toggle-label><span class=series-toggle-icon><i class="fas fa-caret-up"></i></span>
<span class=series-toggle-text-hide data-i18n-id=series.hide.label data-i18n-text>숨기기</span>
<span class=series-toggle-text-show data-i18n-id=series.show.label data-i18n-text>목록 보기</span></label><div class=series-nav><span class=series-nav-info>4/5</span><div class=series-nav-buttons><a href=/blog/hugo-blog-3/#series-anchor class=series-nav-button><i class="fas fa-chevron-left"></i></a>
<a href=/blog/hugo-blog-5/#series-anchor class=series-nav-button><i class="fas fa-chevron-right"></i></a></div></div></div></div><script>(function(){const e=document.getElementById("series-toggle"),t="series-expanded",n=localStorage.getItem(t)??"true";n==="true"&&(e.checked=!0),e.addEventListener("change",function(){localStorage.setItem(t,this.checked)})})()</script><blockquote class="sc-hint info"><p><i class="fa-solid fa-wand-magic-sparkles"></i> <strong>AI 요약 & 가이드</strong></p><p>Hugo Book 테마의 <strong>검색 기능을 완전히 해부</strong>하고, Fuse.js 기반 인덱싱부터 검색 페이지 구현까지 실전 노하우를 공유합니다.
검색창 UI 개선, <code>window</code> 전역 객체를 활용한 모듈 분리, <code>DocumentFragment</code> 를 통한 DOM 조작 최적화까지 단계별로 안내합니다.</p><ul><li><strong><a href=#book-%ed%85%8c%eb%a7%88-%ea%b2%80%ec%83%89-%ed%94%84%eb%a1%9c%ec%84%b8%ec%8a%a4-%eb%b6%84%ec%84%9d>검색 구조 분석</a></strong>: 템플릿 → 자바스크립트 → 검색 코퍼스로 이어지는 Book 테마 검색 흐름 완벽 분석</li><li><strong><a href=#%ea%b2%80%ec%83%89-%ea%b8%b0%eb%8a%a5-%ea%b0%9c%ec%84%a0>검색창 UI/UX 개선</a></strong>: 아이콘 추가, 결과 위치 고정, 더보기 링크로 사용자 편의성 극대화</li><li><strong><a href=#%ea%b2%80%ec%83%89-%ea%b8%b0%eb%8a%a5-%ed%8c%8c%ec%9d%bc-%ea%b5%ac%ec%a1%b0-%ec%9e%ac%ec%84%a4%ea%b3%84>파일 구조 최적화</a></strong>: <code>window</code> 전역 객체로 검색 데이터 및 초기화 함수를 공유하는 효율적인 JS 파일 구조 설계</li><li><strong><a href=#%ea%b2%80%ec%83%89-%ec%88%98%ed%96%89-%eb%b0%8f-%ea%b2%b0%ea%b3%bc-%ed%95%84%ed%84%b0%eb%a7%81>검색 페이지 완성</a></strong>: 템플릿 일관성을 지키며 <code>DocumentFragment</code> 로 검색 결과를 효율적으로 렌더링</li></ul></blockquote><p><a href=/blog/hugo-blog-3/>앞선 게시글</a>에서 Book 테마의 태그와 카테고리 페이지를 구성하기 위한
Taxonomies 기능에 대해 알아보았습니다.</p><p>앞에서의 과정을 거쳤다면 태그와 카테고리 페이지가 블로그에 추가되고,
여기서 공통적으로 사용되는 게시글 항목 및 페이지네이션 템플릿을 만들었을 것입니다.</p><p>이번 게시글에서는 Hugo Book 테마에서 구현된 검색 프로세스를 분석하고
실제로 검색 페이지를 구현하면서 검색 성능을 최적화하고 템플릿 일관성을 보장하기 위한 방식을 알아보겠습니다.</p><hr><h2 id=book-테마-검색-프로세스-분석>Book 테마 검색 프로세스 분석
<a class=anchor href=#book-%ed%85%8c%eb%a7%88-%ea%b2%80%ec%83%89-%ed%94%84%eb%a1%9c%ec%84%b8%ec%8a%a4-%eb%b6%84%ec%84%9d>#</a></h2><p>Hugo는 기본적으로 내장된 검색 기능을 지원하지 않습니다.
하지만, 아래 공식문서에 따르면 <code>Pagefind</code>, <code>Lunr.js</code>, <code>Fuse.js</code> 등의
오픈소스 검색 기능을 지원합니다.</p><a href=https://gohugo.io/tools/search/ target=_blank class=sc-bookmark-card><div class=sc-bookmark-image><img src=https://gohugo.io/opengraph/gohugoio-card-base-1_hu_f914f06f97635a16.png alt="Search tools" loading=lazy decoding=async></div><div class=sc-bookmark-content><h3 class=sc-bookmark-title>Search tools</h3><p class=sc-bookmark-description>See some of the open-source and commercial search options for your newly created Hugo website.</p><small class=sc-bookmark-url>gohugo.io</small></div></a><p>이런 기능에 익숙하지 않은 저와 같은 사람이 직접 문서를 찾아가며 검색 기능을 도입하려 했다면
꽤나 머리 아프고 오랜 시간이 걸렸을 수 있지만,
다행히 Book 테마는 검색 기능을 지원해줘서 중간중간 로그를 찍어보면서 검색 과정을 이해할 수 있었습니다.</p><h3 id=검색-템플릿-분석>검색 템플릿 분석
<a class=anchor href=#%ea%b2%80%ec%83%89-%ed%85%9c%ed%94%8c%eb%a6%bf-%eb%b6%84%ec%84%9d>#</a></h3><p>Book 테마의 검색창은 <code>book-menu</code> 영역에 있으므로
우선 <code>layouts/_partials/docs/menu.html</code> 템플릿을 찾아봤습니다.</p><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/_partials/docs/menu.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{ partial &#34;docs/brand&#34; . }}
</span></span><span class=line><span class=cl>{{ partial &#34;docs/search&#34; . }}
</span></span><span class=line><span class=cl><span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>nav</span><span class=p>&gt;</span></span></span></code></pre></div></div><p><code>docs/brand</code> 는 <a href=/blog/hugo-blog-2/>메인 레이아웃을 커스터마이징</a>할 때
프로필 사진이나 소셜 링크를 구현했던 템플릿입니다.
검색창은 바로 밑에 있으므로, 그리고 템플릿 명칭 자체가 직관적으로 "검색"을 가리키므로
<code>layouts/_partials/docs/search.html</code> 템플릿의 내용을 확인해보았습니다.</p><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/_partials/docs/search.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{{ if default true .Site.Params.BookSearch }}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search hidden&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>input</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;book-search-input&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> 
</span></span><span class=line><span class=cl>    <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;{{ i18n &#34;</span><span class=na>Search</span><span class=err>&#34;</span> <span class=err>}}&#34;</span> <span class=na>aria-label</span><span class=o>=</span><span class=s>&#34;{{ i18n &#34;</span><span class=na>Search</span><span class=err>&#34;</span> <span class=err>}}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>maxlength</span><span class=o>=</span><span class=s>&#34;64&#34;</span> <span class=na>data-hotkeys</span><span class=o>=</span><span class=s>&#34;s/&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search-spinner hidden&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>ul</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;book-search-results&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;.book-search&#34;</span><span class=p>).</span><span class=nx>classList</span><span class=p>.</span><span class=nx>remove</span><span class=p>(</span><span class=s2>&#34;hidden&#34;</span><span class=p>)&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{ end }}</span></span></code></pre></div></div><p><code>docs/search</code> 템플릿의 내용 자체는 <code>input</code> 요소 하나만 있고 특별한건 없습니다.
설정 내 파라미터(<code>params</code>) 아래서 <code>BookSearch</code> 값을 할당하여
검색창을 활성화/비활성화할 수 있다는 것 정도만 알 수 있습니다.</p><h3 id=자바스크립트-분석>자바스크립트 분석
<a class=anchor href=#%ec%9e%90%eb%b0%94%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8-%eb%b6%84%ec%84%9d>#</a></h3><p>그렇다면 검색 기능을 자바스크립트로 구현되어 있을 것이므로 템플릿과 별개의
<code>assets/</code> 경로를 탐색하여 <code>search.js</code> 라는 직관적인 이름의 파일을 발견했습니다.</p><p>파일이 한 페이지에 들어오지 않아 부분적으로 나눠서 알아보겠습니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// assets/search.js
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>$searchDataFile</span> <span class=o>:=</span> <span class=nx>printf</span> <span class=s2>&#34;%s.search-data.json&#34;</span> <span class=p>.</span><span class=nx>Language</span><span class=p>.</span><span class=nx>Lang</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>$searchData</span> <span class=o>:=</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Get</span> <span class=s2>&#34;search-data.json&#34;</span> <span class=o>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>ExecuteAsTemplate</span> <span class=nx>$searchDataFile</span> <span class=p>.</span> <span class=o>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Minify</span> <span class=o>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Fingerprint</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>$searchConfig</span> <span class=o>:=</span> <span class=nx>i18n</span> <span class=s2>&#34;bookSearchConfig&#34;</span> <span class=o>|</span> <span class=k>default</span> <span class=s2>&#34;{}&#34;</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>searchDataURL</span> <span class=o>=</span> <span class=s1>&#39;{{ partial &#34;docs/links/resource-precache&#34; $searchData }}&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div><p>먼저, 스크립트의 시작 부분에는 <code>$searchData</code> 변수에 할당된 파일을 가져와 읽어오고 있습니다.
이 변수를 <code>console.log()</code> 에 넣어보면 <code>/search-data.json</code> 값이 출력됩니다.</p><h3 id=검색-코퍼스-분석>검색 코퍼스 분석
<a class=anchor href=#%ea%b2%80%ec%83%89-%ec%bd%94%ed%8d%bc%ec%8a%a4-%eb%b6%84%ec%84%9d>#</a></h3><p>아마 자바스크립트 파일과 동일한 경로에 있는 <code>search-data.json</code> 파일을 가리키는 것 같아서
내용을 확인해보았습니다.</p><div class=sc-codeblock data-lang=json><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">json</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>$pages</span> <span class=err>:=</span> <span class=err>where</span> <span class=err>.Site.Pages</span> <span class=nt>&#34;Kind&#34;</span> <span class=s2>&#34;in&#34;</span> <span class=err>(slice</span> <span class=s2>&#34;page&#34;</span> <span class=s2>&#34;section&#34;</span><span class=err>)</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>$pages</span> <span class=err>=</span> <span class=err>where</span> <span class=err>$pages</span> <span class=nt>&#34;Params.bookSearchExclude&#34;</span> <span class=s2>&#34;!=&#34;</span> <span class=kc>true</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{/*</span> <span class=err>Remove</span> <span class=err>until</span> <span class=err>we</span> <span class=err>know</span> <span class=err>why</span> <span class=err>it</span> <span class=err>does</span> <span class=err>not</span> <span class=err>work,</span> <span class=err>see</span> <span class=err>https:</span><span class=c1>//github.com/alex-shpak/hugo-book/issues/528 */}}
</span></span></span><span class=line><span class=cl><span class=err>{{/*-</span> <span class=err>$pages</span> <span class=err>=</span> <span class=err>where</span> <span class=err>$pages</span> <span class=nt>&#34;Content&#34;</span> <span class=s2>&#34;not in&#34;</span> <span class=err>(slice</span> <span class=err>nil</span> <span class=s2>&#34;&#34;</span><span class=err>)</span> <span class=err>-*/</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>$pages</span> <span class=err>=</span> <span class=err>where</span> <span class=err>$pages</span> <span class=nt>&#34;Content&#34;</span> <span class=s2>&#34;!=&#34;</span> <span class=s2>&#34;&#34;</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{</span> <span class=err>range</span> <span class=err>$index,</span> <span class=err>$page</span> <span class=err>:=</span> <span class=err>$pages</span> <span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{</span> <span class=err>if</span> <span class=err>gt</span> <span class=err>$index</span> <span class=err>0</span><span class=p>}</span><span class=err>}</span><span class=p>,{</span><span class=err>{end</span><span class=p>}</span><span class=err>}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>$index</span> <span class=p>}},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;href&#34;</span><span class=err>:</span> <span class=s2>&#34;{{ $page.RelPermalink }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;title&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(partial</span> <span class=nt>&#34;docs/title&#34;</span> <span class=err>$page)</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;section&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(partial</span> <span class=nt>&#34;docs/title&#34;</span> <span class=err>$page.Parent)</span> <span class=err>|</span> <span class=err>default</span> <span class=err>$.Site.Title</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;content&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>$page.Plain</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>end</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span></span></span></code></pre></div></div><p>익숙한 Go 템플릿을 사용하여 모든 페이지에 대해
<code>id</code>, <code>href</code>, <code>title</code>, <code>section</code>, <code>content</code> 로 구성된 객체의 배열을 만들어내는 것 같습니다.
이는 일종의 검색 인덱스라고 볼 수 있을 것 같은데, 게시글의 내용 전문을 포함하고 있어서
검색 코퍼스라고 부르는게 적절할지도 모르겠습니다.</p><blockquote class=sc-hint><p>이하 내용에서 <code>search-data.json</code> 의 내용을 <code>검색 코퍼스</code> 라 부르겠습니다.</p></blockquote><p>Hugo로 만들어지는 웹사이트는 정적 페이지로만 구성되므로,
검색 인덱스도 아마 <code>public/</code> 경로를 찾아보면 관련된 파일이 있을 것입니다.
역시나 직관적으로 알 수 있는 JSON 파일 하나가 <code>public</code> 경로 아래에 있습니다.</p><div class=sc-codeblock data-lang=bash><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">bash</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>public % tree -L <span class=m>1</span> 
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── ...
</span></span><span class=line><span class=cl>├── en.search-data.min.eab6c7b9001273416ee00669c84e2e15e0c20a277354e60f930fbf616c3450cd.json
</span></span><span class=line><span class=cl>├── ...</span></span></code></pre></div></div><p>만약 Hugo 빌드를 여러 번 했다면 (동시에 이전 빌드에서 만들어진 파일을 지우지 않았다면) <code>search-data.json</code> 파일이 여러 개
만들어졌을건데, 어떤 파일을 봐야할지 모르겠다면 위 자바스크립트에서 <code>searchDataURL</code> 변수를 출력해보면 알 수 있습니다.
(<code>searchDataURL</code> 변수를 선언하는 라인 아래에 <code>console.log()</code> 를 실행하면 빌드 직후에 콘솔에 출력됩니다.)</p><p><label class=md-image for=md-image-toggle-0><input class="hidden toggle" type=checkbox id=md-image-toggle-0>
<img src="https://dl.dropboxusercontent.com/scl/fi/sm2svkm72ba0mylhjxn4m/hugo-41-search-data-log.webp?rlkey=enpd7cb3550b5mrvdjnxdu21f&amp;raw=1" alt="/search-data.json | en.search-data.min.eab6c7b9001273416ee00669c84e2e15e0c20a277354e60f930fbf616c3450cd.json" loading=lazy decoding=async></label></p><p><code>public/</code> 경로에서 보았던 <code>en.search-data.min.eab6c7b9001273416ee00669c84e2e15e0c20a277354e60f930fbf616c3450cd.json</code>
파일이 그대로 출력되었습니다.</p><blockquote class=sc-hint><p>파일명이 왜 이렇게 되었는가는, 우선 <code>$searchData</code> 변수를 할당하는 라인에서
<code>resources.Minify</code> 기능으로 파일을 축소하면서 뒤에 <code>.min</code> 이 붙고,
<code>resources.Fingerprint</code> 기능으로 파일명에 해시까지 추가되면서
이런 명칭으로 변환된 것입니다.</p></blockquote><p>브라우저에서 이 파일의 경로로 접속하면 아래와 같은 내용을 볼 수 있습니다.</p><p><label class=md-image for=md-image-toggle-1><input class="hidden toggle" type=checkbox id=md-image-toggle-1>
<img src="https://dl.dropboxusercontent.com/scl/fi/6euzxfwdwi9xilagnp270/hugo-42-search-data-json.webp?rlkey=7qdw7qra5i2cs9m8mqg5gdmvv&amp;raw=1" alt='{"id": 0, "href": "/docs/example/", "title": "Example Site", "section": "Docs", "content": "Introduction..."}' loading=lazy decoding=async></label></p><p>이 파일은 ExampleSite 기준으로 100 KB,
현재 40개 글이 있는 제 블로그 기준으로는 600 KB 정도의 용량이 되는데
앞으로 게시글이 추가될 때마다 무식하게 커지는 이 파일을 검색할 때마다 가져온다고 생각하니
장기적인 관점에서 걱정이 됩니다.</p><p>아무튼, 이 파일만 봤을 때 자바스크립트의 이후 동작은 검색 코퍼스에서
입력 쿼리를 포함하는 페이지를 필터할 것이라 예상할 수 있습니다.</p><h3 id=이벤트-리스너-분석>이벤트 리스너 분석
<a class=anchor href=#%ec%9d%b4%eb%b2%a4%ed%8a%b8-%eb%a6%ac%ec%8a%a4%eb%84%88-%eb%b6%84%ec%84%9d>#</a></h3><p>구체적인 검색 과정을 확인하기 위해 자바스크립트의 내용을 이어서 보겠습니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>searchDataURL</span> <span class=o>=</span> <span class=s1>&#39;{{ partial &#34;docs/links/resource-precache&#34; $searchData }}&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>input</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#book-search-input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>results</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#book-search-results&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>input</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>init</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keyup&#39;</span><span class=p>,</span> <span class=nx>search</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keypress&#39;</span><span class=p>,</span> <span class=nx>focusSearchFieldOnKeyPress</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div><p>아래에는 함수들이 정의되어 있는데, 이벤트 리스너에 할당되는
<code>init</code>, <code>search</code>, <code>focusSearchFieldOnKeyPress</code> 가 각각 이 함수들입니다.</p><p><code>input</code> 요소인 검색창이 포커스되면 <code>init()</code> 함수가 실행되고, 입력을 마치면 <code>search()</code> 함수가 실행됩니다.</p><p><code>focusSearchFieldOnKeyPress()</code> 함수는 단축키가 눌렸는지 감시하는 함수인데,
<code>input#book-search-input</code> 요소의 <code>data-hotkeys</code> 속성에 지정된 단축키가 눌리면
바로 검색창에 포커스되는 기능을 합니다. (단축키는 <code>s</code>, <code>/</code> 가 지정되어 있습니다.)</p><h3 id=초기화-함수-분석>초기화 함수 분석
<a class=anchor href=#%ec%b4%88%ea%b8%b0%ed%99%94-%ed%95%a8%ec%88%98-%eb%b6%84%ec%84%9d>#</a></h3><p><code>init()</code> 함수는 검색창에 포커스될 때 실행됩니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>init</span><span class=p>);</span> <span class=c1>// init once
</span></span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>required</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fetch</span><span class=p>(</span><span class=nx>searchDataURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>pages</span> <span class=p>=&gt;</span> <span class=nx>pages</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>pages</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Fuse</span><span class=p>(</span><span class=nx>pages</span><span class=p>,</span> <span class=nx>indexConfig</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>input</span><span class=p>.</span><span class=nx>required</span> <span class=o>=</span> <span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>search</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div><p>함수의 첫줄부터 이벤트 리스너에서 제거합니다. 초기화 함수다보니 한 번만 실행하면 되는 것 같은데 내용을 이어서 보자면,
<code>searchDataURL</code> 경로, 즉 <code>search-data.json</code> 을 요청한다는 것을 알 수 있습니다.</p><p>그리고, 가져온 검색 코퍼스를 <code>Fuse(pages, indexConfig)</code> 함수에 전달해서
Fuse 인덱스를 생성하는 것을 보니 <code>Fuse.js</code> 를 사용한다는 것을 알 수 있습니다.
향후 검색 시에 Fuse 인덱스를 재사용하기 때문에 초기화 함수를 한 번만 실행하는 이유를 이해할 수 있습니다.</p><h3 id=검색-함수-분석>검색 함수 분석
<a class=anchor href=#%ea%b2%80%ec%83%89-%ed%95%a8%ec%88%98-%eb%b6%84%ec%84%9d>#</a></h3><p><code>search()</code> 함수는 키를 떼었을 때, 즉 문자를 하나하나 입력할 때마다 실행됩니다.<br>(검색 결과를 보기 위해 따로 엔터 키를 눌러야 할 필요는 없습니다.)</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>search</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=nx>results</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>removeChild</span><span class=p>(</span><span class=nx>results</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchHits</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>.</span><span class=nx>search</span><span class=p>(</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>).</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>searchHits</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>page</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>li</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li&gt;&lt;a href&gt;&lt;/a&gt;&lt;small&gt;&lt;/small&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>li</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>),</span> <span class=nx>small</span> <span class=o>=</span> <span class=nx>li</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;small&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>small</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>section</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>li</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div><p><code>Fuse.js</code> 의 내부 동작까지는 다룰 수는 없고, 이 함수의 동작만 보자면
기존 검색 결과인 <code>results</code> 를 초기화하고 검색 결과에서 최대 10개 페이지의 정보를
<code>li</code> 요소로 변환하여 다시 <code>results</code> 에 추가하는 동작을 합니다.</p><p><code>results</code> 의 내용은 즉시 <code>ul#book-search-results</code> 요소 내부에 표시됩니다.
해당 요소는 검색창 바로 아래 있어서 검색 결과가 검색창 아래에 (카테고리 목록을 아래로 밀어내고) 출력됩니다.</p><p><label class=md-image for=md-image-toggle-2><input class="hidden toggle" type=checkbox id=md-image-toggle-2>
<img src="https://dl.dropboxusercontent.com/scl/fi/0idnsek7m85h1e3c22q27/hugo-43-search-results.webp?rlkey=yac3gdsry1p95r5it9xjf2nyr&amp;raw=1" alt="Hugo 검색 > Getting Started with Hugo, ..." loading=lazy decoding=async></label></p><p>여기까지 봤다면 Book 테마에서 검색을 어떻게 구현했는지 이해할 수 있습니다.</p><h2 id=검색-기능-개선>검색 기능 개선
<a class=anchor href=#%ea%b2%80%ec%83%89-%ea%b8%b0%eb%8a%a5-%ea%b0%9c%ec%84%a0>#</a></h2><p>바로 위 이미지를 보자마자 개선해야 할 부분이 보였습니다.</p><h3 id=검색-아이콘-추가>검색 아이콘 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%ec%95%84%ec%9d%b4%ec%bd%98-%ec%b6%94%ea%b0%80>#</a></h3><p>가장 먼저 느낀 문제점은 검색창의 UI가 입력창 하나만 덩그러니 있어서
검색을 위한 입력창인지 다른 목적인지 직관적으로 이해하기 어렵다고 느꼈습니다.</p><p>그래서, 입력창 오른쪽에 검색 아이콘을 하나 추가하고자 합니다.</p><div class=sc-tabs><input type=radio class=toggle name=tabs-search-button id=tabs-search-button-0 checked>
<label for=tabs-search-button-0>HTML</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/_partials/docs/search.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search hidden&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;search-input-container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=err>...</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;book-search-button&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search-btn&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;goToSearchPage()&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>i</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;fa-solid fa-magnifying-glass&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>i</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span></span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-button id=tabs-search-button-1>
<label for=tabs-search-button-1>CSS</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=scss><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">scss</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=c1>// assets/_main.scss
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>.book-search</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=na>position</span><span class=o>:</span> <span class=ni>relative</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=na>margin</span><span class=o>:</span> <span class=nv>$padding-8</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nc>.search-input-container</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 입력창과 검색 아이콘을 가로로 나란히 나열
</span></span></span><span class=line><span class=cl>    <span class=na>position</span><span class=o>:</span> <span class=ni>relative</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>display</span><span class=o>:</span> <span class=ni>flex</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>align-items</span><span class=o>:</span> <span class=ni>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nt>input</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>width</span><span class=o>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>padding</span><span class=o>:</span> <span class=nv>$padding-8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>margin</span><span class=o>:</span> <span class=mi>0</span> <span class=nv>$padding-8</span> <span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 검색 아이콘과 간격 두기
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 입력창에 테두리 적용
</span></span></span><span class=line><span class=cl>    <span class=na>border</span><span class=o>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=ni>solid</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=no>gray</span><span class=o>-</span><span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=na>border-radius</span><span class=o>:</span> <span class=nv>$border-radius</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=na>background</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=no>gray</span><span class=o>-</span><span class=mi>300</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=na>color</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>body-font-color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>&amp;</span><span class=nd>:required</span> <span class=o>+</span> <span class=nc>.book-search-spinner</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>display</span><span class=o>:</span> <span class=ni>block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nc>.book-search-btn</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 검색 아이콘에 대한 스타일을 적용
</span></span></span><span class=line><span class=cl>    <span class=na>background</span><span class=o>:</span> <span class=ni>transparent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>border</span><span class=o>:</span> <span class=ni>none</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>color</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>body-font-color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=na>cursor</span><span class=o>:</span> <span class=ni>pointer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>&amp;</span><span class=nd>:hover</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>color</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=ni>color</span><span class=o>-</span><span class=n>link</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>i</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>font-size</span><span class=o>:</span> <span class=nv>$font-size-24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div><p>정확히는 검색 버튼의 역할이지만, 아직 검색 페이지 및 리다이렉트 기능을 구현하지는 않았으므로
검색 아이콘이라고 부르겠습니다.</p><p><label class=md-image for=md-image-toggle-3><input class="hidden toggle" type=checkbox id=md-image-toggle-3>
<img src="https://dl.dropboxusercontent.com/scl/fi/ex7a0jo1tl2g9o97awx8p/hugo-44-search-icon.webp?rlkey=u8pwtm314swdts5chgxobypen&amp;raw=1" alt="검색창 오른쪽에 검색 아이콘 추가" loading=lazy decoding=async></label></p><p>아직 검색 아이콘에 특별한 기능은 없지만,
입력창이 검색 기능을 한다는 것은 직관적으로 인식하게 되었습니다.</p><h3 id=검색-결과-위치-고정>검색 결과 위치 고정
<a class=anchor href=#%ea%b2%80%ec%83%89-%ea%b2%b0%ea%b3%bc-%ec%9c%84%ec%b9%98-%ea%b3%a0%ec%a0%95>#</a></h3><p>가장 먼저 느낀 문제점은 검색 결과가 카테고리 목록을 밀어내고 보여진다는 것입니다.
개인적으로 이러한 동작은 선호하지 않습니다.
검색 결과는 카테고리 목록의 위치를 옮기지 않고 그 위에 겹쳐서 나타나는 것이 가장 이상적입니다.</p><div class=sc-tabs><input type=radio class=toggle name=tabs-search-results id=tabs-search-results-0 checked>
<label for=tabs-search-results-0>CSS</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=scss><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">scss</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=c1>// assets/_main.scss
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>.book-search</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=nn>#book-search-results</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>position</span><span class=o>:</span> <span class=ni>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>background</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=no>gray</span><span class=o>-</span><span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=na>border</span><span class=o>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=ni>solid</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=no>gray</span><span class=o>-</span><span class=mi>200</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=na>border-radius</span><span class=o>:</span> <span class=nv>$border-radius</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>z-index</span><span class=o>:</span> <span class=mi>11</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-results id=tabs-search-results-1>
<label for=tabs-search-results-1>JavaScript</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// assets/search.js
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>search</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl>    <span class=nx>searchHits</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>page</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>li</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li&gt;&lt;a href&gt;&lt;/a&gt;&lt;small&gt;&lt;/small&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>li</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=c1>// small = li.querySelector(&#39;small&#39;); &lt;&lt; 제거
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=c1>// small.textContent = page.item.section; &lt;&lt; 제거
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>li</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div></div></div><p>이것은 검색 결과를 보여주는 요소의 위치를 고정시키면 됩니다.
CSS 파일에서 <code>position: absolute;</code> 를 적용하면 위치를 고정할 수 있고,
카테고리 목록인 <code>.book-categories</code> 요소보다 큰 <code>z-index</code> 를 부여하면
카테고리 목록 위에 검색 결과가 나타납니다.</p><p>추가로, 검색 결과에는 <code>section</code> 정보를 제목 밑에 같이 보여주고 있는데,
해당 블로그에서는 <code>section</code> 을 여러 개 사용할 일이 없으므로 없애는게 더 깔끔합니다.
이에 해당하는 <code>&lt;small></code> 태그는 자바스크립트에서 동적으로 생성하므로 이 부분을 제거했습니다.</p><p><label class=md-image for=md-image-toggle-4><input class="hidden toggle" type=checkbox id=md-image-toggle-4>
<img src="https://dl.dropboxusercontent.com/scl/fi/yjojly1wmx3ltbmw3b6qm/hugo-45-search-results-absolute.webp?rlkey=43mp7431jni6p59i6t95f43zi&amp;raw=1" alt="카테고리 목록 위에 검색 결과를 표시" loading=lazy decoding=async></label></p><h3 id=검색-결과에-더보기-링크-추가>검색 결과에 더보기 링크 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%ea%b2%b0%ea%b3%bc%ec%97%90-%eb%8d%94%eb%b3%b4%ea%b8%b0-%eb%a7%81%ed%81%ac-%ec%b6%94%ea%b0%80>#</a></h3><p>Book 테마에서는 검색 결과를 최대 10개까지만 보여줍니다.
하지만, 제목이 여러줄에 달하는 게시글들을 10개만 나열해도
해상도에 따라 검색 결과가 화면 끝에 닿거나 한 화면에 다 보이지 않을 수 있습니다.</p><p>이런 사유로 검색 페이지를 만들려고 하지만 검색 페이지에 대한건 다음 문단에서 서술하고,
일단 검색 결과를 요약해서 보여주기 위한 더보기 링크를 표시하겠습니다.</p><div class=sc-tabs><input type=radio class=toggle name=tabs-search-more id=tabs-search-more-0 checked>
<label for=tabs-search-more-0>JavaScript</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// assets/search.js
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>search</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchHits</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>.</span><span class=nx>search</span><span class=p>(</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span> <span class=c1>// 실제 검색 결과
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchPreview</span> <span class=o>=</span> <span class=nx>searchHits</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span> <span class=c1>// 사용자에게 보여줄 검색 결과 (미리보기 3개)
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>searchPreview</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>page</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>li</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li&gt;&lt;a href&gt;&lt;/a&gt;&lt;small&gt;&lt;/small&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>li</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>li</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 검색 결과가 3개를 초과할 경우 더보기 링크를 추가 (+ 검색 결과가 몇 개 있는지 카운팅하여 표시)
</span></span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>moreLink</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li class=&#34;book-search-more&#34;&gt;&lt;a href&gt;&lt;/a&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>moreLink</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;더보기 (총 &#39;</span> <span class=o>+</span> <span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>+</span> <span class=s1>&#39;개)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>moreLink</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-more id=tabs-search-more-1>
<label for=tabs-search-more-1>CSS</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=scss><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">scss</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=c1>// assets/_main.scss
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>.book-search</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=nc>.book-search-more</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>border-top</span><span class=o>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=ni>solid</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=no>gray</span><span class=o>-</span><span class=mi>200</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>color</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=ni>color</span><span class=o>-</span><span class=n>link</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=na>font-size</span><span class=o>:</span> <span class=nv>$font-size-12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=na>font-weight</span><span class=o>:</span> <span class=mi>500</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div><p>더보기 링크의 역할은 검색 버튼과 마찬가지로 검색 페이지가 만들어져야 제 기능을 하지만
일단 구색만 갖췄습니다.</p><p><label class=md-image for=md-image-toggle-5><input class="hidden toggle" type=checkbox id=md-image-toggle-5>
<img src="https://dl.dropboxusercontent.com/scl/fi/nw82ytf7boi8ljjif0heu/hugo-46-search-results-more.webp?rlkey=41wze58zpc55q7idbo2fgb4ga&amp;raw=1" alt="검색 결과가 3개를 초과하면 더보기 표시" loading=lazy decoding=async></label></p><p>이전 결과에서는 최대 10개 게시글만 보여주고
전체 몇 개 글이 있는지는 알 수 없었는데, 이 점을 개선했다는데에 의미가 있습니다.</p><h3 id=검색-결과-초기화-기능-추가>검색 결과 초기화 기능 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%ea%b2%b0%ea%b3%bc-%ec%b4%88%ea%b8%b0%ed%99%94-%ea%b8%b0%eb%8a%a5-%ec%b6%94%ea%b0%80>#</a></h3><p>Book 테마에서는 검색 결과를 표시하는 기능만 있고
검색 결과를 초기화하는 기능이 구현되어 있지 않습니다.</p><p>검색 결과를 팝업처럼 나타나게 하기 전에는 굳이 없어도 문제 없었겠지만,
변경 후 검색 결과가 카테고리 목록을 가려버리면서 검색 결과를 없애는 기능이 필요하다고 느꼈습니다.</p><p>이미 검색창으로 이동하는 단축키를 이벤트 리스너로 구현한 사례를 봤기 때문에
검색 결과 초기화 기능도 이벤트 리스너를 사용하면 동작을 구현할 수 있습니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ..
</span></span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>init</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keyup&#39;</span><span class=p>,</span> <span class=nx>search</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keydown&#39;</span><span class=p>,</span> <span class=nx>handleEscape</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;blur&#39;</span><span class=p>,</span> <span class=nx>clearResults</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {KeyboardEvent} event
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>handleEscape</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>key</span> <span class=o>===</span> <span class=s1>&#39;Escape&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>clearResults</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>input</span><span class=p>.</span><span class=nx>blur</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>clearResults</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=nx>results</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>removeChild</span><span class=p>(</span><span class=nx>results</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div><h2 id=검색-페이지-추가>검색 페이지 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%ed%8e%98%ec%9d%b4%ec%a7%80-%ec%b6%94%ea%b0%80>#</a></h2><p>사이드 메뉴라는 작은 영역에서 검색 결과를 표시하는데는 한계가 있습니다.
일반적인 블로그 플랫폼에서는 검색창에 입력한 결과를 하나의 페이지로 보여주는데
커스텀 테마에도 검색 페이지 템플릿을 추가해보겠습니다.</p><blockquote class="sc-hint danger"><p>💡 검색 페이지 템플릿은 <a href=/blog/hugo-blog-3/#%ea%b2%8c%ec%8b%9c%ea%b8%80-%eb%aa%a9%eb%a1%9d-%ed%85%9c%ed%94%8c%eb%a6%bf-%ec%b6%94%ea%b0%80>이전 게시글</a>에서
구현한 게시글 목록 템플릿을 활용합니다.</p><p>앞으로의 진행을 위해 해당 과정이 선행되어야 합니다.</p></blockquote><h3 id=검색-기능-파일-구조-재설계>검색 기능 파일 구조 재설계
<a class=anchor href=#%ea%b2%80%ec%83%89-%ea%b8%b0%eb%8a%a5-%ed%8c%8c%ec%9d%bc-%ea%b5%ac%ec%a1%b0-%ec%9e%ac%ec%84%a4%ea%b3%84>#</a></h3><p>지금까지만해도 검색과 관련해서 1개의 템플릿과 2개의 애셋 파일을 만들었는데,
앞으로 검색 관련 파일이 계속 추가되면서 복잡해질 것 같아 한번 정리하려고 합니다.</p><table><thead><tr><th>기존 파일</th><th>>>></th><th>변경된 파일</th></tr></thead><tbody><tr><td><code>layouts/_partials/docs/search.html</code></td><td>>>></td><td><code>layouts/_partials/search/input.html</code></td></tr><tr><td><code>assets/search-data.json</code></td><td>>>></td><td><code>assets/search/data.json</code></td></tr><tr><td><code>assets/search.js</code> (인덱스 생성 함수)</td><td>>>></td><td><code>assets/search/fuse.js</code></td></tr><tr><td><code>assets/search.js</code> (검색 수행 함수)</td><td>>>></td><td><code>assets/search/input.js</code></td></tr></tbody></table><p>검색 파일들이 앞으로 새로 추가될 것을 예상하여 <code>search</code> 폴더 내에 분류했습니다.</p><p>그리고, Fuse 인덱스를 생성하는 부분은 검색 페이지에서도 사용할 것이기 때문에,
하나의 <code>search.js</code> 스크립트를 <code>fuse.js</code>, <code>input.js</code> 라는 2개의 스크립트로 분리했습니다.
(변경된 파일명은 <code>&lt;head></code> 를 구성하는 <code>html-head.html</code> 에도 적용해야 합니다.)</p><p>이때, 서로 다른 자바스크립트 파일 간에 Fuse 인덱스를 공유하기 위해 <code>window</code> 전역 객체를 사용했습니다.
<code>fuse.js</code> 에서 전역 객체에 함수만 미리 정의해놓고 <code>input.js</code> 에서
검색 수행 시 해당 함수를 실행하는 방식으로 인덱스가 적절한 시점에 만들어지도록 했습니다.</p><p>이 과정을 아래의 <code>window</code> 그래프로 단순화할 수 있습니다.</p><div id=window></div><div class=sc-tabs><input type=radio class=toggle name=tabs-search-js id=tabs-search-js-0 checked>
<label for=tabs-search-js-0>window</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">text</span></div><pre tabindex=0><code>[HTML 페이지 로드]
       │
       ▼
┌──────────────────────────────────────┐
│  &lt;script src=&#34;fuse.js&#34;&gt;              │  ① 인덱스 생성 함수만 먼저 로드
│  window.bookSearch = {...}           │
│  window.bookSearch.initIndex = func  │
└──────────────────────────────────────┘
       │
       ▼
┌──────────────────────────────────────┐
│  &lt;script src=&#34;list.js&#34;&gt;              │  ② 검색 시 (performSearch)
│  window.bookSearch.initIndex()       │    fuse.js에서 정의한 함수 사용
│    .then(() =&gt; performSearch())      │
└──────────────────────────────────────┘
       │
       ▼
┌──────────────────────────────────────┐
│  window.bookSearchIndex              │  ③ 검색 시점에 인덱스가 생성됨
└──────────────────────────────────────┘</code></pre></div></div><input type=radio class=toggle name=tabs-search-js id=tabs-search-js-1>
<label for=tabs-search-js-1>fuse.js</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>$searchDataFile</span> <span class=o>:=</span> <span class=nx>printf</span> <span class=s2>&#34;search/%s.data.json&#34;</span> <span class=p>.</span><span class=nx>Language</span><span class=p>.</span><span class=nx>Lang</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>$searchData</span> <span class=o>:=</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Get</span> <span class=s2>&#34;search/data.json&#34;</span> <span class=o>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>ExecuteAsTemplate</span> <span class=nx>$searchDataFile</span> <span class=p>.</span> <span class=o>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Minify</span> <span class=o>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Fingerprint</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>$searchConfig</span> <span class=o>:=</span> <span class=nx>i18n</span> <span class=s2>&#34;bookSearchConfig&#34;</span> <span class=o>|</span> <span class=k>default</span> <span class=s2>&#34;{}&#34;</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span> <span class=o>||</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>searchDataURL</span> <span class=o>=</span> <span class=s1>&#39;{{ partial &#34;docs/links/resource-precache&#34; $searchData }}&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>getIndexConfig</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({{</span> <span class=nx>$searchConfig</span> <span class=p>}},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>includeScore</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>useExtendedSearch</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>fieldNormWeight</span><span class=o>:</span> <span class=mf>1.5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>threshold</span><span class=o>:</span> <span class=mf>0.2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>ignoreLocation</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>keys</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;title&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>weight</span><span class=o>:</span> <span class=mf>0.7</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;content&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>weight</span><span class=o>:</span> <span class=mf>0.3</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Fuse 검색 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=cm> * @returns {Promise&lt;Fuse&gt;}
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>initIndex</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>resolve</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>indexConfig</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>getIndexConfig</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>fetch</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>searchDataURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`HTTP error! status: </span><span class=si>${</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>pages</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Fuse</span><span class=p>(</span><span class=nx>pages</span><span class=p>,</span> <span class=nx>indexConfig</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-js id=tabs-search-js-2>
<label for=tabs-search-js-2>input.js</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>input</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#book-search-input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>results</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#book-search-results&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>input</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>init</span><span class=p>);</span>           <span class=c1>// 검색창이 포커스되면 검색 인덱스 생성
</span></span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keyup&#39;</span><span class=p>,</span> <span class=nx>search</span><span class=p>);</span>         <span class=c1>// 키 입력 시 검색 수행
</span></span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keydown&#39;</span><span class=p>,</span> <span class=nx>handleEscape</span><span class=p>);</span> <span class=c1>// ESC 키가 눌리면 검색 결과 초기화
</span></span></span><span class=line><span class=cl>  <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;blur&#39;</span><span class=p>,</span> <span class=nx>clearResults</span><span class=p>);</span>    <span class=c1>// 검색창에서 포커스가 해제되면 검색 결과 초기화
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 검색창으로 이동하는 단축키가 눌리는 이벤트 처리
</span></span></span><span class=line><span class=cl>  <span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keypress&#39;</span><span class=p>,</span> <span class=nx>focusSearchFieldOnKeyPress</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * 단축키(&#39;s&#39; 또는 &#39;/&#39;)가 눌리면 검색창으로 포커스 이동하는 함수
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {Event} event
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>focusSearchFieldOnKeyPress</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span> <span class=o>!==</span> <span class=kc>undefined</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>input</span> <span class=o>===</span> <span class=nb>document</span><span class=p>.</span><span class=nx>activeElement</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>characterPressed</span> <span class=o>=</span> <span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>charCode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isHotkey</span><span class=p>(</span><span class=nx>characterPressed</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>focus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>event</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * 입력된 문자가 단축키와 일치하는지 확인하는 함수
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {string} character
</span></span></span><span class=line><span class=cl><span class=cm>   * @returns {boolean}
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>isHotkey</span><span class=p>(</span><span class=nx>character</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>dataHotkeys</span> <span class=o>=</span> <span class=nx>input</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-hotkeys&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>dataHotkeys</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>character</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * ESC 키가 눌리면 검색 결과를 초기화하고 검색창에서 포커스를 해제하는 함수
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {KeyboardEvent} event
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>handleEscape</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>key</span> <span class=o>===</span> <span class=s1>&#39;Escape&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>clearResults</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>input</span><span class=p>.</span><span class=nx>blur</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>clearResults</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=nx>results</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>removeChild</span><span class=p>(</span><span class=nx>results</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * 검색창이 최초로 포커스되면 검색 인덱스를 생성하는 함수
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>init</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>required</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>initIndex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>input</span><span class=p>.</span><span class=nx>required</span> <span class=o>=</span> <span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>search</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * 검색 수행 후 검색 결과 미리보기(최대 3개)를 표시하는 함수
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>search</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>clearResults</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchHits</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>.</span><span class=nx>search</span><span class=p>(</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchPreview</span> <span class=o>=</span> <span class=nx>searchHits</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>searchPreview</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>page</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>li</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li&gt;&lt;a href&gt;&lt;/a&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>li</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>page</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>li</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 검색 페이지로 이동하기 위한 더보기 링크를 표시
</span></span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>moreLink</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li class=&#34;book-search-more&#34;&gt;&lt;a href&gt;&lt;/a&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>moreLink</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;{{ &#34;/search/&#34; | relURL }}?q=&#39;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;더보기 (총 &#39;</span> <span class=o>+</span> <span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>+</span> <span class=s1>&#39;개)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>moreLink</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * HTML 문자열로부터 DOM 요소를 생성
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {string} content
</span></span></span><span class=line><span class=cl><span class=cm>   * @returns {Node}
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>element</span><span class=p>(</span><span class=nx>content</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>div</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>div</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=nx>content</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>div</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-js id=tabs-search-js-3>
<label for=tabs-search-js-3>html-head.html</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- Search --&gt;</span>
</span></span><span class=line><span class=cl>{{- if default true .Site.Params.BookSearch -}}
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Search Data --&gt;</span>
</span></span><span class=line><span class=cl>  {{- $searchData := resources.Get &#34;search/data.json&#34; | resources.ExecuteAsTemplate &#34;search/data.json&#34; . | resources.Minify | resources.Fingerprint }}
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;preload&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ $searchData.RelPermalink }}&#34;</span> <span class=na>as</span><span class=o>=</span><span class=s>&#34;fetch&#34;</span> <span class=na>crossorigin</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>SEARCH_DATA_URL</span> <span class=o>=</span> <span class=s2>&#34;{{ $searchData.RelPermalink }}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Search Fuse --&gt;</span>
</span></span><span class=line><span class=cl>  {{- $searchFuseJS := resources.Get &#34;search/fuse.js&#34; | resources.ExecuteAsTemplate &#34;search/fuse.js&#34; . | resources.Minify | resources.Fingerprint }}
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span> <span class=na>defer</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ &#34;</span><span class=na>fuse</span><span class=err>.</span><span class=na>min</span><span class=err>.</span><span class=na>js</span><span class=err>&#34;</span> <span class=err>|</span> <span class=na>relURL</span> <span class=err>}}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span> <span class=na>defer</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ partial &#34;</span><span class=na>docs</span><span class=err>/</span><span class=na>links</span><span class=err>/</span><span class=na>resource-precache</span><span class=err>&#34;</span> <span class=err>$</span><span class=na>searchFuseJS</span> <span class=err>}}&#34;</span> <span class=err>{{</span> <span class=na>template</span> <span class=err>&#34;</span><span class=na>integrity</span><span class=err>&#34;</span> <span class=err>$</span><span class=na>searchFuseJS</span> <span class=err>}}</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Search Input --&gt;</span>
</span></span><span class=line><span class=cl>  {{- $searchInputJS := resources.Get &#34;search/input.js&#34; | resources.ExecuteAsTemplate &#34;search/input.js&#34; . | resources.Minify | resources.Fingerprint }}
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span> <span class=na>defer</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ partial &#34;</span><span class=na>docs</span><span class=err>/</span><span class=na>links</span><span class=err>/</span><span class=na>resource-precache</span><span class=err>&#34;</span> <span class=err>$</span><span class=na>searchInputJS</span> <span class=err>}}&#34;</span> <span class=err>{{</span> <span class=na>template</span> <span class=err>&#34;</span><span class=na>integrity</span><span class=err>&#34;</span> <span class=err>$</span><span class=na>searchInputJS</span> <span class=err>}}</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{ end -}}</span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-js id=tabs-search-js-4>
<label for=tabs-search-js-4>menu.html</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{ partial &#34;docs/brand&#34; . }}
</span></span><span class=line><span class=cl>{{ partial &#34;docs/search/input&#34; . }}
</span></span><span class=line><span class=cl><span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>nav</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div><h3 id=빈-검색-페이지-생성>빈 검색 페이지 생성
<a class=anchor href=#%eb%b9%88-%ea%b2%80%ec%83%89-%ed%8e%98%ec%9d%b4%ec%a7%80-%ec%83%9d%ec%84%b1>#</a></h3><p>검색 페이지는 <code>/search</code> 경로로 연결되는데
Hugo에서 해당 경로를 인식시키기 위해 콘텐츠 파일을 만들어야 합니다.</p><p><code>content/search/_index.md</code> 경로에 파일을 생성해줍니다.</p><div class=sc-codeblock data-lang=yaml><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">yaml</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Search&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;search&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>---</span></span></span></code></pre></div></div><p>파일 내용은 위와 같이 front matter만 입력해주고 본문은 비워놓으면 됩니다.
이 파일을 생성한 것으로 <code>/search</code> 경로를 인식할 수 있게 되었습니다.
실제로 <code>/search</code> 경로에 접속하면 아래 이미지와 같은 빈 페이지가 보입니다.</p><p><label class=md-image for=md-image-toggle-6><input class="hidden toggle" type=checkbox id=md-image-toggle-6>
<img src="https://dl.dropboxusercontent.com/scl/fi/rmii7uu5ff863s00aj2lp/hugo-47-search-page-empty.webp?rlkey=goo5yhox3ctedvjuqo85imtzq&amp;raw=1" alt="비어있는 검색 페이지" loading=lazy decoding=async></label></p><h3 id=검색-페이지-이동-기능-추가>검색 페이지 이동 기능 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%ed%8e%98%ec%9d%b4%ec%a7%80-%ec%9d%b4%eb%8f%99-%ea%b8%b0%eb%8a%a5-%ec%b6%94%ea%b0%80>#</a></h3><p>검색창에 검색어가 입력된 상태에서 검색 페이지로 이동할 수 있는 3가지 방법을 정리해보았습니다.</p><blockquote class="sc-hint default"><ol><li><a href=#%ea%b2%80%ec%83%89-%ec%95%84%ec%9d%b4%ec%bd%98-%ec%b6%94%ea%b0%80>검색 버튼</a>을 마우스 클릭</li><li>검색창에서 엔터 키를 입력</li><li>검색 결과 맨 아래 <a href=#%ea%b2%80%ec%83%89-%ea%b2%b0%ea%b3%bc%ec%97%90-%eb%8d%94%eb%b3%b4%ea%b8%b0-%eb%a7%81%ed%81%ac-%ec%b6%94%ea%b0%80>더보기 링크</a>를 클릭</li></ol></blockquote><p>1, 2번 방법은 <code>search-input.html</code> 템플릿에서 구현하고 3번 방법은
<code>search-input.js</code> 스크립트에서 구현할 것입니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>goToSearchPage</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>searchInput</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;book-search-input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>query</span> <span class=o>=</span> <span class=nx>searchInput</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>trim</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>query</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/search/?q=&#39;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p><code>goToSearchPage()</code> 함수는 <code>/search</code> 경로로 이동하면서,
검색창에 입력된 값을 <code>q</code> 파라미터로 전달하는 기능을 합니다.
만약 "Hugo" 라는 검색어를 입력했다면 <code>&lt;baseUrl>/search/?q=Hugo</code> 주소로 매핑됩니다.</p><p>함수가 길지는 않으므로 템플릿 자체에 내장시키겠습니다.
<code>search-input</code> 템플릿에서 <code>&lt;script></code> 내부에 함수를 추가합니다.</p><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/_partials/docs/search-input.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search hidden&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;search-input-container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;book-search-input&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;{{ i18n &#34;</span><span class=na>Search</span><span class=err>&#34;</span> <span class=err>}}&#34;</span> <span class=na>aria-label</span><span class=o>=</span><span class=s>&#34;{{ i18n &#34;</span><span class=na>Search</span><span class=err>&#34;</span> <span class=err>}}&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>maxlength</span><span class=o>=</span><span class=s>&#34;64&#34;</span> <span class=na>data-hotkeys</span><span class=o>=</span><span class=s>&#34;s/&#34;</span> <span class=na>onkeydown</span><span class=o>=</span><span class=s>&#34;if(event.key===&#39;Enter&#39;) goToSearchPage()&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;book-search-button&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search-btn&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;goToSearchPage()&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>i</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;fa-solid fa-magnifying-glass&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>i</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;book-search-spinner hidden&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>ul</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;book-search-results&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;.book-search&#34;</span><span class=p>).</span><span class=nx>classList</span><span class=p>.</span><span class=nx>remove</span><span class=p>(</span><span class=s2>&#34;hidden&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// goToSearchPage() 함수 추가
</span></span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div></div><p>그리고, 검색 버튼인 <code>&lt;button></code> 요소에 <code>onclick</code> 속성으로 <code>goToSearchPage()</code> 함수를 연결시키고,
검색창인 <code>&lt;input></code> 요소에도 <code>onkeydown</code> 속성으로 엔터 키를 감지하여 <code>goToSearchPage()</code> 함수를 실행하도록
적용했습니다.</p><p>이렇게 검색 페이지로 이동하는 1, 2번 방법이 구현되었습니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// assets/search-input.js
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>search</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>moreLink</span> <span class=o>=</span> <span class=nx>element</span><span class=p>(</span><span class=s1>&#39;&lt;li class=&#34;book-search-more&#34;&gt;&lt;a href&gt;&lt;/a&gt;&lt;/li&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>moreLink</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;{{ &#34;/search/&#34; | relURL }}?q=&#39;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;더보기 (총 &#39;</span> <span class=o>+</span> <span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>+</span> <span class=s1>&#39;개)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>results</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>moreLink</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>})();</span></span></span></code></pre></div></div><p>3번 방법인 더보기 링크는 <code>search-input.js</code> 에서 동적으로 만들어주므로,
더보기 링크에 해당하는 <code>&lt;a></code> 요소에 <code>href</code> 속성을 추가해줍니다.</p><p>3가지 방법 모두 실제로 테스트해보면 <code>/search</code> 경로로 연결됩니다.</p><h3 id=검색-결과-표시-방식-구상>검색 결과 표시 방식 구상
<a class=anchor href=#%ea%b2%80%ec%83%89-%ea%b2%b0%ea%b3%bc-%ed%91%9c%ec%8b%9c-%eb%b0%a9%ec%8b%9d-%ea%b5%ac%ec%83%81>#</a></h3><p>검색 페이지에서 검색 결과를 표시하는 방식으로 아래 2가지를 생각해볼 수 있습니다.</p><blockquote class="sc-hint default"><ol><li>모든 게시글에 대한 요소를 생성해두고 검색 결과에 없는 요소는 숨기기</li><li>자바스크립트에서 동적으로 검색 결과에 해당하는 요소를 생성하기</li></ol></blockquote><p>첫 번째 방식의 경우 모든 게시글에 대한 요소를 생성하기 때문에
초기에 로드되는 DOM 크기가 커진다는 단점이 있습니다.
하지만, 정적 사이트 생성기인 Hugo의 특성상 검색을 위한 게시글 정보도
정적 파일로 만들어놓고 불러와야하기 때문에 두 번째 방식과의 차이가 크지 않을거라 생각했습니다.</p><p>효율성을 생각하면 필요한 항목만 동적으로 생성하는 두 번째 방식이 더 나을 수 있지만,
두 번째 방식은 기존에 게시글 항목을 구성하기 위해 만들어뒀던
<a href=/blog/hugo-blog-3/#%ea%b2%8c%ec%8b%9c%ea%b8%80-%ed%95%ad%eb%aa%a9-%ed%85%9c%ed%94%8c%eb%a6%bf-%ec%b6%94%ea%b0%80><code>post-item</code></a> 템플릿을
활용할 수 없기 때문에 자바스크립트에서 템플릿의 기능을 다시 구현해야 합니다.</p><p>단순히 불편함만 따진다면 아직까지 여전히 효율이 좋은 두 번째 방식을 선택하고 싶지만,
향후 <code>post-item</code> 템플릿이 변경될 경우 자바스크립트도 동일하게 변경해줘야 하는
종속적인 관계가 되어버려 자칫하면 일관성을 잃어버릴 수 있을 문제가 있어
첫 번째 방식을 채택했습니다. 표로 정리하면 아래와 같습니다.</p><table><thead><tr><th>항목</th><th>방식 1</th><th>방식 2</th></tr></thead><tbody><tr><td>구현 방식</td><td>모든 게시글을 나열하고 검색되지 않은 게시글은 숨기기</td><td>검색된 게시글만 동적으로 생성</td></tr><tr><td>구현 복잡도</td><td>✅ 낮음 (템플릿 재사용 가능)</td><td>❌ 높음 (템플릿 재구현 필요)</td></tr><tr><td>초기 로드 크기</td><td>❌ 모든 페이지에 대한 <code>post-item</code> 요소</td><td>✅ 모든 페이지의 속성만 추출한 <code>data.json</code></td></tr><tr><td>템플릿 일관성</td><td>✅ 높음 (템플릿의 변경사항만 고려하면 됨)</td><td>❌ 낮음 (템플릿 변경사항을 자바스크립트에도 반영)</td></tr></tbody></table><details><summary>만약 방식 2를 사용할 경우 <code>data.json</code> 을 이렇게 구성해야 합니다.</summary><div class=markdown-inner><p><code>data.json</code> 에는 <code>post-item</code> 템플릿을 구성하는 모든 속성 값들이 포함됩니다.</p><div class=sc-codeblock data-lang=json><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">json</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>$pages</span> <span class=err>:=</span> <span class=err>where</span> <span class=err>.Site.Pages</span> <span class=nt>&#34;Kind&#34;</span> <span class=s2>&#34;in&#34;</span> <span class=err>(slice</span> <span class=s2>&#34;page&#34;</span> <span class=s2>&#34;section&#34;</span><span class=err>)</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>$pages</span> <span class=err>=</span> <span class=err>where</span> <span class=err>$pages</span> <span class=nt>&#34;Params.bookSearchExclude&#34;</span> <span class=s2>&#34;!=&#34;</span> <span class=kc>true</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>$pages</span> <span class=err>=</span> <span class=err>where</span> <span class=err>$pages</span> <span class=nt>&#34;Content&#34;</span> <span class=s2>&#34;!=&#34;</span> <span class=s2>&#34;&#34;</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{</span> <span class=err>range</span> <span class=err>$index,</span> <span class=err>$page</span> <span class=err>:=</span> <span class=err>$pages</span> <span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{</span> <span class=err>if</span> <span class=err>gt</span> <span class=err>$index</span> <span class=err>0</span><span class=p>}</span><span class=err>}</span><span class=p>,{</span><span class=err>{end</span> <span class=p>}</span><span class=err>}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>$index</span> <span class=p>}},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;href&#34;</span><span class=err>:</span> <span class=s2>&#34;{{ $page.RelPermalink }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;title&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(partial</span> <span class=nt>&#34;docs/title&#34;</span> <span class=err>$page)</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;section&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(partial</span> <span class=nt>&#34;docs/title&#34;</span> <span class=err>$page.Parent)</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;content&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>$page.Plain</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;date&#34;</span><span class=err>:</span> <span class=s2>&#34;{{ $page.Date.Format &#34;</span><span class=mi>2006-01-02</span><span class=s2>&#34; }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;parentCategory&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(partial</span> <span class=nt>&#34;categories/value-first&#34;</span> <span class=err>$page.Params.categories)</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;childCategory&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(partial</span> <span class=nt>&#34;categories/value-second&#34;</span> <span class=err>$page.Params.categories)</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tags&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>(first</span> <span class=err>5</span> <span class=err>($page.Params.tags</span> <span class=err>|</span> <span class=err>default</span> <span class=err>slice))</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;thumbnail&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>$page.Params.thumbnail</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;cover&#34;</span><span class=err>:</span> <span class=p>{</span><span class=err>{</span> <span class=err>$page.Params.cover</span> <span class=err>|</span> <span class=err>jsonify</span> <span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=err>{-</span> <span class=err>end</span> <span class=err>-</span><span class=p>}</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span></span></span></code></pre></div></div></div></details><h3 id=검색-페이지-템플릿-추가>검색 페이지 템플릿 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%ed%8e%98%ec%9d%b4%ec%a7%80-%ed%85%9c%ed%94%8c%eb%a6%bf-%ec%b6%94%ea%b0%80>#</a></h3><p>검색 결과를 표시하기 위해 방식 1을 선택했으므로
모든 게시글을 나열하기 위한 검색 페이지 템플릿을 구현해야 합니다.</p><p>검색 페이지로 연결되는 <code>/search</code> 경로와 대응되는 템플릿 위치는 <code>layouts/search/list.html</code> 인데,
여기에 다음과 같은 내용을 작성합니다.</p><div class=sc-tabs><input type=radio class=toggle name=tabs-search-page id=tabs-search-page-0 checked>
<label for=tabs-search-page-0>HTML</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=html><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">html</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/search/list.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{{ define &#34;main&#34; }}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>article</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;markdown book-article&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;search-header&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>검색 결과<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;search-query-info&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;search-query-display&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;search-no-results&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;search-no-results hidden&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>검색 결과가 없습니다.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;search-base&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;display: none;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{- $pages := where .Site.RegularPages &#34;Params.bookSearchExclude&#34; &#34;!=&#34; true -}}
</span></span><span class=line><span class=cl>    {{- range $pages.ByDate.Reverse -}}
</span></span><span class=line><span class=cl>      {{ partial &#34;docs/post-item.html&#34; . }}
</span></span><span class=line><span class=cl>    {{- end -}}
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;post-list search-results&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;search-pagination&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>article</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{ end }}</span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-search-page id=tabs-search-page-1>
<label for=tabs-search-page-1>CSS</label><div class="sc-tabs-content markdown-inner"><div class=sc-codeblock data-lang=scss><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">scss</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=c1>// assets/_main.scss
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>.search-header</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=na>margin-bottom</span><span class=o>:</span> <span class=nv>$padding-16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nt>h1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>font-size</span><span class=o>:</span> <span class=nv>$font-size-40</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>margin-bottom</span><span class=o>:</span> <span class=nv>$padding-8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nc>.search-query-info</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>p</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>font-size</span><span class=o>:</span> <span class=nv>$font-size-18</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>.search-no-results</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=na>text-align</span><span class=o>:</span> <span class=ni>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=na>padding</span><span class=o>:</span> <span class=nv>$padding-24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nt>p</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>font-size</span><span class=o>:</span> <span class=nv>$font-size-20</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div><p><code>post-item</code> 템플릿을 활용하여 모든 게시글들을 나열하는 것 외에
직접적인 검색 기능은 자바스크립트에서 구현됩니다.
ExampleSite는 현재 블로그와 구조가 달라서
게시글, Taxonomy 페이지 구분 없이 모든 페이지를 가져왔는데,
특정 섹션에 속하는 게시글만 보여주고 싶으면 이렇게 필터할 수 있습니다.</p><ul><li><code>$pages := where .Site.RegularPages "Section" "posts"</code></li></ul><p>검색 결과는 <code>.search-results</code> 영역에 표시되고,
만약 검색 결과가 없다면 <code>#search-no-results</code> 영역이 나타날 것입니다.</p><h2 id=검색-및-결과-표시-기능-추가>검색 및 결과 표시 기능 추가
<a class=anchor href=#%ea%b2%80%ec%83%89-%eb%b0%8f-%ea%b2%b0%ea%b3%bc-%ed%91%9c%ec%8b%9c-%ea%b8%b0%eb%8a%a5-%ec%b6%94%ea%b0%80>#</a></h2><p>마지막으로, 검색 페이지의 핵심 기능을 자바스크립트로 구현하겠습니다.</p><p>파일명은 중요하지 않지만 <code>search/list.html</code> 템플릿 명칭과 맞춰서 <code>search/list.js</code> 로 하겠습니다.</p><h3 id=파라미터-초기화-및-인덱스-생성>파라미터 초기화 및 인덱스 생성
<a class=anchor href=#%ed%8c%8c%eb%9d%bc%eb%af%b8%ed%84%b0-%ec%b4%88%ea%b8%b0%ed%99%94-%eb%b0%8f-%ec%9d%b8%eb%8d%b1%ec%8a%a4-%ec%83%9d%ec%84%b1>#</a></h3><p>자바스크립트에서 처음에는 파라미터를 받습니다.</p><p>검색 키워드는 <code>q</code>, 페이지는 <code>page</code> 에 대응되며
각각 <code>query</code>, <code>currentPage</code> 상수에 할당됩니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// assets/search/list.js
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;DOMContentLoaded&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>urlParams</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URLSearchParams</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>search</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>query</span> <span class=o>=</span> <span class=nx>urlParams</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>currentPage</span> <span class=o>=</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>urlParams</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;page&#39;</span><span class=p>))</span> <span class=o>||</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>itemsPerPage</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearch</span><span class=p>.</span><span class=nx>initIndex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>initSearch</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>performSearch</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>initSearch</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>displayElement</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-query-display&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>query</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>displayElement</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=sb>`&#34;</span><span class=si>${</span><span class=nx>query</span><span class=si>}</span><span class=sb>&#34; 검색 결과 &lt;em class=&#34;list-count&#34; id=&#34;search-count&#34;&gt;0&lt;/em&gt;`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>displayElement</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;검색어를 입력해주세요.&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div></div><p>파라미터를 초기화한 후 <code>window.bookSearch.initIndex()</code> 함수를 호출하여
검색 인덱스를 생성합니다. 앞에서 <a href=#window>검색 기능 파일 구조를 재설계</a>하는 과정에서
Fuse 인덱스를 생성하는 전역 함수 <code>initIndex()</code> 를 미리 정의했습니다.
해당 함수를 실행하면 마찬가지로 전역 위치에 인덱스가 생성되고
<code>window.bookSearchIndex</code> 를 호출하는 것으로 인덱스에 접근할 수 있습니다.</p><p>인덱스가 생성되면 이어서 <code>initSearch() >> performSearch()</code> 순서로 함수를 실행합니다.</p><p><code>initSearch()</code> 함수는 간단하여 같이 설명합니다.
검색 쿼리가 있을 경우, 검색 결과가 몇 개 있는지 표시하는 <code>.list-count</code> 요소를 포함한
문장을 <code>.search-query-display</code> 영역 내에 삽입합니다.
만약 검색 쿼리가 없으면 검색어를 입력해달라는 안내 문구를 표시합니다.</p><h3 id=검색-수행-및-결과-필터링>검색 수행 및 결과 필터링
<a class=anchor href=#%ea%b2%80%ec%83%89-%ec%88%98%ed%96%89-%eb%b0%8f-%ea%b2%b0%ea%b3%bc-%ed%95%84%ed%84%b0%eb%a7%81>#</a></h3><p><code>performSearch()</code> 함수는 검색을 수행하고 검색 결과를 표시하는 기능을 합니다.
함수의 내용이 한 화면에 들어오지 않아 설명은 주석으로 대체합니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;DOMContentLoaded&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>performSearch</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>sourceContainer</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;.search-base&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>resultsContainer</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;.search-results&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>allPostItems</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nx>sourceContainer</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;.post-item&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>query</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-no-results&#39;</span><span class=p>).</span><span class=nx>classList</span><span class=p>.</span><span class=nx>remove</span><span class=p>(</span><span class=s1>&#39;hidden&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-pagination&#39;</span><span class=p>).</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s1>&#39;none&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Fuse 검색 인덱스를 활용한 검색 수행
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchHits</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>bookSearchIndex</span><span class=p>.</span><span class=nx>search</span><span class=p>(</span><span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>searchHits</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-no-results&#39;</span><span class=p>).</span><span class=nx>classList</span><span class=p>.</span><span class=nx>remove</span><span class=p>(</span><span class=s1>&#39;hidden&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-count&#39;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-pagination&#39;</span><span class=p>).</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s1>&#39;none&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 검색 결과와 대응되는 DOM 요소를 찾기 (href 속성이 일치하는지 확인)
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>matchedItems</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=nx>searchHits</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>result</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>href</span> <span class=o>=</span> <span class=nx>result</span><span class=p>.</span><span class=nx>item</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>matchedItem</span> <span class=o>=</span> <span class=nx>allPostItems</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>item</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>link</span> <span class=o>=</span> <span class=nx>item</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;.post-title a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>link</span> <span class=o>&amp;&amp;</span> <span class=nx>link</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;href&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>matchedItem</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>matchedItems</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>matchedItem</span><span class=p>.</span><span class=nx>cloneNode</span><span class=p>(</span><span class=kc>true</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 페이지네이션 생성을 위한 인덱스 계산
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>totalPages</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>matchedItems</span><span class=p>.</span><span class=nx>length</span> <span class=o>/</span> <span class=nx>itemsPerPage</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>startIndex</span> <span class=o>=</span> <span class=p>(</span><span class=nx>currentPage</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=nx>itemsPerPage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>endIndex</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>startIndex</span> <span class=o>+</span> <span class=nx>itemsPerPage</span><span class=p>,</span> <span class=nx>matchedItems</span><span class=p>.</span><span class=nx>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 현재 페이지의 게시글을 가상 DOM 컨테이너에 추가하고 실제 DOM에 업데이트
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>fragment</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createDocumentFragment</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>startIndex</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>endIndex</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>fragment</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>matchedItems</span><span class=p>[</span><span class=nx>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>resultsContainer</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>resultsContainer</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>fragment</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 검색 결과 수를 업데이트
</span></span></span><span class=line><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-count&#39;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>matchedItems</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>buildPagination</span><span class=p>(</span><span class=nx>currentPage</span><span class=p>,</span> <span class=nx>totalPages</span><span class=p>,</span> <span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div></div><p>검색 페이지 템플릿에서 모든 게시글을 나열하는 <code>.search-base</code> 영역과
검색 결과를 표시하는 <code>.search-results</code> 영역이 따로 구분된 이유가 이 함수의 동작으로 설명됩니다.</p><p>검색 결과를 표시하는 방법으로, 처음에는 모든 게시글의 스타일에 <code>display = 'none';</code>
속성을 넣어서 전체 게시글을 숨기고 검색 결과에 해당하는 게시글에만
<code>display = 'block';</code> 속성을 덮어씌워 숨김을 해제했습니다.</p><p>하지만, 이 방식의 단점은 검색 결과를 유사도 순으로 표시하지 못하고
무조건 처음 페이지가 나열된 기준인 작성일 내림차순으로 정렬하여 표시합니다.
이렇게 정리하고보니 정렬 기준을 바꾸는 기능도 추가하면 좋겠다 생각하지만,
어쨋든 유사도 순으로 보여주는게 사용자 입장에서는 더 검색 결과에 대한 흥미를 끌 수 있을 것 같아
다른 방식을 생각했습니다.</p><p>자바스크립트로 사이트를 구현하는데 익숙하지 않다보니 코파일럿의 도움을 받았는데,
가장 매력적인 방식이 <code>DocumentFragment</code> 라는 가상의 DOM 컨테이너를 활용하는 것이었습니다.</p><p>매번 검색할 때마다 게시글 요소를 재배치하기 위해 반복문으로 DOM을 조작하는건
매우 큰 부하를 일으킬 수 있습니다.
단일 요소를 바꾸기 위해 매번 DOM 전체를 업데이트 해야하기 때문입니다.</p><p>이러한 문제를 해결할 수 있는 것이 <code>DocumentFragment</code> 입니다.
메모리에 존재하는 가상의 DOM 컨테이너에 검색 결과에 해당하는 <code>post-item</code> 요소들을 담아놓고
반복문이 끝난 시점에 실제 DOM에 있는 <code>.search-results</code> 영역에
요소들의 뭉치를 추가하면 단 한번의 DOM 업데이트만으로 모든 검색 결과를 나타낼 수 있습니다.
이는 아래 그래프로 단순화할 수 있습니다.</p><div id=document-fragment></div><div class=sc-codeblock data-lang><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">text</span></div><pre tabindex=0><code>[메모리]                            [실제 DOM]
┌──────────────────┐              ┌──────────────────┐
│ DocumentFragment │              │  .search-results │
│  ├─ post-item 1  │              │  ├─ post-item 1  │
│  ├─ post-item 2  │  ─────────►  │  ├─ post-item 2  │
│  └─ post-item 3  │  appendChild │  └─ post-item 3  │
└──────────────────┘              └──────────────────┘</code></pre></div><p><code>performSearch()</code> 함수에서는 검색 결과를 토대로 총 페이지 수, 시작 페이지, 종료 페이지를
계산하는데, 이 값들은 곧바로 다음 <code>buildPagination()</code> 함수를 호출하면서
파라미터로 전달됩니다.</p><h3 id=페이지네이션-동적-생성>페이지네이션 동적 생성
<a class=anchor href=#%ed%8e%98%ec%9d%b4%ec%a7%80%eb%84%a4%ec%9d%b4%ec%85%98-%eb%8f%99%ec%a0%81-%ec%83%9d%ec%84%b1>#</a></h3><p>페이지네이션 생성 함수 <code>buildPagination()</code> 의 내용은 길긴 하지만
<a href=/blog/hugo-blog-3/#%ed%8e%98%ec%9d%b4%ec%a7%80%eb%84%a4%ec%9d%b4%ec%85%98-%ed%85%9c%ed%94%8c%eb%a6%bf-%ec%b6%94%ea%b0%80-1>페이지네이션 템플릿</a>인 <code>pagination</code> 의
내용을 그대로 자바스크립트로 구현한 것 뿐입니다.</p><p>페이지네이션 또한 <code>post-item</code> 처럼 <code>paginaiton</code> 템플릿을 그대로 사용하고 싶었지만,
단순 재배치만 하면 되는 <code>post-item</code> 과 다르게 페이지네이션은 링크나 페이지 번호 등
모든 요소의 텍스트까지 싹 바꿔야하다보니 템플릿을 사용하는 의미가 없어 완전히 동적으로 생성하게 되었습니다.</p><div class=sc-codeblock data-lang=js><div class=code-actions><button class="code-copy-button code-action" onclick=copyCode(this)>
<i class="fa-solid fa-copy"></i>Copy
</button>
<span class="code-language code-action">js</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;DOMContentLoaded&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {number} currentPage - 현재 페이지 (1부터 시작)
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {number} totalPages - 총 페이지 수
</span></span></span><span class=line><span class=cl><span class=cm>   * @param {string} query - 검색 쿼리
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>buildPagination</span><span class=p>(</span><span class=nx>currentPage</span><span class=p>,</span> <span class=nx>totalPages</span><span class=p>,</span> <span class=nx>query</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>paginationContainer</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;search-pagination&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>totalPages</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>paginationContainer</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s1>&#39;none&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>paginationContainer</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s1>&#39;block&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>createPageUrl</span> <span class=o>=</span> <span class=p>(</span><span class=nx>page</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=sb>`/search/?q=</span><span class=si>${</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>query</span><span class=p>)</span><span class=si>}${</span><span class=nx>page</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>?</span> <span class=s1>&#39;&amp;page=&#39;</span> <span class=o>+</span> <span class=nx>page</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=si>}</span><span class=sb>#pagination-anchor`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 10개 게시글 단위로 페이지를 그룹화
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>groupNumber</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>((</span><span class=nx>currentPage</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>groupStart</span> <span class=o>=</span> <span class=nx>groupNumber</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>groupEnd</span> <span class=o>=</span> <span class=nx>groupStart</span> <span class=o>+</span> <span class=mi>9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>groupEnd</span> <span class=o>&gt;</span> <span class=nx>totalPages</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>groupEnd</span> <span class=o>=</span> <span class=nx>totalPages</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 이전 및 다음 페이지 그룹을 계산
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>prevGroupPage</span> <span class=o>=</span> <span class=nx>groupStart</span> <span class=o>-</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>nextGroupPage</span> <span class=o>=</span> <span class=nx>groupEnd</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 이전 페이지 그룹으로 이동하는 링크
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>prevButtonHTML</span> <span class=o>=</span> <span class=nx>groupStart</span> <span class=o>&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>?</span> <span class=sb>`&lt;a href=&#34;</span><span class=si>${</span><span class=nx>createPageUrl</span><span class=p>(</span><span class=nx>prevGroupPage</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>?</span> <span class=nx>prevGroupPage</span> <span class=o>:</span> <span class=mi>1</span><span class=p>)</span><span class=si>}</span><span class=sb>&#34; class=&#34;pagination-nav pagination-link&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;i class=&#34;fa-solid fa-backward&#34;&gt;&lt;/i&gt; 이전
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/a&gt;`</span>
</span></span><span class=line><span class=cl>      <span class=o>:</span> <span class=sb>`&lt;span class=&#34;pagination-nav disabled&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;i class=&#34;fa-solid fa-backward&#34;&gt;&lt;/i&gt; 이전
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/span&gt;`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 현재 페이지 그룹에 속한 각각의 페이지로 이동하는 링크
</span></span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>pagesHTML</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>groupStart</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=nx>groupEnd</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>i</span> <span class=o>===</span> <span class=nx>currentPage</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>pagesHTML</span> <span class=o>+=</span> <span class=sb>`&lt;span class=&#34;pagination-page current&#34; id=&#34;current-page&#34;&gt;</span><span class=si>${</span><span class=nx>i</span><span class=si>}</span><span class=sb>&lt;/span&gt;`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>pagesHTML</span> <span class=o>+=</span> <span class=sb>`&lt;a href=&#34;</span><span class=si>${</span><span class=nx>createPageUrl</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span><span class=si>}</span><span class=sb>&#34; class=&#34;pagination-page pagination-link&#34;&gt;</span><span class=si>${</span><span class=nx>i</span><span class=si>}</span><span class=sb>&lt;/a&gt;`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 다음 페이지 그룹으로 이동하는 링크
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>nextButtonHTML</span> <span class=o>=</span> <span class=nx>nextGroupPage</span> <span class=o>&lt;=</span> <span class=nx>totalPages</span>
</span></span><span class=line><span class=cl>      <span class=o>?</span> <span class=sb>`&lt;a href=&#34;</span><span class=si>${</span><span class=nx>createPageUrl</span><span class=p>(</span><span class=nx>nextGroupPage</span><span class=p>)</span><span class=si>}</span><span class=sb>&#34; class=&#34;pagination-nav pagination-link&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          다음 &lt;i class=&#34;fa-solid fa-forward&#34;&gt;&lt;/i&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/a&gt;`</span>
</span></span><span class=line><span class=cl>      <span class=o>:</span> <span class=sb>`&lt;span class=&#34;pagination-nav disabled&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          다음 &lt;i class=&#34;fa-solid fa-forward&#34;&gt;&lt;/i&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/span&gt;`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 페이지네이션을 `#search-pagination` 영역에 업데이트
</span></span></span><span class=line><span class=cl>    <span class=nx>paginationContainer</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;div id=&#34;pagination-anchor&#34;&gt;&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;nav class=&#34;pagination&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        </span><span class=si>${</span><span class=nx>prevButtonHTML</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;div class=&#34;pagination-pages&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          </span><span class=si>${</span><span class=nx>pagesHTML</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        </span><span class=si>${</span><span class=nx>nextButtonHTML</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;/nav&gt;`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div></div><p>여기까지 적용하고 블로그에서 검색을 수행하면 아래 이미지와 같은 검색 페이지로 이동할 수 있습니다.</p><p><label class=md-image for=md-image-toggle-7><input class="hidden toggle" type=checkbox id=md-image-toggle-7>
<img src="https://dl.dropboxusercontent.com/scl/fi/2kkw8zwdob4wy15xkg59t/hugo-48-search-page.webp?rlkey=vrjfr1vc54vpyhl2bsz2mut3g&amp;raw=1" alt='"Hugo" 검색 결과' loading=lazy decoding=async></label></p><p>검색 페이지와 관련된 모든 구현 과정이 종료되었습니다.</p><p>다음 게시글에서는 본문의 레이아웃을 개선하는 과정을 진행하겠습니다.</p></article><footer class=site-footer><div class=tags-wrap><a href="/search/?tags=Hugo" class=tag>#Hugo</a>
<a href="/search/?tags=Fusejs" class=tag>#Fusejs</a>
<a href="/search/?tags=%ea%b2%80%ec%83%89%20%ec%9d%b8%eb%8d%b1%ec%8a%a4" class=tag>#검색 인덱스</a>
<a href="/search/?tags=%ea%b2%80%ec%83%89%20%ed%8e%98%ec%9d%b4%ec%a7%80" class=tag>#검색 페이지</a>
<a href="/search/?tags=Hugo%20%ea%b2%80%ec%83%89" class=tag>#Hugo 검색</a>
<a href="/search/?tags=%ed%9c%b4%ea%b3%a0%20%ed%85%8c%eb%a7%88" class=tag>#휴고 테마</a>
<a href="/search/?tags=EventListener" class=tag>#EventListener</a>
<a href="/search/?tags=window" class=tag>#window</a>
<a href="/search/?tags=DocumentFragment" class=tag>#DocumentFragment</a>
<a href="/search/?tags=JavaScript" class=tag>#JavaScript</a>
<a href="/search/?tags=Blog" class=tag>#Blog</a>
<a href="/search/?tags=Hugo%20Book" class=tag>#Hugo Book</a></div><div class=prev-next-wrap><a href=/blog/hugo-blog-3/ class=prev-link><span class=prev-next-label><i class="fa-solid fa-backward"></i>
<span data-i18n-id=post.prev.link data-i18n-text>이전</span>
</span><span class=prev-next-title>Hugo 분류(Taxonomies) 커스터마이징 - 태그/카테고리 템플릿 구현</span>
</a><a href=/blog/hugo-blog-5/ class=next-link><span class=prev-next-label><span data-i18n-id=post.next.link data-i18n-text>다음</span>
<i class="fa-solid fa-forward"></i>
</span><span class=prev-next-title>Hugo Disqus 댓글 연동 - 본문 레이아웃 개선하기 (헤더/푸터)</span></a></div><div class=comments-wrap><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://minyeamer.github.io/blog/hugo-blog-4/",this.page.identifier="https://minyeamer.github.io/blog/hugo-blog-4/"};window.relocateDisqus=()=>{let e=0;const t=20,n=setInterval(()=>{e++;const s=document.getElementById(atob(atob("WkdsemNYVnpYM1JvY21WaFpBPT0=")));var o=!1;if(s){const e=s.querySelector(atob(atob("VzNOeVl5bzlKMkZrY3lkZA==")));e&&(s.appendChild(e),o=!0)}(o||e>t)&&clearInterval(n)},1e3)},function(){var e=document,t=e.createElement("script");t.src="https://minyeamer.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}(),window.relocateDisqus();function reloadDisqus(){window.DISQUS&&(DISQUS.reset({reload:!0,config:function(){this.page.url="https://minyeamer.github.io/blog/hugo-blog-4/",this.page.identifier="https://minyeamer.github.io/blog/hugo-blog-4/"}}),window.relocateDisqus())}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class="copyright-wrap flex justify-center"><small>Minystory - <a href=https://creativecommons.org/licenses/by/4.0/legalcode target=_blank rel="noopener noreferrer">© CC BY 4.0</a></small></div></footer><label for=menu-control class="hidden site-menu-overlay"></label></div><aside class=site-toc aria-label=목차 data-i18n-id=toc.aside.tooltip data-i18n-attrs=aira-label><div class=toc-content><nav id=TableOfContents><ul><li><a href=#book-테마-검색-프로세스-분석>Book 테마 검색 프로세스 분석</a><ul><li><a href=#검색-템플릿-분석>검색 템플릿 분석</a></li><li><a href=#자바스크립트-분석>자바스크립트 분석</a></li><li><a href=#검색-코퍼스-분석>검색 코퍼스 분석</a></li><li><a href=#이벤트-리스너-분석>이벤트 리스너 분석</a></li><li><a href=#초기화-함수-분석>초기화 함수 분석</a></li><li><a href=#검색-함수-분석>검색 함수 분석</a></li></ul></li><li><a href=#검색-기능-개선>검색 기능 개선</a><ul><li><a href=#검색-아이콘-추가>검색 아이콘 추가</a></li><li><a href=#검색-결과-위치-고정>검색 결과 위치 고정</a></li><li><a href=#검색-결과에-더보기-링크-추가>검색 결과에 더보기 링크 추가</a></li><li><a href=#검색-결과-초기화-기능-추가>검색 결과 초기화 기능 추가</a></li></ul></li><li><a href=#검색-페이지-추가>검색 페이지 추가</a><ul><li><a href=#검색-기능-파일-구조-재설계>검색 기능 파일 구조 재설계</a></li><li><a href=#빈-검색-페이지-생성>빈 검색 페이지 생성</a></li><li><a href=#검색-페이지-이동-기능-추가>검색 페이지 이동 기능 추가</a></li><li><a href=#검색-결과-표시-방식-구상>검색 결과 표시 방식 구상</a></li><li><a href=#검색-페이지-템플릿-추가>검색 페이지 템플릿 추가</a></li></ul></li><li><a href=#검색-및-결과-표시-기능-추가>검색 및 결과 표시 기능 추가</a><ul><li><a href=#파라미터-초기화-및-인덱스-생성>파라미터 초기화 및 인덱스 생성</a></li><li><a href=#검색-수행-및-결과-필터링>검색 수행 및 결과 필터링</a></li><li><a href=#페이지네이션-동적-생성>페이지네이션 동적 생성</a></li></ul></li></ul></nav></div><div class=hidden id=toc-config data-start=2 data-end=3></div></aside><div class=site-toolbar role=toolbar aria-label="툴바'" data-i18n-id=toolbar.wrap.tooltip data-i18n-attrs=aira-label><input type=checkbox id=toolbar-toggle class="hidden toggle"><div class=toolbar-items><div class="toolbar-button i18n-button"><i class="fa-solid fa-globe"></i>
<select class=i18n-selector id=i18n-selector aria-label="i18n `toolbar.i18n.tooltip` | default `Select language`" title="i18n `toolbar.i18n.tooltip` | default `Select language`" data-i18n-id=toolbar.i18n.tooltip data-i18n-attrs=aria-label,title><option value=ko>한국어</option><option value=en>English</option><option value=ja>日本語</option><option value=zh>中文</option><option value=es>Español</option><option value=fr>Français</option><option value=de>Deutsch</option><option value=it>Italiano</option><option value=pt>Português</option><option value=ru>Русский</option><option value=am>አማርኛ</option><option value=bg>Български</option><option value=bn>বাংলা</option><option value=cn>简体中文</option><option value=cs>Čeština</option><option value=fa>فارسی</option><option value=he>עברית</option><option value=nb>Norsk</option><option value=nl>Nederlands</option><option value=oc>Occitan</option><option value=pl>Polski</option><option value=pt-BR>Português (BR)</option><option value=sv>Svenska</option><option value=sw>Kiswahili</option><option value=tr>Türkçe</option><option value=uk>Українська</option><option value=zh-TW>繁體中文</option></select></div><button class=toolbar-button onclick='window.scrollTo({top:0,behavior:"smooth"})' aria-label="i18n `toolbar.top.tooltip` | default `Go to top`" title="i18n `toolbar.top.tooltip` | default `Go to top`" data-i18n-id=toolbar.top.tooltip data-i18n-attrs=aria-label,title>
<i class="fa fa-chevron-up"></i>
</button>
<button class=toolbar-button onclick='window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})' aria-label="i18n `toolbar.bottom.tooltip` | default `Go to bottom`" title="i18n `toolbar.bottom.tooltip` | default `Go to bottom`" data-i18n-id=toolbar.bottom.tooltip data-i18n-attrs=aria-label,title>
<i class="fa fa-chevron-down"></i>
</button>
<button class=toolbar-button onclick=history.back() aria-label="i18n `toolbar.back.tooltip` | default `Go back`" title="i18n `toolbar.back.tooltip` | default `Go back`" data-i18n-id=toolbar.back.tooltip data-i18n-attrs=aria-label,title>
<i class="fa-solid fa-arrow-left"></i></button></div><label for=toolbar-toggle class="toolbar-button toolbar-toggle-label"><i class="fa-solid fa-plus icon-expand"></i>
<i class="fa-solid fa-xmark icon-collapse"></i></label></div></main></body></html>