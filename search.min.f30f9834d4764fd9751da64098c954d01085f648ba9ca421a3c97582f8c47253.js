document.addEventListener("DOMContentLoaded",function(){const t=new URLSearchParams(window.location.search),e=t.get("q")||"";let n=[];const i=window.SEARCH_DATA_URL||"/search-data.json";fetch(i).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{n=e,s(),a()}).catch(e=>{console.error("Failed to load search data:",e),s(),r()});function s(){const t=document.getElementById("search-query-display");e?t.innerHTML=`"${e}" 검색 결과 <em class="list-count" id="search-count">0</em>`:t.textContent="검색어를 입력해주세요."}function a(){const a=parseInt(t.get("page"))||1,i=10;if(!e){document.getElementById("search-no-results").classList.remove("hidden"),document.getElementById("search-pagination").style.display="none";return}let s=n.filter(t=>{const n=(t.title+" "+t.content+" "+t.section).toLowerCase();return n.includes(e.toLowerCase())});if(s.length===0){document.getElementById("search-no-results").classList.remove("hidden");const e=document.getElementById("search-count");e&&(e.textContent="0"),document.getElementById("search-pagination").style.display="none";return}const l=document.querySelectorAll(".search-item");l.forEach(e=>e.style.display="none");const d=Math.ceil(s.length/i),r=(a-1)*i,u=Math.min(r+i,s.length);for(let e=r;e<u;e++){const n=s[e],t=document.querySelector(`[data-href="${n.href}"]`);t&&(t.style.display="block")}const c=document.getElementById("search-count");c&&(c.textContent=s.length),o(a,d,e)}function r(){const i=parseInt(t.get("page"))||1,s=10;if(!e){document.getElementById("search-no-results").classList.remove("hidden"),document.getElementById("search-pagination").style.display="none";return}const a=document.querySelectorAll(".search-item");let n=[];if(a.forEach(t=>{const s=t.querySelector("h2 a")?.textContent?.toLowerCase()||"",o=t.textContent.toLowerCase();(s.includes(e.toLowerCase())||o.includes(e.toLowerCase()))&&n.push(t)}),n.length===0){document.getElementById("search-no-results").classList.remove("hidden");const e=document.getElementById("search-count");e&&(e.textContent="0"),document.getElementById("search-pagination").style.display="none";return}a.forEach(e=>e.style.display="none");const l=Math.ceil(n.length/s),r=(i-1)*s,d=Math.min(r+s,n.length);for(let e=r;e<d;e++)n[e].style.display="block";const c=document.getElementById("search-count");c&&(c.textContent=n.length),o(i,l,e)}function o(e,t,n){const s=document.getElementById("search-pagination");if(t<=1){s.style.display="none";return}s.style.display="block";const o=s.querySelector("#current-page");o&&(o.textContent=e),c(e,t,n)}function c(e,t,n){const o=document.querySelector("#search-pagination nav.pagination");if(!o)return;const r=Math.floor((e-1)/10),i=r*10+1;let s=i+9;s>t&&(s=t);const a=o.querySelector(".pagination-pages");if(a){let t="";for(let o=i;o<=s;o++)o===e?t+=`<span class="pagination-page current" id="current-page">${o}</span>`:t+=`<a href="/search/?q=${encodeURIComponent(n)}${o>1?"&page="+o:""}#pagination-anchor" class="pagination-page pagination-link">${o}</a>`;a.innerHTML=t}}})